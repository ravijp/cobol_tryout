
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <title>Interactive COBOL Control Flow</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: white;
        }
        .node circle {
            stroke-width: 2px;
            cursor: pointer;
            transition: fill 0.3s, stroke 0.3s;
        }
        .node text {
            font: 14px sans-serif;
            fill: #000;
            pointer-events: none;
        }
        .link {
            fill: none;
            stroke: #d2b48c;
            stroke-width: 1.5px;
            marker-end: url(#arrow);
        }
        .tooltip {
            position: absolute;
            text-align: center;
            width: auto;
            height: auto;
            padding: 5px;
            font: 12px sans-serif;
            background: lightgrey;
            border: 1px solid black;
            border-radius: 5px;
            pointer-events: none;
            visibility: hidden;
        }
    </style>
</head>
<body>
    <div class="tooltip"></div>
    <script>
        const data = {"name": "root", "text": "      *****************************************************************         \n      * Program:     COCRDLIC.CBL                                     *         \n      * Layer:       Business logic                                   *         \n      * Function:    List Credit Cards                                          \n      *              a) All cards if no context passed and admin user           \n      *              b) Only the ones associated with ACCT in COMMAREA          \n      *                 if user is not admin                                    \n      ******************************************************************\n      * Copyright Amazon.com, Inc. or its affiliates.                   \n      * All Rights Reserved.                                            \n      *                                                                 \n      * Licensed under the Apache License, Version 2.0 (the \"License\"). \n      * You may not use this file except in compliance with the License.\n      * You may obtain a copy of the License at                         \n      *                                                                 \n      *    http://www.apache.org/licenses/LICENSE-2.0                   \n      *                                                                 \n      * Unless required by applicable law or agreed to in writing,      \n      * software distributed under the License is distributed on an     \n      * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,    \n      * either express or implied. See the License for the specific     \n      * language governing permissions and limitations under the License\n      ******************************************************************        \n                                                                                \n       IDENTIFICATION DIVISION.                                                 \n       PROGRAM-ID.                                                              \n           COCRDLIC.                                                            \n       DATE-WRITTEN.                                                            \n           April 2022.                                                          \n       DATE-COMPILED.                                                           \n           Today.                                                               \n                                                                                \n       ENVIRONMENT DIVISION.                                                    \n       INPUT-OUTPUT SECTION.                                                    \n                                                                                \n       DATA DIVISION.                                                           \n                                                                                \n       WORKING-STORAGE SECTION.                                                 \n                                                                                \n                                                                                \n       01  WS-MISC-STORAGE.                                                     \n      ******************************************************************        \n      * General CICS related                                                    \n      ******************************************************************        \n                                                                                \n         05 WS-CICS-PROCESSNG-VARS.                                             \n            07 WS-RESP-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-REAS-CD                          PIC S9(09) COMP              \n                                                   VALUE ZEROS.                 \n            07 WS-TRANID                           PIC X(4)                     \n                                                   VALUE SPACES.                \n      ******************************************************************        \n      * Input edits                                                             \n      ******************************************************************        \n         05 WS-INPUT-FLAG                          PIC X(1).                    \n           88  INPUT-OK                            VALUES '0'                   \n                                                          ' '                   \n                                                   LOW-VALUES.                  \n           88  INPUT-ERROR                         VALUE '1'.                   \n         05  WS-EDIT-ACCT-FLAG                     PIC X(1).                    \n           88  FLG-ACCTFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-ACCTFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-ACCTFILTER-BLANK                VALUE ' '.                   \n         05  WS-EDIT-CARD-FLAG                     PIC X(1).                    \n           88  FLG-CARDFILTER-NOT-OK               VALUE '0'.                   \n           88  FLG-CARDFILTER-ISVALID             VALUE '1'.                    \n           88  FLG-CARDFILTER-BLANK                VALUE ' '.                   \n         05 WS-EDIT-SELECT-COUNTER                PIC S9(04)                    \n                                                  USAGE COMP-3                  \n                                                  VALUE 0.                      \n         05 WS-EDIT-SELECT-FLAGS                  PIC X(7)                      \n                                                  VALUE LOW-VALUES.             \n         05 WS-EDIT-SELECT-ARRAY REDEFINES  WS-EDIT-SELECT-FLAGS.               \n            10 WS-EDIT-SELECT                      PIC X(1)                     \n                                                  OCCURS 7 TIMES.               \n               88 SELECT-OK                        VALUES 'S', 'U'.             \n               88 VIEW-REQUESTED-ON                VALUE 'S'.                   \n               88 UPDATE-REQUESTED-ON              VALUE 'U'.                   \n               88 SELECT-BLANK                     VALUES                       \n                                                   ' ',                         \n                                                   LOW-VALUES.                  \n         05 WS-EDIT-SELECT-ERROR-FLAGS             PIC X(7).                    \n         05 WS-EDIT-SELECT-ERROR-FLAGX     REDEFINES                            \n            WS-EDIT-SELECT-ERROR-FLAGS.                                         \n            10 WS-EDIT-SELECT-ERRORS OCCURS 7 TIMES.                            \n               20 WS-ROW-CRDSELECT-ERROR          PIC X(1).                     \n                  88 WS-ROW-SELECT-ERROR          VALUE '1'.                    \n         05 WS-SUBSCRIPT-VARS.                                                  \n            10 I                                  PIC S9(4) COMP                \n                                                  VALUE 0.                      \n            10 I-SELECTED                         PIC S9(4) COMP                \n                                                  VALUE 0.                      \n               88 DETAIL-WAS-REQUESTED            VALUES 1 THRU 7.              \n      ******************************************************************        \n      * Output edits                                                            \n      ******************************************************************        \n         05 CICS-OUTPUT-EDIT-VARS.                                              \n           10  CARD-ACCT-ID-X                      PIC X(11).                   \n           10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X                          \n                                                   PIC 9(11).                   \n           10  CARD-CVV-CD-X                       PIC X(03).                   \n           10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X                           \n                                                   PIC 9(03).                   \n           10  FLG-PROTECT-SELECT-ROWS             PIC X(1).                    \n           88  FLG-PROTECT-SELECT-ROWS-NO          VALUE '0'.                   \n           88  FLG-PROTECT-SELECT-ROWS-YES         VALUE '1'.                   \n      ******************************************************************        \n      * Output Message Construction                                             \n      ******************************************************************        \n         05  WS-LONG-MSG                           PIC X(500).                  \n         05  WS-INFO-MSG                           PIC X(45).                   \n           88  WS-NO-INFO-MESSAGE                 VALUES                        \n                                                  SPACES LOW-VALUES.            \n           88  WS-INFORM-REC-ACTIONS          VALUE                             \n               'TYPE S FOR DETAIL, U TO UPDATE ANY RECORD'.                     \n         05  WS-ERROR-MSG                         PIC X(75).                    \n           88  WS-ERROR-MSG-OFF                   VALUE SPACES.                 \n           88  WS-EXIT-MESSAGE                     VALUE                        \n               'PF03 PRESSED.EXITING'.                                          \n           88  WS-NO-RECORDS-FOUND                 VALUE                        \n               'NO RECORDS FOUND FOR THIS SEARCH CONDITION.'.                   \n           88  WS-MORE-THAN-1-ACTION              VALUE                         \n               'PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE'.               \n           88  WS-INVALID-ACTION-CODE              VALUE                        \n               'INVALID ACTION CODE'.                                           \n         05  WS-PFK-FLAG                           PIC X(1).                    \n           88  PFK-VALID                           VALUE '0'.                   \n           88  PFK-INVALID                         VALUE '1'.                   \n         05  WS-CONTEXT-FLAG                       PIC X(1).                    \n           88  WS-CONTEXT-FRESH-START              VALUE '0'.                   \n           88  WS-CONTEXT-FRESH-START-NO           VALUE '1'.                   \n      ******************************************************************        \n      * File and data Handling                                                  \n      ******************************************************************        \n         05 WS-FILE-HANDLING-VARS.                                              \n            10  WS-CARD-RID.                                                    \n                20  WS-CARD-RID-CARDNUM            PIC X(16).                   \n                20  WS-CARD-RID-ACCT-ID            PIC 9(11).                   \n                20  WS-CARD-RID-ACCT-ID-X          REDEFINES                    \n                    WS-CARD-RID-ACCT-ID            PIC X(11).                   \n                                                                                \n                                                                                \n                                                                                \n         05  WS-SCRN-COUNTER               PIC S9(4) COMP VALUE 0.              \n                                                                                \n         05  WS-FILTER-RECORD-FLAG                 PIC X(1).                    \n           88  WS-EXCLUDE-THIS-RECORD               VALUE '0'.                  \n           88  WS-DONOT-EXCLUDE-THIS-RECORD         VALUE '1'.                  \n         05  WS-RECORDS-TO-PROCESS-FLAG            PIC X(1).                    \n           88  READ-LOOP-EXIT                      VALUE '0'.                   \n           88  MORE-RECORDS-TO-READ                VALUE '1'.                   \n         05  WS-FILE-ERROR-MESSAGE.                                             \n           10  FILLER                              PIC X(12)                    \n                                                   VALUE 'File Error:'.         \n           10  ERROR-OPNAME                        PIC X(8)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(4)                     \n                                                   VALUE ' on '.                \n           10  ERROR-FILE                          PIC X(9)                     \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(15)                    \n                                                   VALUE                        \n                                                   ' returned RESP '.           \n           10  ERROR-RESP                          PIC X(10)                    \n                                                   VALUE SPACES.                \n           10  FILLER                              PIC X(7)                     \n                                                   VALUE ',RESP2 '.             \n           10  ERROR-RESP2                         PIC X(10)                    \n                                                   VALUE SPACES.                \n          10  FILLER                               PIC X(5).                    \n                                                                                \n      ******************************************************************\n      * Literals and Constants                                                  \n      ******************************************************************        \n       01 WS-CONSTANTS.                                                         \n         05  WS-MAX-SCREEN-LINES                    PIC S9(4) COMP              \n                                                    VALUE 7.                    \n         05  LIT-THISPGM                            PIC X(8)                    \n             VALUE 'COCRDLIC'.                                                  \n         05  LIT-THISTRANID                         PIC X(4)                    \n             VALUE 'CCLI'.                                                      \n         05  LIT-THISMAPSET                         PIC X(7)                    \n             VALUE 'COCRDLI'.                                                   \n         05  LIT-THISMAP                            PIC X(7)                    \n             VALUE 'CCRDLIA'.                                                   \n         05  LIT-MENUPGM                            PIC X(8)                    \n             VALUE 'COMEN01C'.                                                  \n         05  LIT-MENUTRANID                         PIC X(4)                    \n             VALUE 'CM00'.                                                      \n         05  LIT-MENUMAPSET                         PIC X(7)                    \n             VALUE 'COMEN01'.                                                   \n         05  LIT-MENUMAP                            PIC X(7)                    \n             VALUE 'COMEN1A'.                                                   \n         05  LIT-CARDDTLPGM                         PIC X(8)                    \n             VALUE 'COCRDSLC'.                                                  \n         05  LIT-CARDDTLTRANID                      PIC X(4)                    \n             VALUE 'CCDL'.                                                      \n         05  LIT-CARDDTLMAPSET                      PIC X(7)                    \n             VALUE 'COCRDSL'.                                                   \n         05  LIT-CARDDTLMAP                         PIC X(7)                    \n             VALUE 'CCRDSLA'.                                                   \n         05  LIT-CARDUPDPGM                         PIC X(8)                    \n             VALUE 'COCRDUPC'.                                                  \n         05  LIT-CARDUPDTRANID                      PIC X(4)                    \n             VALUE 'CCUP'.                                                      \n         05  LIT-CARDUPDMAPSET                      PIC X(7)                    \n             VALUE 'COCRDUP'.                                                   \n         05  LIT-CARDUPDMAP                         PIC X(7)                    \n             VALUE 'CCRDUPA'.                                                   \n                                                                                \n                                                                                \n         05  LIT-CARD-FILE                          PIC X(8)                    \n                                                   VALUE 'CARDDAT '.            \n         05  LIT-CARD-FILE-ACCT-PATH                PIC X(8)                    \n                                                                                \n                                                   VALUE 'CARDAIX '.            \n      ******************************************************************        \n      *Other common working storage Variables                                   \n      ******************************************************************        \n       COPY CVCRD01Y.                                                           \n                                                                                \n      ******************************************************************        \n      *  Commarea manipulations                                                 \n      ******************************************************************        \n      *Application Commmarea Copybook                                           \n       COPY COCOM01Y.                                                           \n                                                                                \n       01 WS-THIS-PROGCOMMAREA.                                                 \n            10 WS-CA-LAST-CARDKEY.                                              \n               15  WS-CA-LAST-CARD-NUM                PIC X(16).                \n               15  WS-CA-LAST-CARD-ACCT-ID            PIC 9(11).                \n            10 WS-CA-FIRST-CARDKEY.                                             \n               15  WS-CA-FIRST-CARD-NUM               PIC X(16).                \n               15  WS-CA-FIRST-CARD-ACCT-ID           PIC 9(11).                \n                                                                                \n            10 WS-CA-SCREEN-NUM                       PIC 9(1).                 \n               88 CA-FIRST-PAGE                          VALUE 1.               \n            10 WS-CA-LAST-PAGE-DISPLAYED              PIC 9(1).                 \n               88 CA-LAST-PAGE-SHOWN                     VALUE 0.               \n               88 CA-LAST-PAGE-NOT-SHOWN                 VALUE 9.               \n            10 WS-CA-NEXT-PAGE-IND                    PIC X(1).                 \n               88 CA-NEXT-PAGE-NOT-EXISTS             VALUE LOW-VALUES.         \n               88 CA-NEXT-PAGE-EXISTS                 VALUE 'Y'.                \n                                                                                \n            10 WS-RETURN-FLAG                        PIC X(1).                  \n           88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.            \n           88  WS-RETURN-FLAG-ON                   VALUE '1'.                   \n      ******************************************************************        \n      *  File Data Array         28 CHARS X 7 ROWS = 196                        \n      ******************************************************************        \n         05 WS-SCREEN-DATA.                                                     \n            10 WS-ALL-ROWS                         PIC X(196).                  \n            10 FILLER REDEFINES WS-ALL-ROWS.                                    \n               15 WS-SCREEN-ROWS OCCURS  7 TIMES.                               \n                  20 WS-EACH-ROW.                                               \n                     25 WS-EACH-CARD.                                           \n                        30 WS-ROW-ACCTNO           PIC X(11).                   \n                        30 WS-ROW-CARD-NUM         PIC X(16).                   \n                        30 WS-ROW-CARD-STATUS      PIC X(1).                    \n                                                                                \n       01  WS-COMMAREA                             PIC X(2000).                 \n                                                                                \n                                                                                \n                                                                                \n      *IBM SUPPLIED COPYBOOKS                                                   \n       COPY DFHBMSCA.                                                           \n       COPY DFHAID.                                                             \n                                                                                \n      *COMMON COPYBOOKS                                                         \n      *Screen Titles                                                            \n       COPY COTTL01Y.                                                           \n      *Credit Card Search Screen Layout                                         \n      *COPY COCRDSL.                                                            \n      *Credit Card List Screen Layout                                           \n       COPY COCRDLI.                                                            \n                                                                                \n      *Current Date                                                             \n       COPY CSDAT01Y.                                                           \n      *Common Messages                                                          \n       COPY CSMSG01Y.                                                           \n      *Abend Variables                                                          \n      *COPY CSMSG02Y.                                                           \n      *Signed on user data                                                      \n       COPY CSUSR01Y.                                                           \n                                                                                \n      *Dataset layouts                                                          \n                                                                                \n      *CARD RECORD LAYOUT                                                       \n       COPY CVACT02Y.                                                           \n                                                                                \n       LINKAGE SECTION.                                                         \n       01  DFHCOMMAREA.                                                         \n         05  FILLER                                PIC X(1)                     \n             OCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.                     \n                                                                                \n       PROCEDURE DIVISION.                                                      \n       0000-MAIN.                                                               \n                                                                                \n           INITIALIZE CC-WORK-AREA                                              \n                      WS-MISC-STORAGE                                           \n                      WS-COMMAREA                                               \n                                                                                \n      *****************************************************************         \n      * Store our context                                                       \n      *****************************************************************         \n           MOVE LIT-THISTRANID       TO WS-TRANID                               \n      *****************************************************************         \n      * Ensure error message is cleared                               *         \n      *****************************************************************         \n           SET WS-ERROR-MSG-OFF  TO TRUE                                        \n      *****************************************************************         \n      * Retrived passed data if  any. Initialize them if first run.             \n      *****************************************************************         \n           IF EIBCALEN = 0\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA \n              MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID                   \n              MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM                  \n              SET CDEMO-USRTYP-USER      TO TRUE                                \n              SET CDEMO-PGM-ENTER        TO TRUE                                \n              MOVE LIT-THISMAP           TO CDEMO-LAST-MAP                      \n              MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET                   \n              SET CA-FIRST-PAGE          TO TRUE                                \n              SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                                \n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO               \n                                CARDDEMO-COMMAREA                               \n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                 \n                               LENGTH OF WS-THIS-PROGCOMMAREA )TO               \n                                WS-THIS-PROGCOMMAREA                            \n           END-IF                                                               \n      *****************************************************************         \n      * If coming in from menu. Lets forget the past and start afresh *         \n      *****************************************************************         \n           IF (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)                        \n               INITIALIZE WS-THIS-PROGCOMMAREA\n               SET CDEMO-PGM-ENTER      TO TRUE                                 \n               MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                       \n               SET CA-FIRST-PAGE        TO TRUE                                 \n               SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                               \n           END-IF \n                                                                                \n      ******************************************************************        \n      * Remap PFkeys as needed.                                                 \n      * Store the Mapped PF Key                                                 \n      *****************************************************************         \n           PERFORM YYYY-STORE-PFKEY                                             \n              THRU YYYY-STORE-PFKEY-EXIT                                        \n                                                                                \n      ******************************************************************        \n      * If something is present in commarea                                     \n      * and the from program is this program itself,                            \n      * read and edit the inputs given                                          \n      *****************************************************************         \n           IF  EIBCALEN > 0                                                     \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                            \n               PERFORM 2000-RECEIVE-MAP                                         \n               THRU    2000-RECEIVE-MAP-EXIT                                    \n                                                                                \n           END-IF                                                               \n      *****************************************************************         \n      * Check the mapped key  to see if its valid at this point       *         \n      * F3    - Exit                                                            \n      * Enter - List of cards for current start key                             \n      * F8    - Page down                                                       \n      * F7    - Page up                                                         \n      *****************************************************************         \n           SET PFK-INVALID TO TRUE                                              \n           IF CCARD-AID-ENTER OR                                                \n              CCARD-AID-PFK03 OR                                                \n              CCARD-AID-PFK07 OR                                                \n              CCARD-AID-PFK08                                                   \n               SET PFK-VALID TO TRUE                                            \n           END-IF                                                               \n                                                                                \n           IF PFK-INVALID                                                       \n              SET CCARD-AID-ENTER TO TRUE                                       \n           END-IF                                                               \n      *****************************************************************         \n      * If the user pressed PF3 go back to main menu                            \n      *****************************************************************         \n           IF  (CCARD-AID-PFK03                                                 \n           AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)                           \n              MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID                        \n              MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM                       \n              SET  CDEMO-USRTYP-USER TO TRUE                                    \n              SET  CDEMO-PGM-ENTER  TO TRUE                                     \n              MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET                        \n              MOVE LIT-THISMAP      TO CDEMO-LAST-MAP                           \n              MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM                         \n                                                                                \n              MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET                        \n              MOVE LIT-THISMAP      TO CCARD-NEXT-MAP                           \n              SET WS-EXIT-MESSAGE            TO TRUE                            \n                                                                                \n      *       CALL MENU PROGRAM                                                 \n      *                                                                         \n              SET CDEMO-PGM-ENTER   TO TRUE                                     \n      *                                                                         \n              EXEC CICS XCTL                                                    \n                        PROGRAM (LIT-MENUPGM)                                   \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n              END-EXEC                                                          \n           END-IF                                                               \n      *****************************************************************         \n      * If the user did not press PF8, lets reset the last page flag            \n      *****************************************************************         \n           IF CCARD-AID-PFK08                                                   \n              CONTINUE                                                          \n           ELSE                                                                 \n              SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE                              \n           END-IF                                                               \n      *****************************************************************         \n      * Now we decide what to do                                                \n      *****************************************************************         \n           EVALUATE TRUE                                                        \n               WHEN INPUT-ERROR                                                 \n      *****************************************************************         \n      *        ASK FOR CORRECTIONS TO INPUTS                                    \n      *****************************************************************         \n                    MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG                     \n                    MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                  \n                    MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                   \n                    MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                      \n                                                                                \n                    MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                     \n                    MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                   \n                    MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                      \n                    IF  NOT FLG-ACCTFILTER-NOT-OK                               \n                    AND NOT FLG-CARDFILTER-NOT-OK                               \n                       PERFORM 9000-READ-FORWARD                                \n                          THRU 9000-READ-FORWARD-EXIT                           \n                    END-IF                                                      \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n      *****************************************************************         \n      *        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND CA-FIRST-PAGE                                           \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM                    \n      *****************************************************************         \n               WHEN CCARD-AID-PFK03                                             \n               WHEN CDEMO-PGM-REENTER AND                                       \n                    CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM                    \n                                                                                \n                    INITIALIZE CARDDEMO-COMMAREA                                \n                               WS-THIS-PROGCOMMAREA                             \n                    MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID               \n                    MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM              \n                    SET CDEMO-USRTYP-USER    TO TRUE                            \n                    SET CDEMO-PGM-ENTER      TO TRUE                            \n                    MOVE LIT-THISMAP         TO CDEMO-LAST-MAP                  \n                    MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET               \n                    SET CA-FIRST-PAGE        TO TRUE                            \n                    SET CA-LAST-PAGE-NOT-SHOWN TO TRUE                          \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                                                                                \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE DOWN                                                        \n      *****************************************************************         \n               WHEN CCARD-AID-PFK08                                             \n                    AND CA-NEXT-PAGE-EXISTS                                     \n                    MOVE WS-CA-LAST-CARD-NUM                                    \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-LAST-CARD-ACCT-ID                                \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    ADD   +1       TO WS-CA-SCREEN-NUM                          \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        PAGE UP                                                          \n      *****************************************************************         \n               WHEN CCARD-AID-PFK07                                             \n                    AND NOT CA-FIRST-PAGE                                       \n                                                                                \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    SUBTRACT 1    FROM WS-CA-SCREEN-NUM                         \n                    PERFORM 9100-READ-BACKWARDS                                 \n                       THRU 9100-READ-BACKWARDS-EXIT                            \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP-EXIT                                  \n                    GO TO COMMON-RETURN                                         \n      *****************************************************************         \n      *        TRANSFER TO CARD DETAIL VIEW                                     \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND VIEW-REQUESTED-ON(I-SELECTED)                               \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD DETAIL PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n      *****************************************************************         \n      *        TRANSFER TO CARD UPDATED PROGRAM                                 \n      *****************************************************************         \n               WHEN CCARD-AID-ENTER                                             \n                AND UPDATE-REQUESTED-ON(I-SELECTED)                             \n                AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM                       \n                   MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID                  \n                   MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM                 \n                   SET  CDEMO-USRTYP-USER TO TRUE                               \n                   SET  CDEMO-PGM-ENTER   TO TRUE                               \n                   MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET                  \n                   MOVE LIT-THISMAP       TO CDEMO-LAST-MAP                     \n                   MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG                    \n                                                                                \n                   MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET                  \n                   MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP                     \n                                                                                \n                   MOVE WS-ROW-ACCTNO (I-SELECTED)                              \n                                          TO CDEMO-ACCT-ID                      \n                   MOVE WS-ROW-CARD-NUM (I-SELECTED)                            \n                                          TO CDEMO-CARD-NUM                     \n                                                                                \n      *            CALL CARD UPDATE PROGRAM                                     \n      *                                                                         \n                   EXEC CICS XCTL                                               \n                        PROGRAM (CCARD-NEXT-PROG)                               \n                        COMMAREA(CARDDEMO-COMMAREA)                             \n                   END-EXEC                                                     \n                                                                                \n      *****************************************************************         \n               WHEN OTHER                                                       \n      *****************************************************************         \n                    MOVE WS-CA-FIRST-CARD-NUM                                   \n                                  TO WS-CARD-RID-CARDNUM                        \n      *             MOVE WS-CA-FIRST-CARD-ACCT-ID                               \n      *                           TO WS-CARD-RID-ACCT-ID                        \n                    PERFORM 9000-READ-FORWARD                                   \n                       THRU 9000-READ-FORWARD-EXIT                              \n                    PERFORM 1000-SEND-MAP                                       \n                       THRU 1000-SEND-MAP                                       \n                    GO TO COMMON-RETURN                                         \n           END-EVALUATE                                                         \n                                                                                \n      * If we had an error setup error message to display and return            \n           IF INPUT-ERROR                                                       \n              MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG                            \n              MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM                        \n              MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                         \n              MOVE LIT-THISMAP     TO CDEMO-LAST-MAP                            \n                                                                                \n              MOVE LIT-THISPGM     TO CCARD-NEXT-PROG                           \n              MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET                         \n              MOVE LIT-THISMAP     TO CCARD-NEXT-MAP                            \n      *       PERFORM 1000-SEND-MAP                                             \n      *          THRU 1000-SEND-MAP                                             \n              GO TO COMMON-RETURN                                               \n           END-IF                                                               \n                                                                                \n           MOVE LIT-THISPGM        TO CCARD-NEXT-PROG                           \n           GO TO COMMON-RETURN                                                  \n           .                                                                    \n                                                                                \n       COMMON-RETURN.                                                           \n           MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID                            \n           MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM                          \n           MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET                           \n           MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP                              \n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA                            \n           MOVE  WS-THIS-PROGCOMMAREA TO                                        \n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:                  \n                               LENGTH OF WS-THIS-PROGCOMMAREA )                 \n                                                                                \n                                                                                \n           EXEC CICS RETURN                                                     \n                TRANSID (LIT-THISTRANID)                                        \n                COMMAREA (WS-COMMAREA)                                          \n                LENGTH(LENGTH OF WS-COMMAREA)                                   \n           END-EXEC                                                             \n           .                                                                    \n       0000-MAIN-EXIT.                                                          \n           EXIT                                                                 \n           .                                                                    \n       1000-SEND-MAP.                                                           \n           PERFORM 1100-SCREEN-INIT                                             \n              THRU 1100-SCREEN-INIT-EXIT                                        \n           PERFORM 1200-SCREEN-ARRAY-INIT                                       \n              THRU 1200-SCREEN-ARRAY-INIT-EXIT                                  \n           PERFORM 1250-SETUP-ARRAY-ATTRIBS                                     \n              THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT                                \n           PERFORM 1300-SETUP-SCREEN-ATTRS                                      \n              THRU 1300-SETUP-SCREEN-ATTRS-EXIT                                 \n           PERFORM 1400-SETUP-MESSAGE                                           \n              THRU 1400-SETUP-MESSAGE-EXIT                                      \n           PERFORM 1500-SEND-SCREEN                                             \n              THRU 1500-SEND-SCREEN-EXIT                                        \n           .                                                                    \n                                                                                \n       1000-SEND-MAP-EXIT.                                                      \n           EXIT                                                                 \n           .                                                                    \n       1100-SCREEN-INIT.                                                        \n           MOVE LOW-VALUES             TO CCRDLIAO                              \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO                  \n           MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO                  \n           MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO                  \n           MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO                  \n                                                                                \n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA                       \n                                                                                \n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM                         \n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD                         \n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY                         \n                                                                                \n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO                  \n                                                                                \n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH                         \n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM                         \n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS                         \n                                                                                \n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO                  \n      *    PAGE NUMBER                                                          \n      *                                                                         \n           MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO                  \n                                                                                \n           SET WS-NO-INFO-MESSAGE      TO TRUE                                  \n           MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO                  \n           MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO                  \n           .                                                                    \n                                                                                \n       1100-SCREEN-INIT-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       1200-SCREEN-ARRAY-INIT.                                                  \n      *    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n                                                                                \n           IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES                         \n              CONTINUE                                                          \n           ELSE                                                                 \n              MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO              \n              MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO              \n              MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO              \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1200-SCREEN-ARRAY-INIT-EXIT.                                             \n           EXIT                                                                 \n           .                                                                    \n       1250-SETUP-ARRAY-ATTRIBS.                                                \n      *    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!                        \n                                                                                \n           IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(1) = '1'                                \n                 MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO              \n                 IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES                     \n                    MOVE '*'               TO CRDSEL1O OF CCRDLIAO              \n                 END-IF                                                         \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(2) = '1'                                \n                 MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL2L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(3) = '1'                                \n                 MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL3L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI              \n              I                                                                 \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(4) = '1'                                \n                 MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL4L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(5) = '1'                                \n                 MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL5L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI              \n                                                                                \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(6) = '1'                                \n                 MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL6L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI              \n           END-IF                                                               \n                                                                                \n           IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES                     \n           OR   FLG-PROTECT-SELECT-ROWS-YES                                     \n              MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI              \n           ELSE                                                                 \n              IF WS-ROW-CRDSELECT-ERROR(7) = '1'                                \n                 MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO              \n                 MOVE -1                   TO CRDSEL7L OF CCRDLIAI              \n              END-IF                                                            \n              MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI              \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       1250-SETUP-ARRAY-ATTRIBS-EXIT.                                           \n           EXIT                                                                 \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS.                                                 \n      *    INITIALIZE SEARCH CRITERIA                                           \n           IF EIBCALEN = 0                                                      \n           OR (CDEMO-PGM-ENTER                                                  \n           AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)                                \n              CONTINUE                                                          \n           ELSE                                                                 \n              EVALUATE TRUE                                                     \n                  WHEN FLG-ACCTFILTER-ISVALID                                   \n                  WHEN FLG-ACCTFILTER-NOT-OK                                    \n                     MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-ACCT-ID = 0                                        \n                     MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n                                                                                \n              EVALUATE TRUE                                                     \n                  WHEN FLG-CARDFILTER-ISVALID                                   \n                  WHEN FLG-CARDFILTER-NOT-OK                                    \n                     MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO                  \n                     MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI                  \n                  WHEN CDEMO-CARD-NUM = 0                                       \n                     MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO                  \n                  WHEN OTHER                                                    \n                    MOVE CDEMO-CARD-NUM                                         \n                                       TO CARDSIDO OF CCRDLIAO                  \n                    MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI                  \n              END-EVALUATE                                                      \n           END-IF                                                               \n                                                                                \n      *    POSITION CURSOR                                                      \n                                                                                \n           IF FLG-ACCTFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-NOT-OK                                             \n              MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO                  \n              MOVE  -1                 TO CARDSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n      *    IF NO ERRORS POSITION CURSOR AT ACCTID                               \n                                                                                \n           IF INPUT-OK                                                          \n             MOVE   -1                 TO ACCTSIDL OF CCRDLIAI                  \n           END-IF                                                               \n                                                                                \n                                                                                \n           .                                                                    \n       1300-SETUP-SCREEN-ATTRS-EXIT.                                            \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1400-SETUP-MESSAGE.                                                      \n      *    SETUP MESSAGE                                                        \n           EVALUATE TRUE                                                        \n                WHEN FLG-ACCTFILTER-NOT-OK                                      \n                WHEN FLG-CARDFILTER-NOT-OK                                      \n                  CONTINUE                                                      \n                WHEN CCARD-AID-PFK07                                            \n                    AND CA-FIRST-PAGE                                           \n                  MOVE 'NO PREVIOUS PAGES TO DISPLAY'                           \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                 AND CA-LAST-PAGE-SHOWN                                         \n                  MOVE 'NO MORE PAGES TO DISPLAY'                               \n                  TO WS-ERROR-MSG                                               \n                WHEN CCARD-AID-PFK08                                            \n                 AND CA-NEXT-PAGE-NOT-EXISTS                                    \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                  IF  CA-LAST-PAGE-NOT-SHOWN                                    \n                  AND CA-NEXT-PAGE-NOT-EXISTS                                   \n                      SET CA-LAST-PAGE-SHOWN TO TRUE                            \n                  END-IF                                                        \n                WHEN WS-NO-INFO-MESSAGE                                         \n                WHEN CA-NEXT-PAGE-EXISTS                                        \n                  SET WS-INFORM-REC-ACTIONS TO TRUE                             \n                WHEN OTHER                                                      \n                   SET WS-NO-INFO-MESSAGE TO TRUE                               \n           END-EVALUATE                                                         \n                                                                                \n           MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO                    \n                                                                                \n           IF  NOT WS-NO-INFO-MESSAGE                                           \n           AND NOT WS-NO-RECORDS-FOUND                                          \n              MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO                   \n              MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO                   \n           END-IF                                                               \n                                                                                \n           .                                                                    \n       1400-SETUP-MESSAGE-EXIT.                                                 \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n       1500-SEND-SCREEN.                                                        \n           EXEC CICS SEND MAP(LIT-THISMAP)                                      \n                          MAPSET(LIT-THISMAPSET)                                \n                          FROM(CCRDLIAO)                                        \n                          CURSOR                                                \n                          ERASE                                                 \n                          RESP(WS-RESP-CD)                                      \n                          FREEKB                                                \n           END-EXEC                                                             \n           .                                                                    \n       1500-SEND-SCREEN-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2000-RECEIVE-MAP.                                                        \n           PERFORM 2100-RECEIVE-SCREEN                                          \n              THRU 2100-RECEIVE-SCREEN-EXIT                                     \n                                                                                \n           PERFORM 2200-EDIT-INPUTS                                             \n            THRU   2200-EDIT-INPUTS-EXIT                                        \n           .                                                                    \n                                                                                \n       2000-RECEIVE-MAP-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n       2100-RECEIVE-SCREEN.                                                     \n           EXEC CICS RECEIVE MAP(LIT-THISMAP)                                   \n                          MAPSET(LIT-THISMAPSET)                                \n                          INTO(CCRDLIAI)                                        \n                          RESP(WS-RESP-CD)                                      \n           END-EXEC                                                             \n                                                                                \n           MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID                             \n           MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM                            \n                                                                                \n           MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)                      \n           MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)                      \n           MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)                      \n           MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)                      \n           MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)                      \n           MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)                      \n           MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)                      \n           .                                                                    \n                                                                                \n       2100-RECEIVE-SCREEN-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2200-EDIT-INPUTS.                                                        \n           SET INPUT-OK                   TO TRUE                               \n           SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE                               \n                                                                                \n           PERFORM 2210-EDIT-ACCOUNT                                            \n              THRU 2210-EDIT-ACCOUNT-EXIT                                       \n                                                                                \n           PERFORM 2220-EDIT-CARD                                               \n              THRU 2220-EDIT-CARD-EXIT                                          \n                                                                                \n           PERFORM 2250-EDIT-ARRAY                                              \n              THRU 2250-EDIT-ARRAY-EXIT                                         \n           .                                                                    \n                                                                                \n       2200-EDIT-INPUTS-EXIT.                                                   \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT.                                                       \n           SET FLG-ACCTFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-ACCT-ID   EQUAL LOW-VALUES                                     \n           OR CC-ACCT-ID   EQUAL SPACES                                         \n           OR CC-ACCT-ID-N EQUAL ZEROS                                          \n              SET FLG-ACCTFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-ACCT-ID                                \n              GO TO  2210-EDIT-ACCOUNT-EXIT                                     \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 11 characters                                                    \n           IF CC-ACCT-ID  IS NOT NUMERIC                                        \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-ACCTFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              MOVE                                                              \n              'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              MOVE ZERO       TO CDEMO-ACCT-ID                                  \n              GO TO 2210-EDIT-ACCOUNT-EXIT                                      \n           ELSE                                                                 \n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID                                  \n              SET FLG-ACCTFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2210-EDIT-ACCOUNT-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD.                                                          \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           SET FLG-CARDFILTER-BLANK TO TRUE                                     \n                                                                                \n      *    Not supplied                                                         \n           IF CC-CARD-NUM   EQUAL LOW-VALUES                                    \n           OR CC-CARD-NUM   EQUAL SPACES                                        \n           OR CC-CARD-NUM-N EQUAL ZEROS                                         \n              SET FLG-CARDFILTER-BLANK  TO TRUE                                 \n              MOVE ZEROES       TO CDEMO-CARD-NUM                               \n              GO TO  2220-EDIT-CARD-EXIT                                        \n           END-IF                                                               \n      *                                                                         \n      *    Not numeric                                                          \n      *    Not 16 characters                                                    \n           IF CC-CARD-NUM  IS NOT NUMERIC                                       \n              SET INPUT-ERROR TO TRUE                                           \n              SET FLG-CARDFILTER-NOT-OK TO TRUE                                 \n              SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE                           \n              IF WS-ERROR-MSG-OFF                                               \n                 MOVE                                                           \n              'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'            \n                              TO WS-ERROR-MSG                                   \n              END-IF                                                            \n              MOVE ZERO       TO CDEMO-CARD-NUM                                 \n              GO TO 2220-EDIT-CARD-EXIT                                         \n           ELSE                                                                 \n              MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM                              \n              SET FLG-CARDFILTER-ISVALID TO TRUE                                \n           END-IF                                                               \n           .                                                                    \n                                                                                \n       2220-EDIT-CARD-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       2250-EDIT-ARRAY.                                                         \n                                                                                \n           IF INPUT-ERROR                                                       \n              GO TO 2250-EDIT-ARRAY-EXIT                                        \n           END-IF                                                               \n                                                                                \n           INSPECT  WS-EDIT-SELECT-FLAGS                                        \n           TALLYING I                                                           \n           FOR ALL 'S'                                                          \n               ALL 'U'                                                          \n                                                                                \n           IF I > +1                                                            \n               SET INPUT-ERROR      TO TRUE                                     \n               SET WS-MORE-THAN-1-ACTION TO TRUE                                \n                                                                                \n               MOVE WS-EDIT-SELECT-FLAGS                                        \n                                   TO WS-EDIT-SELECT-ERROR-FLAGS                \n               INSPECT WS-EDIT-SELECT-ERROR-FLAGS                               \n                 REPLACING ALL 'S' BY '1'                                       \n                           ALL 'U' BY '1'                                       \n                 CHARACTERS        BY '0'                                       \n                                                                                \n           END-IF                                                               \n                                                                                \n           MOVE ZERO TO I-SELECTED                                              \n                                                                                \n           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7                            \n               EVALUATE TRUE                                                    \n                 WHEN SELECT-OK(I)                                              \n                   MOVE I TO I-SELECTED                                         \n                   IF WS-MORE-THAN-1-ACTION                                     \n                      MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                     \n                   END-IF                                                       \n                 WHEN SELECT-BLANK(I)                                           \n                   CONTINUE                                                     \n                 WHEN OTHER                                                     \n                   SET INPUT-ERROR TO TRUE                                      \n                   MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)                        \n                   IF WS-ERROR-MSG-OFF                                          \n                      SET WS-INVALID-ACTION-CODE TO TRUE                        \n                   END-IF                                                       \n              END-EVALUATE                                                      \n           END-PERFORM                                                          \n                                                                                \n           .                                                                    \n                                                                                \n       2250-EDIT-ARRAY-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9000-READ-FORWARD.                                                       \n           MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           MOVE ZEROES TO WS-SCRN-COUNTER                                       \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READNEXT                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                                                                                \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      ADD 1             TO WS-SCRN-COUNTER                      \n                                                                                \n                      MOVE CARD-NUM     TO WS-ROW-CARD-NUM(                     \n                      WS-SCRN-COUNTER)                                          \n                      MOVE CARD-ACCT-ID TO                                      \n                      WS-ROW-ACCTNO(WS-SCRN-COUNTER)                            \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                        TO WS-ROW-CARD-STATUS(                  \n                                        WS-SCRN-COUNTER)                        \n                                                                                \n                      IF WS-SCRN-COUNTER = 1                                    \n                         MOVE CARD-ACCT-ID                                      \n                                        TO WS-CA-FIRST-CARD-ACCT-ID             \n                         MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM                 \n                         IF   WS-CA-SCREEN-NUM = 0                              \n                           ADD   +1     TO WS-CA-SCREEN-NUM                     \n                         ELSE                                                   \n                           CONTINUE                                             \n                         END-IF                                                 \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n      ******************************************************************        \n      *            Max Screen size                                              \n      ******************************************************************        \n                   IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES                     \n                      SET READ-LOOP-EXIT  TO TRUE                               \n                                                                                \n                      MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID          \n                      MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM              \n                                                                                \n                      EXEC CICS READNEXT                                        \n                        DATASET(LIT-CARD-FILE)                                  \n                        INTO (CARD-RECORD)                                      \n                        LENGTH(LENGTH OF CARD-RECORD)                           \n                        RIDFLD(WS-CARD-RID-CARDNUM)                             \n                        KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                \n                        RESP(WS-RESP-CD)                                        \n                        RESP2(WS-REAS-CD)                                       \n                      END-EXEC                                                  \n                                                                                \n                      EVALUATE WS-RESP-CD                                       \n                         WHEN DFHRESP(NORMAL)                                   \n                         WHEN DFHRESP(DUPREC)                                   \n                              SET CA-NEXT-PAGE-EXISTS                           \n                                                TO TRUE                         \n                              MOVE CARD-ACCT-ID TO                              \n                                   WS-CA-LAST-CARD-ACCT-ID                      \n                              MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM          \n                        WHEN DFHRESP(ENDFILE)                                   \n                            SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE             \n                                                                                \n                            IF WS-ERROR-MSG-OFF                                 \n                                MOVE 'NO MORE RECORDS TO SHOW'                  \n                                                TO WS-ERROR-MSG                 \n                            END-IF                                              \n                            WHEN OTHER                                          \n      *                     This is some kind of error. Change to END BR        \n      *                     And exit                                            \n                            SET READ-LOOP-EXIT      TO TRUE                     \n                            MOVE 'READ'              TO ERROR-OPNAME            \n                            MOVE LIT-CARD-FILE       TO ERROR-FILE              \n                            MOVE WS-RESP-CD          TO ERROR-RESP              \n                            MOVE WS-REAS-CD          TO ERROR-RESP2             \n                          MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG            \n                      END-EVALUATE                                              \n                  END-IF                                                        \n               WHEN DFHRESP(ENDFILE)                                            \n                  SET READ-LOOP-EXIT              TO TRUE                       \n                  SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE                       \n                  MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID              \n                  MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM                  \n                  IF WS-ERROR-MSG-OFF                                           \n                     MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG            \n                  END-IF                                                        \n                  IF WS-CA-SCREEN-NUM = 1                                       \n                  AND WS-SCRN-COUNTER = 0                                       \n      *               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG                \n                      SET WS-NO-RECORDS-FOUND    TO TRUE                        \n                  END-IF                                                        \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n                                                                                \n           EXEC CICS ENDBR FILE(LIT-CARD-FILE)                                  \n           END-EXEC                                                             \n           .                                                                    \n       9000-READ-FORWARD-EXIT.                                                  \n           EXIT                                                                 \n           .                                                                    \n       9100-READ-BACKWARDS.                                                     \n                                                                                \n           MOVE LOW-VALUES           TO WS-ALL-ROWS                             \n                                                                                \n           MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY                      \n                                                                                \n      *****************************************************************         \n      *    Start Browse                                                         \n      *****************************************************************         \n           EXEC CICS STARTBR                                                    \n                DATASET(LIT-CARD-FILE)                                          \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                GTEQ                                                            \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n      *****************************************************************         \n      *    Loop through records and fetch max screen records                    \n      *****************************************************************         \n           COMPUTE WS-SCRN-COUNTER =                                            \n                                   WS-MAX-SCREEN-LINES + 1                      \n           END-COMPUTE                                                          \n           SET CA-NEXT-PAGE-EXISTS    TO TRUE                                   \n           SET MORE-RECORDS-TO-READ   TO TRUE                                   \n                                                                                \n      *****************************************************************         \n      *    Now we show the records from previous set.                           \n      *****************************************************************         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   SUBTRACT 1          FROM WS-SCRN-COUNTER                     \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n                  GO TO 9100-READ-BACKWARDS-EXIT                                \n           END-EVALUATE                                                         \n                                                                                \n           PERFORM UNTIL READ-LOOP-EXIT                                         \n                                                                                \n           EXEC CICS READPREV                                                   \n                DATASET(LIT-CARD-FILE)                                          \n                INTO (CARD-RECORD)                                              \n                LENGTH(LENGTH OF CARD-RECORD)                                   \n                RIDFLD(WS-CARD-RID-CARDNUM)                                     \n                KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)                        \n                RESP(WS-RESP-CD)                                                \n                RESP2(WS-REAS-CD)                                               \n           END-EXEC                                                             \n                                                                                \n           EVALUATE WS-RESP-CD                                                  \n               WHEN DFHRESP(NORMAL)                                             \n               WHEN DFHRESP(DUPREC)                                             \n                   PERFORM 9500-FILTER-RECORDS                                  \n                      THRU 9500-FILTER-RECORDS-EXIT                             \n                   IF WS-DONOT-EXCLUDE-THIS-RECORD                              \n                      MOVE CARD-NUM                                             \n                                  TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)           \n                      MOVE CARD-ACCT-ID                                         \n                                  TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)             \n                      MOVE CARD-ACTIVE-STATUS                                   \n                                  TO                                            \n                                  WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)           \n                                                                                \n                      SUBTRACT 1  FROM WS-SCRN-COUNTER                          \n                      IF WS-SCRN-COUNTER = 0                                    \n                         SET READ-LOOP-EXIT  TO TRUE                            \n                                                                                \n                         MOVE CARD-ACCT-ID                                      \n                                  TO WS-CA-FIRST-CARD-ACCT-ID                   \n                         MOVE CARD-NUM                                          \n                                  TO WS-CA-FIRST-CARD-NUM                       \n                      ELSE                                                      \n                         CONTINUE                                               \n                      END-IF                                                    \n                   ELSE                                                         \n                       CONTINUE                                                 \n                   END-IF                                                       \n                                                                                \n               WHEN OTHER                                                       \n      *           This is some kind of error. Change to END BR                  \n      *           And exit                                                      \n                  SET READ-LOOP-EXIT             TO TRUE                        \n                  MOVE 'READ'                     TO ERROR-OPNAME               \n                  MOVE LIT-CARD-FILE              TO ERROR-FILE                 \n                  MOVE WS-RESP-CD                 TO ERROR-RESP                 \n                  MOVE WS-REAS-CD                 TO ERROR-RESP2                \n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG               \n           END-EVALUATE                                                         \n           END-PERFORM                                                          \n           .                                                                    \n                                                                                \n       9100-READ-BACKWARDS-EXIT.                                                \n           EXEC CICS                                                            \n                ENDBR FILE(LIT-CARD-FILE)                                       \n           END-EXEC                                                             \n                                                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n       9500-FILTER-RECORDS.                                                     \n           SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE                             \n                                                                                \n           IF FLG-ACCTFILTER-ISVALID                                            \n              IF  CARD-ACCT-ID = CC-ACCT-ID                                     \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD  TO TRUE                           \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           IF FLG-CARDFILTER-ISVALID                                            \n              IF  CARD-NUM = CC-CARD-NUM-N                                      \n                  CONTINUE                                                      \n              ELSE                                                              \n                  SET WS-EXCLUDE-THIS-RECORD TO TRUE                            \n                  GO TO 9500-FILTER-RECORDS-EXIT                                \n              END-IF                                                            \n           ELSE                                                                 \n             CONTINUE                                                           \n           END-IF                                                               \n                                                                                \n           .                                                                    \n                                                                                \n       9500-FILTER-RECORDS-EXIT.                                                \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n      *****************************************************************\n      *Common code to store PFKey                                      \n      *****************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n      *****************************************************************         \n      * Plain text exit - Dont use in production                      *         \n      *****************************************************************         \n       SEND-PLAIN-TEXT.                                                         \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-ERROR-MSG)                                         \n                     LENGTH(LENGTH OF WS-ERROR-MSG)                             \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-PLAIN-TEXT-EXIT.                                                    \n           EXIT                                                                 \n           .                                                                    \n      *****************************************************************         \n      * Display Long text and exit                                    *         \n      * This is primarily for debugging and should not be used in     *         \n      * regular course                                                *         \n      *****************************************************************         \n       SEND-LONG-TEXT.                                                          \n           EXEC CICS SEND TEXT                                                  \n                     FROM(WS-LONG-MSG)                                          \n                     LENGTH(LENGTH OF WS-LONG-MSG)                              \n                     ERASE                                                      \n                     FREEKB                                                     \n           END-EXEC                                                             \n                                                                                \n           EXEC CICS RETURN                                                     \n           END-EXEC                                                             \n           .                                                                    \n       SEND-LONG-TEXT-EXIT.                                                     \n           EXIT                                                                 \n           .                                                                    \n                                                                                \n                                                                                \n      *\n      * Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n      *\n", "children": [{"name": "IDENTIFICATION DIVISION", "text": "", "children": []}, {"name": "ENVIRONMENT DIVISION", "text": "", "children": [{"name": "INPUT-OUTPUT SECTION", "text": "", "children": []}]}, {"name": "DATA DIVISION", "text": "", "children": [{"name": "WORKING-STORAGE SECTION", "text": "", "children": []}, {"name": "LINKAGE SECTION", "text": "", "children": []}]}, {"name": "PROCEDURE DIVISION", "text": "", "children": [{"name": "0000-MAIN.", "text": "INITIALIZE CC-WORK-AREA\n               WS-MISC-STORAGE\n               WS-COMMAREA\n\n    MOVE LIT-THISTRANID       TO WS-TRANID\n    SET WS-ERROR-MSG-OFF  TO TRUE\n    IF EIBCALEN = 0\n       INITIALIZE CARDDEMO-COMMAREA\n                  WS-THIS-PROGCOMMAREA\n       MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID\n       MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM\n       SET CDEMO-USRTYP-USER      TO TRUE\n       SET CDEMO-PGM-ENTER        TO TRUE\n       MOVE LIT-THISMAP           TO CDEMO-LAST-MAP\n       MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET\n       SET CA-FIRST-PAGE          TO TRUE\n       SET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n    ELSE\n       MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO\n                         CARDDEMO-COMMAREA\n       MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                        LENGTH OF WS-THIS-PROGCOMMAREA )TO\n                         WS-THIS-PROGCOMMAREA\n    END-IF\n    IF (CDEMO-PGM-ENTER\n    AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)\n        INITIALIZE WS-THIS-PROGCOMMAREA\n        SET CDEMO-PGM-ENTER      TO TRUE\n        MOVE LIT-THISMAP         TO CDEMO-LAST-MAP\n        SET CA-FIRST-PAGE        TO TRUE\n        SET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n    END-IF\n\n    PERFORM YYYY-STORE-PFKEY\n       THRU YYYY-STORE-PFKEY-EXIT\n\n    IF  EIBCALEN > 0\n    AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\n        PERFORM 2000-RECEIVE-MAP\n        THRU    2000-RECEIVE-MAP-EXIT\n\n    END-IF\n    SET PFK-INVALID TO TRUE\n    IF CCARD-AID-ENTER OR\n       CCARD-AID-PFK03 OR\n       CCARD-AID-PFK07 OR\n       CCARD-AID-PFK08\n        SET PFK-VALID TO TRUE\n    END-IF\n\n    IF PFK-INVALID\n       SET CCARD-AID-ENTER TO TRUE\n    END-IF\n    IF  (CCARD-AID-PFK03\n    AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)\n       MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID\n       MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM\n       SET  CDEMO-USRTYP-USER TO TRUE\n       SET  CDEMO-PGM-ENTER  TO TRUE\n       MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET\n       MOVE LIT-THISMAP      TO CDEMO-LAST-MAP\n       MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM\n\n       MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET\n       MOVE LIT-THISMAP      TO CCARD-NEXT-MAP\n       SET WS-EXIT-MESSAGE            TO TRUE\n\n       SET CDEMO-PGM-ENTER   TO TRUE\n       EXEC CICS XCTL\n                 PROGRAM (LIT-MENUPGM)\n                 COMMAREA(CARDDEMO-COMMAREA)\n       END-EXEC\n    END-IF\n    IF CCARD-AID-PFK08\n       CONTINUE\n    ELSE\n       SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE\n    END-IF\n    EVALUATE TRUE\n        WHEN INPUT-ERROR\n             MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG\n             MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM\n             MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\n             MOVE LIT-THISMAP     TO CDEMO-LAST-MAP\n\n             MOVE LIT-THISPGM     TO CCARD-NEXT-PROG\n             MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET\n             MOVE LIT-THISMAP     TO CCARD-NEXT-MAP\n             IF  NOT FLG-ACCTFILTER-NOT-OK\n             AND NOT FLG-CARDFILTER-NOT-OK\n                PERFORM 9000-READ-FORWARD\n                   THRU 9000-READ-FORWARD-EXIT\n             END-IF\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK07\n             AND CA-FIRST-PAGE\n        WHEN CCARD-AID-PFK07\n             AND CA-FIRST-PAGE\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK03\n        WHEN CDEMO-PGM-REENTER AND\n             CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM\n\n             INITIALIZE CARDDEMO-COMMAREA\n                        WS-THIS-PROGCOMMAREA\n             MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID\n             MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM\n             SET CDEMO-USRTYP-USER    TO TRUE\n             SET CDEMO-PGM-ENTER      TO TRUE\n             MOVE LIT-THISMAP         TO CDEMO-LAST-MAP\n             MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET\n             SET CA-FIRST-PAGE        TO TRUE\n             SET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK08\n             AND CA-NEXT-PAGE-EXISTS\n             MOVE WS-CA-LAST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             ADD   +1       TO WS-CA-SCREEN-NUM\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP-EXIT\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK07\n             AND NOT CA-FIRST-PAGE\n\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             SUBTRACT 1    FROM WS-CA-SCREEN-NUM\n             PERFORM 9100-READ-BACKWARDS\n                THRU 9100-READ-BACKWARDS-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP-EXIT\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-ENTER\n         AND VIEW-REQUESTED-ON(I-SELECTED)\n         AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\n            MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID\n            MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM\n            SET  CDEMO-USRTYP-USER TO TRUE\n            SET  CDEMO-PGM-ENTER   TO TRUE\n            MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET\n            MOVE LIT-THISMAP       TO CDEMO-LAST-MAP\n            MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG\n\n            MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET\n            MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP\n\n            MOVE WS-ROW-ACCTNO (I-SELECTED)\n                                   TO CDEMO-ACCT-ID\n            MOVE WS-ROW-CARD-NUM (I-SELECTED)\n                                   TO CDEMO-CARD-NUM\n\n            EXEC CICS XCTL\n                 PROGRAM (CCARD-NEXT-PROG)\n                 COMMAREA(CARDDEMO-COMMAREA)\n            END-EXEC\n        WHEN CCARD-AID-ENTER\n         AND UPDATE-REQUESTED-ON(I-SELECTED)\n         AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\n            MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID\n            MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM\n            SET  CDEMO-USRTYP-USER TO TRUE\n            SET  CDEMO-PGM-ENTER   TO TRUE\n            MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET\n            MOVE LIT-THISMAP       TO CDEMO-LAST-MAP\n            MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG\n\n            MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET\n            MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP\n\n            MOVE WS-ROW-ACCTNO (I-SELECTED)\n                                   TO CDEMO-ACCT-ID\n            MOVE WS-ROW-CARD-NUM (I-SELECTED)\n                                   TO CDEMO-CARD-NUM\n\n            EXEC CICS XCTL\n                 PROGRAM (CCARD-NEXT-PROG)\n                 COMMAREA(CARDDEMO-COMMAREA)\n            END-EXEC\n\n        WHEN OTHER\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n    END-EVALUATE\n\n    IF INPUT-ERROR\n       MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG\n       MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM\n       MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\n       MOVE LIT-THISMAP     TO CDEMO-LAST-MAP\n\n       MOVE LIT-THISPGM     TO CCARD-NEXT-PROG\n       MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET\n       MOVE LIT-THISMAP     TO CCARD-NEXT-MAP\n       GO TO COMMON-RETURN\n    END-IF\n\n    MOVE LIT-THISPGM        TO CCARD-NEXT-PROG\n    GO TO COMMON-RETURN\n    .", "children": [{"name": "YYYY-STORE-PFKEY", "text": "", "children": [], "parents": ["0000-MAIN."]}, {"name": "2000-RECEIVE-MAP", "text": "", "children": [], "parents": ["0000-MAIN."]}, {"name": "9000-READ-FORWARD", "text": "", "children": [], "parents": ["0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN."]}, {"name": "1000-SEND-MAP", "text": "", "children": [], "parents": ["0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN."]}, {"name": "9100-READ-BACKWARDS", "text": "", "children": [], "parents": ["0000-MAIN."]}], "parents": []}, {"name": "COMMON-RETURN.", "text": "MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID\n    MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM\n    MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\n    MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP\n    MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\n    MOVE  WS-THIS-PROGCOMMAREA TO\n           WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                        LENGTH OF WS-THIS-PROGCOMMAREA )\n\n\n    EXEC CICS RETURN\n         TRANSID (LIT-THISTRANID)\n         COMMAREA (WS-COMMAREA)\n         LENGTH(LENGTH OF WS-COMMAREA)\n    END-EXEC\n    .", "children": [], "parents": []}, {"name": "0000-MAIN-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1000-SEND-MAP.", "text": "PERFORM 1100-SCREEN-INIT\n       THRU 1100-SCREEN-INIT-EXIT\n    PERFORM 1200-SCREEN-ARRAY-INIT\n       THRU 1200-SCREEN-ARRAY-INIT-EXIT\n    PERFORM 1250-SETUP-ARRAY-ATTRIBS\n       THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT\n    PERFORM 1300-SETUP-SCREEN-ATTRS\n       THRU 1300-SETUP-SCREEN-ATTRS-EXIT\n    PERFORM 1400-SETUP-MESSAGE\n       THRU 1400-SETUP-MESSAGE-EXIT\n    PERFORM 1500-SEND-SCREEN\n       THRU 1500-SEND-SCREEN-EXIT\n    .", "children": [{"name": "1100-SCREEN-INIT", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1200-SCREEN-ARRAY-INIT", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1250-SETUP-ARRAY-ATTRIBS", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1300-SETUP-SCREEN-ATTRS", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1400-SETUP-MESSAGE", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1500-SEND-SCREEN", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}], "parents": []}, {"name": "1000-SEND-MAP-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1100-SCREEN-INIT.", "text": "MOVE LOW-VALUES             TO CCRDLIAO\n\n    MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n    MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO\n    MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO\n    MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO\n    MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO\n\n    MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n    MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n    MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n    MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n    MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO\n\n    MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n    MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n    MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n    MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO\n    MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO\n\n    SET WS-NO-INFO-MESSAGE      TO TRUE\n    MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO\n    MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO\n    .", "children": [], "parents": []}, {"name": "1100-SCREEN-INIT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1200-SCREEN-ARRAY-INIT.", "text": "IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO\n    END-IF\n\n\n    IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO\n    END-IF\n    .", "children": [], "parents": []}, {"name": "1200-SCREEN-ARRAY-INIT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1250-SETUP-ARRAY-ATTRIBS.", "text": "IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(1) = '1'\n          MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO\n          IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES\n             MOVE '*'               TO CRDSEL1O OF CCRDLIAO\n          END-IF\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(2) = '1'\n          MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL2L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI\n\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(3) = '1'\n          MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL3L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI\n       I\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(4) = '1'\n          MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL4L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(5) = '1'\n          MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL5L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI\n\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(6) = '1'\n          MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL6L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(7) = '1'\n          MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL7L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI\n    END-IF\n    .", "children": [], "parents": []}, {"name": "1250-SETUP-ARRAY-ATTRIBS-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1300-SETUP-SCREEN-ATTRS.", "text": "IF EIBCALEN = 0\n    OR (CDEMO-PGM-ENTER\n    AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)\n       CONTINUE\n    ELSE\n       EVALUATE TRUE\n           WHEN FLG-ACCTFILTER-ISVALID\n           WHEN FLG-ACCTFILTER-NOT-OK\n              MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO\n              MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI\n           WHEN CDEMO-ACCT-ID = 0\n              MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO\n           WHEN OTHER\n             MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO\n             MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI\n       END-EVALUATE\n\n       EVALUATE TRUE\n           WHEN FLG-CARDFILTER-ISVALID\n           WHEN FLG-CARDFILTER-NOT-OK\n              MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO\n              MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI\n           WHEN CDEMO-CARD-NUM = 0\n              MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO\n           WHEN OTHER\n             MOVE CDEMO-CARD-NUM\n                                TO CARDSIDO OF CCRDLIAO\n             MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI\n       END-EVALUATE\n    END-IF\n\n\n    IF FLG-ACCTFILTER-NOT-OK\n       MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO\n       MOVE  -1                 TO ACCTSIDL OF CCRDLIAI\n    END-IF\n\n    IF FLG-CARDFILTER-NOT-OK\n       MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO\n       MOVE  -1                 TO CARDSIDL OF CCRDLIAI\n    END-IF\n\n\n    IF INPUT-OK\n      MOVE   -1                 TO ACCTSIDL OF CCRDLIAI\n    END-IF\n\n\n    .", "children": [], "parents": []}, {"name": "1300-SETUP-SCREEN-ATTRS-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1400-SETUP-MESSAGE.", "text": "EVALUATE TRUE\n         WHEN FLG-ACCTFILTER-NOT-OK\n         WHEN FLG-CARDFILTER-NOT-OK\n           CONTINUE\n         WHEN CCARD-AID-PFK07\n             AND CA-FIRST-PAGE\n           MOVE 'NO PREVIOUS PAGES TO DISPLAY'\n           TO WS-ERROR-MSG\n         WHEN CCARD-AID-PFK08\n          AND CA-NEXT-PAGE-NOT-EXISTS\n          AND CA-LAST-PAGE-SHOWN\n           MOVE 'NO MORE PAGES TO DISPLAY'\n           TO WS-ERROR-MSG\n         WHEN CCARD-AID-PFK08\n          AND CA-NEXT-PAGE-NOT-EXISTS\n           SET WS-INFORM-REC-ACTIONS TO TRUE\n           IF  CA-LAST-PAGE-NOT-SHOWN\n           AND CA-NEXT-PAGE-NOT-EXISTS\n               SET CA-LAST-PAGE-SHOWN TO TRUE\n           END-IF\n         WHEN WS-NO-INFO-MESSAGE\n         WHEN CA-NEXT-PAGE-EXISTS\n           SET WS-INFORM-REC-ACTIONS TO TRUE\n         WHEN OTHER\n            SET WS-NO-INFO-MESSAGE TO TRUE\n    END-EVALUATE\n\n    MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO\n\n    IF  NOT WS-NO-INFO-MESSAGE\n    AND NOT WS-NO-RECORDS-FOUND\n       MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO\n       MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO\n    END-IF\n\n    .", "children": [], "parents": []}, {"name": "1400-SETUP-MESSAGE-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "1500-SEND-SCREEN.", "text": "EXEC CICS SEND MAP(LIT-THISMAP)\n                   MAPSET(LIT-THISMAPSET)\n                   FROM(CCRDLIAO)\n                   CURSOR\n                   ERASE\n                   RESP(WS-RESP-CD)\n                   FREEKB\n    END-EXEC\n    .", "children": [], "parents": []}, {"name": "1500-SEND-SCREEN-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "2000-RECEIVE-MAP.", "text": "PERFORM 2100-RECEIVE-SCREEN\n       THRU 2100-RECEIVE-SCREEN-EXIT\n\n    PERFORM 2200-EDIT-INPUTS\n     THRU   2200-EDIT-INPUTS-EXIT\n    .", "children": [{"name": "2100-RECEIVE-SCREEN", "text": "", "children": [], "parents": ["2000-RECEIVE-MAP."]}, {"name": "2200-EDIT-INPUTS", "text": "", "children": [], "parents": ["2000-RECEIVE-MAP."]}], "parents": []}, {"name": "2000-RECEIVE-MAP-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "2100-RECEIVE-SCREEN.", "text": "EXEC CICS RECEIVE MAP(LIT-THISMAP)\n                   MAPSET(LIT-THISMAPSET)\n                   INTO(CCRDLIAI)\n                   RESP(WS-RESP-CD)\n    END-EXEC\n\n    MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID\n    MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM\n\n    MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)\n    MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)\n    MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)\n    MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)\n    MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)\n    MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)\n    MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)\n    .", "children": [], "parents": []}, {"name": "2100-RECEIVE-SCREEN-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "2200-EDIT-INPUTS.", "text": "SET INPUT-OK                   TO TRUE\n    SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE\n\n    PERFORM 2210-EDIT-ACCOUNT\n       THRU 2210-EDIT-ACCOUNT-EXIT\n\n    PERFORM 2220-EDIT-CARD\n       THRU 2220-EDIT-CARD-EXIT\n\n    PERFORM 2250-EDIT-ARRAY\n       THRU 2250-EDIT-ARRAY-EXIT\n    .", "children": [{"name": "2210-EDIT-ACCOUNT", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, {"name": "2220-EDIT-CARD", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, {"name": "2250-EDIT-ARRAY", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}], "parents": []}, {"name": "2200-EDIT-INPUTS-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "2210-EDIT-ACCOUNT.", "text": "SET FLG-ACCTFILTER-BLANK TO TRUE\n\n    IF CC-ACCT-ID   EQUAL LOW-VALUES\n    OR CC-ACCT-ID   EQUAL SPACES\n    OR CC-ACCT-ID-N EQUAL ZEROS\n       SET FLG-ACCTFILTER-BLANK  TO TRUE\n       MOVE ZEROES       TO CDEMO-ACCT-ID\n       GO TO  2210-EDIT-ACCOUNT-EXIT\n    END-IF\n    IF CC-ACCT-ID  IS NOT NUMERIC\n       SET INPUT-ERROR TO TRUE\n       SET FLG-ACCTFILTER-NOT-OK TO TRUE\n       SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\n       MOVE\n       'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'\n                       TO WS-ERROR-MSG\n       MOVE ZERO       TO CDEMO-ACCT-ID\n       GO TO 2210-EDIT-ACCOUNT-EXIT\n    ELSE\n       MOVE CC-ACCT-ID TO CDEMO-ACCT-ID\n       SET FLG-ACCTFILTER-ISVALID TO TRUE\n    END-IF\n    .", "children": [], "parents": []}, {"name": "2210-EDIT-ACCOUNT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "2220-EDIT-CARD.", "text": "SET FLG-CARDFILTER-BLANK TO TRUE\n\n    IF CC-CARD-NUM   EQUAL LOW-VALUES\n    OR CC-CARD-NUM   EQUAL SPACES\n    OR CC-CARD-NUM-N EQUAL ZEROS\n       SET FLG-CARDFILTER-BLANK  TO TRUE\n       MOVE ZEROES       TO CDEMO-CARD-NUM\n       GO TO  2220-EDIT-CARD-EXIT\n    END-IF\n    IF CC-CARD-NUM  IS NOT NUMERIC\n       SET INPUT-ERROR TO TRUE\n       SET FLG-CARDFILTER-NOT-OK TO TRUE\n       SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\n       IF WS-ERROR-MSG-OFF\n          MOVE\n       'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'\n                       TO WS-ERROR-MSG\n       END-IF\n       MOVE ZERO       TO CDEMO-CARD-NUM\n       GO TO 2220-EDIT-CARD-EXIT\n    ELSE\n       MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM\n       SET FLG-CARDFILTER-ISVALID TO TRUE\n    END-IF\n    .", "children": [], "parents": []}, {"name": "2220-EDIT-CARD-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "2250-EDIT-ARRAY.", "text": "IF INPUT-ERROR\n       GO TO 2250-EDIT-ARRAY-EXIT\n    END-IF\n\n    INSPECT  WS-EDIT-SELECT-FLAGS\n    TALLYING I\n    FOR ALL 'S'\n        ALL 'U'\n\n    IF I > +1\n        SET INPUT-ERROR      TO TRUE\n        SET WS-MORE-THAN-1-ACTION TO TRUE\n\n        MOVE WS-EDIT-SELECT-FLAGS\n                            TO WS-EDIT-SELECT-ERROR-FLAGS\n        INSPECT WS-EDIT-SELECT-ERROR-FLAGS\n          REPLACING ALL 'S' BY '1'\n                    ALL 'U' BY '1'\n          CHARACTERS        BY '0'\n\n    END-IF\n\n    MOVE ZERO TO I-SELECTED\n\n    PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7\n        EVALUATE TRUE\n          WHEN SELECT-OK(I)\n            MOVE I TO I-SELECTED\n            IF WS-MORE-THAN-1-ACTION\n               MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\n            END-IF\n          WHEN SELECT-BLANK(I)\n            CONTINUE\n          WHEN OTHER\n            SET INPUT-ERROR TO TRUE\n            MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\n            IF WS-ERROR-MSG-OFF\n               SET WS-INVALID-ACTION-CODE TO TRUE\n            END-IF\n       END-EVALUATE\n    END-PERFORM\n\n    .", "children": [{"name": "VARYING", "text": "", "children": [], "parents": ["2250-EDIT-ARRAY."]}], "parents": []}, {"name": "2250-EDIT-ARRAY-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "9000-READ-FORWARD.", "text": "MOVE LOW-VALUES           TO WS-ALL-ROWS\n\n    EXEC CICS STARTBR\n         DATASET(LIT-CARD-FILE)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         GTEQ\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n    MOVE ZEROES TO WS-SCRN-COUNTER\n    SET CA-NEXT-PAGE-EXISTS    TO TRUE\n    SET MORE-RECORDS-TO-READ   TO TRUE\n\n    PERFORM UNTIL READ-LOOP-EXIT\n\n    EXEC CICS READNEXT\n         DATASET(LIT-CARD-FILE)\n         INTO (CARD-RECORD)\n         LENGTH(LENGTH OF CARD-RECORD)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n\n    EVALUATE WS-RESP-CD\n        WHEN DFHRESP(NORMAL)\n        WHEN DFHRESP(DUPREC)\n            PERFORM 9500-FILTER-RECORDS\n               THRU 9500-FILTER-RECORDS-EXIT\n\n            IF WS-DONOT-EXCLUDE-THIS-RECORD\n               ADD 1             TO WS-SCRN-COUNTER\n\n               MOVE CARD-NUM     TO WS-ROW-CARD-NUM(\n               WS-SCRN-COUNTER)\n               MOVE CARD-ACCT-ID TO\n               WS-ROW-ACCTNO(WS-SCRN-COUNTER)\n               MOVE CARD-ACTIVE-STATUS\n                                 TO WS-ROW-CARD-STATUS(\n                                 WS-SCRN-COUNTER)\n\n               IF WS-SCRN-COUNTER = 1\n                  MOVE CARD-ACCT-ID\n                                 TO WS-CA-FIRST-CARD-ACCT-ID\n                  MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM\n                  IF   WS-CA-SCREEN-NUM = 0\n                    ADD   +1     TO WS-CA-SCREEN-NUM\n                  ELSE\n                    CONTINUE\n                  END-IF\n               ELSE\n                  CONTINUE\n               END-IF\n            ELSE\n                CONTINUE\n            END-IF\n            IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES\n               SET READ-LOOP-EXIT  TO TRUE\n\n               MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\n               MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\n\n               EXEC CICS READNEXT\n                 DATASET(LIT-CARD-FILE)\n                 INTO (CARD-RECORD)\n                 LENGTH(LENGTH OF CARD-RECORD)\n                 RIDFLD(WS-CARD-RID-CARDNUM)\n                 KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n                 RESP(WS-RESP-CD)\n                 RESP2(WS-REAS-CD)\n               END-EXEC\n\n               EVALUATE WS-RESP-CD\n                  WHEN DFHRESP(NORMAL)\n                  WHEN DFHRESP(DUPREC)\n                       SET CA-NEXT-PAGE-EXISTS\n                                         TO TRUE\n                       MOVE CARD-ACCT-ID TO\n                            WS-CA-LAST-CARD-ACCT-ID\n                       MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM\n                 WHEN DFHRESP(ENDFILE)\n                     SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\n\n                     IF WS-ERROR-MSG-OFF\n                         MOVE 'NO MORE RECORDS TO SHOW'\n                                         TO WS-ERROR-MSG\n                     END-IF\n                     WHEN OTHER\n                     SET READ-LOOP-EXIT      TO TRUE\n                     MOVE 'READ'              TO ERROR-OPNAME\n                     MOVE LIT-CARD-FILE       TO ERROR-FILE\n                     MOVE WS-RESP-CD          TO ERROR-RESP\n                     MOVE WS-REAS-CD          TO ERROR-RESP2\n                   MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG\n               END-EVALUATE\n           END-IF\n        WHEN DFHRESP(ENDFILE)\n           SET READ-LOOP-EXIT              TO TRUE\n           SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\n           MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\n           MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\n           IF WS-ERROR-MSG-OFF\n              MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG\n           END-IF\n           IF WS-CA-SCREEN-NUM = 1\n           AND WS-SCRN-COUNTER = 0\n               SET WS-NO-RECORDS-FOUND    TO TRUE\n           END-IF\n        WHEN OTHER\n           SET READ-LOOP-EXIT             TO TRUE\n           MOVE 'READ'                     TO ERROR-OPNAME\n           MOVE LIT-CARD-FILE              TO ERROR-FILE\n           MOVE WS-RESP-CD                 TO ERROR-RESP\n           MOVE WS-REAS-CD                 TO ERROR-RESP2\n           MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\n    END-EVALUATE\n    END-PERFORM\n\n    EXEC CICS ENDBR FILE(LIT-CARD-FILE)\n    END-EXEC\n    .", "children": [{"name": "UNTIL", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}, {"name": "9500-FILTER-RECORDS", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}], "parents": []}, {"name": "9000-READ-FORWARD-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "9100-READ-BACKWARDS.", "text": "MOVE LOW-VALUES           TO WS-ALL-ROWS\n\n    MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY\n\n    EXEC CICS STARTBR\n         DATASET(LIT-CARD-FILE)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         GTEQ\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n    COMPUTE WS-SCRN-COUNTER =\n                            WS-MAX-SCREEN-LINES + 1\n    END-COMPUTE\n    SET CA-NEXT-PAGE-EXISTS    TO TRUE\n    SET MORE-RECORDS-TO-READ   TO TRUE\n\n\n    EXEC CICS READPREV\n         DATASET(LIT-CARD-FILE)\n         INTO (CARD-RECORD)\n         LENGTH(LENGTH OF CARD-RECORD)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n\n    EVALUATE WS-RESP-CD\n        WHEN DFHRESP(NORMAL)\n        WHEN DFHRESP(DUPREC)\n            SUBTRACT 1          FROM WS-SCRN-COUNTER\n        WHEN OTHER\n           SET READ-LOOP-EXIT             TO TRUE\n           MOVE 'READ'                     TO ERROR-OPNAME\n           MOVE LIT-CARD-FILE              TO ERROR-FILE\n           MOVE WS-RESP-CD                 TO ERROR-RESP\n           MOVE WS-REAS-CD                 TO ERROR-RESP2\n           MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\n           GO TO 9100-READ-BACKWARDS-EXIT\n    END-EVALUATE\n\n    PERFORM UNTIL READ-LOOP-EXIT\n\n    EXEC CICS READPREV\n         DATASET(LIT-CARD-FILE)\n         INTO (CARD-RECORD)\n         LENGTH(LENGTH OF CARD-RECORD)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n\n    EVALUATE WS-RESP-CD\n        WHEN DFHRESP(NORMAL)\n        WHEN DFHRESP(DUPREC)\n            PERFORM 9500-FILTER-RECORDS\n               THRU 9500-FILTER-RECORDS-EXIT\n            IF WS-DONOT-EXCLUDE-THIS-RECORD\n               MOVE CARD-NUM\n                           TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)\n               MOVE CARD-ACCT-ID\n                           TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)\n               MOVE CARD-ACTIVE-STATUS\n                           TO\n                           WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)\n\n               SUBTRACT 1  FROM WS-SCRN-COUNTER\n               IF WS-SCRN-COUNTER = 0\n                  SET READ-LOOP-EXIT  TO TRUE\n\n                  MOVE CARD-ACCT-ID\n                           TO WS-CA-FIRST-CARD-ACCT-ID\n                  MOVE CARD-NUM\n                           TO WS-CA-FIRST-CARD-NUM\n               ELSE\n                  CONTINUE\n               END-IF\n            ELSE\n                CONTINUE\n            END-IF\n\n        WHEN OTHER\n           SET READ-LOOP-EXIT             TO TRUE\n           MOVE 'READ'                     TO ERROR-OPNAME\n           MOVE LIT-CARD-FILE              TO ERROR-FILE\n           MOVE WS-RESP-CD                 TO ERROR-RESP\n           MOVE WS-REAS-CD                 TO ERROR-RESP2\n           MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\n    END-EVALUATE\n    END-PERFORM\n    .", "children": [{"name": "UNTIL", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}, {"name": "9500-FILTER-RECORDS", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}], "parents": []}, {"name": "9100-READ-BACKWARDS-EXIT.", "text": "EXEC CICS\n         ENDBR FILE(LIT-CARD-FILE)\n    END-EXEC\n\n    EXIT\n    .", "children": [], "parents": []}, {"name": "9500-FILTER-RECORDS.", "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\n    IF FLG-ACCTFILTER-ISVALID\n       IF  CARD-ACCT-ID = CC-ACCT-ID\n           CONTINUE\n       ELSE\n           SET WS-EXCLUDE-THIS-RECORD  TO TRUE\n           GO TO 9500-FILTER-RECORDS-EXIT\n       END-IF\n    ELSE\n      CONTINUE\n    END-IF\n\n    IF FLG-CARDFILTER-ISVALID\n       IF  CARD-NUM = CC-CARD-NUM-N\n           CONTINUE\n       ELSE\n           SET WS-EXCLUDE-THIS-RECORD TO TRUE\n           GO TO 9500-FILTER-RECORDS-EXIT\n       END-IF\n    ELSE\n      CONTINUE\n    END-IF\n\n    .", "children": [], "parents": []}, {"name": "9500-FILTER-RECORDS-EXIT.", "text": "EXIT\n    .\n\nCOPY 'CSSTRPFY'\n    .", "children": [], "parents": []}, {"name": "SEND-PLAIN-TEXT.", "text": "EXEC CICS SEND TEXT\n              FROM(WS-ERROR-MSG)\n              LENGTH(LENGTH OF WS-ERROR-MSG)\n              ERASE\n              FREEKB\n    END-EXEC\n\n    EXEC CICS RETURN\n    END-EXEC\n    .", "children": [], "parents": []}, {"name": "SEND-PLAIN-TEXT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, {"name": "SEND-LONG-TEXT.", "text": "EXEC CICS SEND TEXT\n              FROM(WS-LONG-MSG)\n              LENGTH(LENGTH OF WS-LONG-MSG)\n              ERASE\n              FREEKB\n    END-EXEC\n\n    EXEC CICS RETURN\n    END-EXEC\n    .", "children": [], "parents": []}, {"name": "SEND-LONG-TEXT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}]}]};
        const paragraphs = {"PROGRAM-ID.": {"name": "PROGRAM-ID.", "text": "COCRDLIC.", "children": [], "parents": []}, "DATE-WRITTEN.": {"name": "DATE-WRITTEN.", "text": "April 2022.", "children": [], "parents": []}, "DATE-COMPILED.": {"name": "DATE-COMPILED.", "text": "Today.", "children": [], "parents": []}, "0000-MAIN.": {"name": "0000-MAIN.", "text": "INITIALIZE CC-WORK-AREA\n               WS-MISC-STORAGE\n               WS-COMMAREA\n\n    MOVE LIT-THISTRANID       TO WS-TRANID\n    SET WS-ERROR-MSG-OFF  TO TRUE\n    IF EIBCALEN = 0\n       INITIALIZE CARDDEMO-COMMAREA\n                  WS-THIS-PROGCOMMAREA\n       MOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID\n       MOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM\n       SET CDEMO-USRTYP-USER      TO TRUE\n       SET CDEMO-PGM-ENTER        TO TRUE\n       MOVE LIT-THISMAP           TO CDEMO-LAST-MAP\n       MOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET\n       SET CA-FIRST-PAGE          TO TRUE\n       SET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n    ELSE\n       MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO\n                         CARDDEMO-COMMAREA\n       MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                        LENGTH OF WS-THIS-PROGCOMMAREA )TO\n                         WS-THIS-PROGCOMMAREA\n    END-IF\n    IF (CDEMO-PGM-ENTER\n    AND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)\n        INITIALIZE WS-THIS-PROGCOMMAREA\n        SET CDEMO-PGM-ENTER      TO TRUE\n        MOVE LIT-THISMAP         TO CDEMO-LAST-MAP\n        SET CA-FIRST-PAGE        TO TRUE\n        SET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n    END-IF\n\n    PERFORM YYYY-STORE-PFKEY\n       THRU YYYY-STORE-PFKEY-EXIT\n\n    IF  EIBCALEN > 0\n    AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\n        PERFORM 2000-RECEIVE-MAP\n        THRU    2000-RECEIVE-MAP-EXIT\n\n    END-IF\n    SET PFK-INVALID TO TRUE\n    IF CCARD-AID-ENTER OR\n       CCARD-AID-PFK03 OR\n       CCARD-AID-PFK07 OR\n       CCARD-AID-PFK08\n        SET PFK-VALID TO TRUE\n    END-IF\n\n    IF PFK-INVALID\n       SET CCARD-AID-ENTER TO TRUE\n    END-IF\n    IF  (CCARD-AID-PFK03\n    AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)\n       MOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID\n       MOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM\n       SET  CDEMO-USRTYP-USER TO TRUE\n       SET  CDEMO-PGM-ENTER  TO TRUE\n       MOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET\n       MOVE LIT-THISMAP      TO CDEMO-LAST-MAP\n       MOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM\n\n       MOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET\n       MOVE LIT-THISMAP      TO CCARD-NEXT-MAP\n       SET WS-EXIT-MESSAGE            TO TRUE\n\n       SET CDEMO-PGM-ENTER   TO TRUE\n       EXEC CICS XCTL\n                 PROGRAM (LIT-MENUPGM)\n                 COMMAREA(CARDDEMO-COMMAREA)\n       END-EXEC\n    END-IF\n    IF CCARD-AID-PFK08\n       CONTINUE\n    ELSE\n       SET CA-LAST-PAGE-NOT-SHOWN   TO TRUE\n    END-IF\n    EVALUATE TRUE\n        WHEN INPUT-ERROR\n             MOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG\n             MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM\n             MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\n             MOVE LIT-THISMAP     TO CDEMO-LAST-MAP\n\n             MOVE LIT-THISPGM     TO CCARD-NEXT-PROG\n             MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET\n             MOVE LIT-THISMAP     TO CCARD-NEXT-MAP\n             IF  NOT FLG-ACCTFILTER-NOT-OK\n             AND NOT FLG-CARDFILTER-NOT-OK\n                PERFORM 9000-READ-FORWARD\n                   THRU 9000-READ-FORWARD-EXIT\n             END-IF\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK07\n             AND CA-FIRST-PAGE\n        WHEN CCARD-AID-PFK07\n             AND CA-FIRST-PAGE\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK03\n        WHEN CDEMO-PGM-REENTER AND\n             CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM\n\n             INITIALIZE CARDDEMO-COMMAREA\n                        WS-THIS-PROGCOMMAREA\n             MOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID\n             MOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM\n             SET CDEMO-USRTYP-USER    TO TRUE\n             SET CDEMO-PGM-ENTER      TO TRUE\n             MOVE LIT-THISMAP         TO CDEMO-LAST-MAP\n             MOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET\n             SET CA-FIRST-PAGE        TO TRUE\n             SET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK08\n             AND CA-NEXT-PAGE-EXISTS\n             MOVE WS-CA-LAST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             ADD   +1       TO WS-CA-SCREEN-NUM\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP-EXIT\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-PFK07\n             AND NOT CA-FIRST-PAGE\n\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             SUBTRACT 1    FROM WS-CA-SCREEN-NUM\n             PERFORM 9100-READ-BACKWARDS\n                THRU 9100-READ-BACKWARDS-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP-EXIT\n             GO TO COMMON-RETURN\n        WHEN CCARD-AID-ENTER\n         AND VIEW-REQUESTED-ON(I-SELECTED)\n         AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\n            MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID\n            MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM\n            SET  CDEMO-USRTYP-USER TO TRUE\n            SET  CDEMO-PGM-ENTER   TO TRUE\n            MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET\n            MOVE LIT-THISMAP       TO CDEMO-LAST-MAP\n            MOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG\n\n            MOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET\n            MOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP\n\n            MOVE WS-ROW-ACCTNO (I-SELECTED)\n                                   TO CDEMO-ACCT-ID\n            MOVE WS-ROW-CARD-NUM (I-SELECTED)\n                                   TO CDEMO-CARD-NUM\n\n            EXEC CICS XCTL\n                 PROGRAM (CCARD-NEXT-PROG)\n                 COMMAREA(CARDDEMO-COMMAREA)\n            END-EXEC\n        WHEN CCARD-AID-ENTER\n         AND UPDATE-REQUESTED-ON(I-SELECTED)\n         AND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\n            MOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID\n            MOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM\n            SET  CDEMO-USRTYP-USER TO TRUE\n            SET  CDEMO-PGM-ENTER   TO TRUE\n            MOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET\n            MOVE LIT-THISMAP       TO CDEMO-LAST-MAP\n            MOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG\n\n            MOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET\n            MOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP\n\n            MOVE WS-ROW-ACCTNO (I-SELECTED)\n                                   TO CDEMO-ACCT-ID\n            MOVE WS-ROW-CARD-NUM (I-SELECTED)\n                                   TO CDEMO-CARD-NUM\n\n            EXEC CICS XCTL\n                 PROGRAM (CCARD-NEXT-PROG)\n                 COMMAREA(CARDDEMO-COMMAREA)\n            END-EXEC\n\n        WHEN OTHER\n             MOVE WS-CA-FIRST-CARD-NUM\n                           TO WS-CARD-RID-CARDNUM\n             PERFORM 9000-READ-FORWARD\n                THRU 9000-READ-FORWARD-EXIT\n             PERFORM 1000-SEND-MAP\n                THRU 1000-SEND-MAP\n             GO TO COMMON-RETURN\n    END-EVALUATE\n\n    IF INPUT-ERROR\n       MOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG\n       MOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM\n       MOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\n       MOVE LIT-THISMAP     TO CDEMO-LAST-MAP\n\n       MOVE LIT-THISPGM     TO CCARD-NEXT-PROG\n       MOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET\n       MOVE LIT-THISMAP     TO CCARD-NEXT-MAP\n       GO TO COMMON-RETURN\n    END-IF\n\n    MOVE LIT-THISPGM        TO CCARD-NEXT-PROG\n    GO TO COMMON-RETURN\n    .", "children": [{"name": "YYYY-STORE-PFKEY", "text": "", "children": [], "parents": ["0000-MAIN."]}, {"name": "2000-RECEIVE-MAP", "text": "", "children": [], "parents": ["0000-MAIN."]}, {"name": "9000-READ-FORWARD", "text": "", "children": [], "parents": ["0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN."]}, {"name": "1000-SEND-MAP", "text": "", "children": [], "parents": ["0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN."]}, {"name": "9100-READ-BACKWARDS", "text": "", "children": [], "parents": ["0000-MAIN."]}], "parents": []}, "YYYY-STORE-PFKEY": {"name": "YYYY-STORE-PFKEY", "text": "", "children": [], "parents": ["0000-MAIN."]}, "2000-RECEIVE-MAP": {"name": "2000-RECEIVE-MAP", "text": "", "children": [], "parents": ["0000-MAIN."]}, "9000-READ-FORWARD": {"name": "9000-READ-FORWARD", "text": "", "children": [], "parents": ["0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN."]}, "1000-SEND-MAP": {"name": "1000-SEND-MAP", "text": "", "children": [], "parents": ["0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN.", "0000-MAIN."]}, "9100-READ-BACKWARDS": {"name": "9100-READ-BACKWARDS", "text": "", "children": [], "parents": ["0000-MAIN."]}, "COMMON-RETURN.": {"name": "COMMON-RETURN.", "text": "MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID\n    MOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM\n    MOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\n    MOVE  LIT-THISMAP     TO CDEMO-LAST-MAP\n    MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\n    MOVE  WS-THIS-PROGCOMMAREA TO\n           WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                        LENGTH OF WS-THIS-PROGCOMMAREA )\n\n\n    EXEC CICS RETURN\n         TRANSID (LIT-THISTRANID)\n         COMMAREA (WS-COMMAREA)\n         LENGTH(LENGTH OF WS-COMMAREA)\n    END-EXEC\n    .", "children": [], "parents": []}, "0000-MAIN-EXIT.": {"name": "0000-MAIN-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1000-SEND-MAP.": {"name": "1000-SEND-MAP.", "text": "PERFORM 1100-SCREEN-INIT\n       THRU 1100-SCREEN-INIT-EXIT\n    PERFORM 1200-SCREEN-ARRAY-INIT\n       THRU 1200-SCREEN-ARRAY-INIT-EXIT\n    PERFORM 1250-SETUP-ARRAY-ATTRIBS\n       THRU 1250-SETUP-ARRAY-ATTRIBS-EXIT\n    PERFORM 1300-SETUP-SCREEN-ATTRS\n       THRU 1300-SETUP-SCREEN-ATTRS-EXIT\n    PERFORM 1400-SETUP-MESSAGE\n       THRU 1400-SETUP-MESSAGE-EXIT\n    PERFORM 1500-SEND-SCREEN\n       THRU 1500-SEND-SCREEN-EXIT\n    .", "children": [{"name": "1100-SCREEN-INIT", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1200-SCREEN-ARRAY-INIT", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1250-SETUP-ARRAY-ATTRIBS", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1300-SETUP-SCREEN-ATTRS", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1400-SETUP-MESSAGE", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, {"name": "1500-SEND-SCREEN", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}], "parents": []}, "1100-SCREEN-INIT": {"name": "1100-SCREEN-INIT", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, "1200-SCREEN-ARRAY-INIT": {"name": "1200-SCREEN-ARRAY-INIT", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, "1250-SETUP-ARRAY-ATTRIBS": {"name": "1250-SETUP-ARRAY-ATTRIBS", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, "1300-SETUP-SCREEN-ATTRS": {"name": "1300-SETUP-SCREEN-ATTRS", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, "1400-SETUP-MESSAGE": {"name": "1400-SETUP-MESSAGE", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, "1500-SEND-SCREEN": {"name": "1500-SEND-SCREEN", "text": "", "children": [], "parents": ["1000-SEND-MAP."]}, "1000-SEND-MAP-EXIT.": {"name": "1000-SEND-MAP-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1100-SCREEN-INIT.": {"name": "1100-SCREEN-INIT.", "text": "MOVE LOW-VALUES             TO CCRDLIAO\n\n    MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n    MOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO\n    MOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO\n    MOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO\n    MOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO\n\n    MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\n    MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n    MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n    MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\n    MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO\n\n    MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n    MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n    MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\n    MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO\n    MOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO\n\n    SET WS-NO-INFO-MESSAGE      TO TRUE\n    MOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO\n    MOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO\n    .", "children": [], "parents": []}, "1100-SCREEN-INIT-EXIT.": {"name": "1100-SCREEN-INIT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1200-SCREEN-ARRAY-INIT.": {"name": "1200-SCREEN-ARRAY-INIT.", "text": "IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(2)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(3)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(4)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(5)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO\n    END-IF\n\n\n    IF   WS-EACH-CARD(6)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO\n    END-IF\n\n    IF   WS-EACH-CARD(7)        EQUAL LOW-VALUES\n       CONTINUE\n    ELSE\n       MOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO\n       MOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO\n       MOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO\n       MOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO\n    END-IF\n    .", "children": [], "parents": []}, "1200-SCREEN-ARRAY-INIT-EXIT.": {"name": "1200-SCREEN-ARRAY-INIT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1250-SETUP-ARRAY-ATTRIBS.": {"name": "1250-SETUP-ARRAY-ATTRIBS.", "text": "IF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(1) = '1'\n          MOVE DFHRED               TO CRDSEL1C OF CCRDLIAO\n          IF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES\n             MOVE '*'               TO CRDSEL1O OF CCRDLIAO\n          END-IF\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(2)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(2) = '1'\n          MOVE DFHRED               TO CRDSEL2C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL2L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(3)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI\n\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(3) = '1'\n          MOVE DFHRED               TO CRDSEL3C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL3L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(4)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI\n       I\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(4) = '1'\n          MOVE DFHRED               TO CRDSEL4C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL4L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(5)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(5) = '1'\n          MOVE DFHRED               TO CRDSEL5C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL5L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(6)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI\n\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(6) = '1'\n          MOVE DFHRED               TO CRDSEL6C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL6L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI\n    END-IF\n\n    IF   WS-EACH-CARD(7)            EQUAL LOW-VALUES\n    OR   FLG-PROTECT-SELECT-ROWS-YES\n       MOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI\n    ELSE\n       IF WS-ROW-CRDSELECT-ERROR(7) = '1'\n          MOVE DFHRED               TO CRDSEL7C OF CCRDLIAO\n          MOVE -1                   TO CRDSEL7L OF CCRDLIAI\n       END-IF\n       MOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI\n    END-IF\n    .", "children": [], "parents": []}, "1250-SETUP-ARRAY-ATTRIBS-EXIT.": {"name": "1250-SETUP-ARRAY-ATTRIBS-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1300-SETUP-SCREEN-ATTRS.": {"name": "1300-SETUP-SCREEN-ATTRS.", "text": "IF EIBCALEN = 0\n    OR (CDEMO-PGM-ENTER\n    AND CDEMO-FROM-PROGRAM = LIT-MENUPGM)\n       CONTINUE\n    ELSE\n       EVALUATE TRUE\n           WHEN FLG-ACCTFILTER-ISVALID\n           WHEN FLG-ACCTFILTER-NOT-OK\n              MOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO\n              MOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI\n           WHEN CDEMO-ACCT-ID = 0\n              MOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO\n           WHEN OTHER\n             MOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO\n             MOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI\n       END-EVALUATE\n\n       EVALUATE TRUE\n           WHEN FLG-CARDFILTER-ISVALID\n           WHEN FLG-CARDFILTER-NOT-OK\n              MOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO\n              MOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI\n           WHEN CDEMO-CARD-NUM = 0\n              MOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO\n           WHEN OTHER\n             MOVE CDEMO-CARD-NUM\n                                TO CARDSIDO OF CCRDLIAO\n             MOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI\n       END-EVALUATE\n    END-IF\n\n\n    IF FLG-ACCTFILTER-NOT-OK\n       MOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO\n       MOVE  -1                 TO ACCTSIDL OF CCRDLIAI\n    END-IF\n\n    IF FLG-CARDFILTER-NOT-OK\n       MOVE  DFHRED             TO CARDSIDC OF CCRDLIAO\n       MOVE  -1                 TO CARDSIDL OF CCRDLIAI\n    END-IF\n\n\n    IF INPUT-OK\n      MOVE   -1                 TO ACCTSIDL OF CCRDLIAI\n    END-IF\n\n\n    .", "children": [], "parents": []}, "1300-SETUP-SCREEN-ATTRS-EXIT.": {"name": "1300-SETUP-SCREEN-ATTRS-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1400-SETUP-MESSAGE.": {"name": "1400-SETUP-MESSAGE.", "text": "EVALUATE TRUE\n         WHEN FLG-ACCTFILTER-NOT-OK\n         WHEN FLG-CARDFILTER-NOT-OK\n           CONTINUE\n         WHEN CCARD-AID-PFK07\n             AND CA-FIRST-PAGE\n           MOVE 'NO PREVIOUS PAGES TO DISPLAY'\n           TO WS-ERROR-MSG\n         WHEN CCARD-AID-PFK08\n          AND CA-NEXT-PAGE-NOT-EXISTS\n          AND CA-LAST-PAGE-SHOWN\n           MOVE 'NO MORE PAGES TO DISPLAY'\n           TO WS-ERROR-MSG\n         WHEN CCARD-AID-PFK08\n          AND CA-NEXT-PAGE-NOT-EXISTS\n           SET WS-INFORM-REC-ACTIONS TO TRUE\n           IF  CA-LAST-PAGE-NOT-SHOWN\n           AND CA-NEXT-PAGE-NOT-EXISTS\n               SET CA-LAST-PAGE-SHOWN TO TRUE\n           END-IF\n         WHEN WS-NO-INFO-MESSAGE\n         WHEN CA-NEXT-PAGE-EXISTS\n           SET WS-INFORM-REC-ACTIONS TO TRUE\n         WHEN OTHER\n            SET WS-NO-INFO-MESSAGE TO TRUE\n    END-EVALUATE\n\n    MOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO\n\n    IF  NOT WS-NO-INFO-MESSAGE\n    AND NOT WS-NO-RECORDS-FOUND\n       MOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO\n       MOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO\n    END-IF\n\n    .", "children": [], "parents": []}, "1400-SETUP-MESSAGE-EXIT.": {"name": "1400-SETUP-MESSAGE-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "1500-SEND-SCREEN.": {"name": "1500-SEND-SCREEN.", "text": "EXEC CICS SEND MAP(LIT-THISMAP)\n                   MAPSET(LIT-THISMAPSET)\n                   FROM(CCRDLIAO)\n                   CURSOR\n                   ERASE\n                   RESP(WS-RESP-CD)\n                   FREEKB\n    END-EXEC\n    .", "children": [], "parents": []}, "1500-SEND-SCREEN-EXIT.": {"name": "1500-SEND-SCREEN-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "2000-RECEIVE-MAP.": {"name": "2000-RECEIVE-MAP.", "text": "PERFORM 2100-RECEIVE-SCREEN\n       THRU 2100-RECEIVE-SCREEN-EXIT\n\n    PERFORM 2200-EDIT-INPUTS\n     THRU   2200-EDIT-INPUTS-EXIT\n    .", "children": [{"name": "2100-RECEIVE-SCREEN", "text": "", "children": [], "parents": ["2000-RECEIVE-MAP."]}, {"name": "2200-EDIT-INPUTS", "text": "", "children": [], "parents": ["2000-RECEIVE-MAP."]}], "parents": []}, "2100-RECEIVE-SCREEN": {"name": "2100-RECEIVE-SCREEN", "text": "", "children": [], "parents": ["2000-RECEIVE-MAP."]}, "2200-EDIT-INPUTS": {"name": "2200-EDIT-INPUTS", "text": "", "children": [], "parents": ["2000-RECEIVE-MAP."]}, "2000-RECEIVE-MAP-EXIT.": {"name": "2000-RECEIVE-MAP-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "2100-RECEIVE-SCREEN.": {"name": "2100-RECEIVE-SCREEN.", "text": "EXEC CICS RECEIVE MAP(LIT-THISMAP)\n                   MAPSET(LIT-THISMAPSET)\n                   INTO(CCRDLIAI)\n                   RESP(WS-RESP-CD)\n    END-EXEC\n\n    MOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID\n    MOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM\n\n    MOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)\n    MOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)\n    MOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)\n    MOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)\n    MOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)\n    MOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)\n    MOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)\n    .", "children": [], "parents": []}, "2100-RECEIVE-SCREEN-EXIT.": {"name": "2100-RECEIVE-SCREEN-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "2200-EDIT-INPUTS.": {"name": "2200-EDIT-INPUTS.", "text": "SET INPUT-OK                   TO TRUE\n    SET FLG-PROTECT-SELECT-ROWS-NO TO TRUE\n\n    PERFORM 2210-EDIT-ACCOUNT\n       THRU 2210-EDIT-ACCOUNT-EXIT\n\n    PERFORM 2220-EDIT-CARD\n       THRU 2220-EDIT-CARD-EXIT\n\n    PERFORM 2250-EDIT-ARRAY\n       THRU 2250-EDIT-ARRAY-EXIT\n    .", "children": [{"name": "2210-EDIT-ACCOUNT", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, {"name": "2220-EDIT-CARD", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, {"name": "2250-EDIT-ARRAY", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}], "parents": []}, "2210-EDIT-ACCOUNT": {"name": "2210-EDIT-ACCOUNT", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, "2220-EDIT-CARD": {"name": "2220-EDIT-CARD", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, "2250-EDIT-ARRAY": {"name": "2250-EDIT-ARRAY", "text": "", "children": [], "parents": ["2200-EDIT-INPUTS."]}, "2200-EDIT-INPUTS-EXIT.": {"name": "2200-EDIT-INPUTS-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "2210-EDIT-ACCOUNT.": {"name": "2210-EDIT-ACCOUNT.", "text": "SET FLG-ACCTFILTER-BLANK TO TRUE\n\n    IF CC-ACCT-ID   EQUAL LOW-VALUES\n    OR CC-ACCT-ID   EQUAL SPACES\n    OR CC-ACCT-ID-N EQUAL ZEROS\n       SET FLG-ACCTFILTER-BLANK  TO TRUE\n       MOVE ZEROES       TO CDEMO-ACCT-ID\n       GO TO  2210-EDIT-ACCOUNT-EXIT\n    END-IF\n    IF CC-ACCT-ID  IS NOT NUMERIC\n       SET INPUT-ERROR TO TRUE\n       SET FLG-ACCTFILTER-NOT-OK TO TRUE\n       SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\n       MOVE\n       'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'\n                       TO WS-ERROR-MSG\n       MOVE ZERO       TO CDEMO-ACCT-ID\n       GO TO 2210-EDIT-ACCOUNT-EXIT\n    ELSE\n       MOVE CC-ACCT-ID TO CDEMO-ACCT-ID\n       SET FLG-ACCTFILTER-ISVALID TO TRUE\n    END-IF\n    .", "children": [], "parents": []}, "2210-EDIT-ACCOUNT-EXIT.": {"name": "2210-EDIT-ACCOUNT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "2220-EDIT-CARD.": {"name": "2220-EDIT-CARD.", "text": "SET FLG-CARDFILTER-BLANK TO TRUE\n\n    IF CC-CARD-NUM   EQUAL LOW-VALUES\n    OR CC-CARD-NUM   EQUAL SPACES\n    OR CC-CARD-NUM-N EQUAL ZEROS\n       SET FLG-CARDFILTER-BLANK  TO TRUE\n       MOVE ZEROES       TO CDEMO-CARD-NUM\n       GO TO  2220-EDIT-CARD-EXIT\n    END-IF\n    IF CC-CARD-NUM  IS NOT NUMERIC\n       SET INPUT-ERROR TO TRUE\n       SET FLG-CARDFILTER-NOT-OK TO TRUE\n       SET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\n       IF WS-ERROR-MSG-OFF\n          MOVE\n       'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'\n                       TO WS-ERROR-MSG\n       END-IF\n       MOVE ZERO       TO CDEMO-CARD-NUM\n       GO TO 2220-EDIT-CARD-EXIT\n    ELSE\n       MOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM\n       SET FLG-CARDFILTER-ISVALID TO TRUE\n    END-IF\n    .", "children": [], "parents": []}, "2220-EDIT-CARD-EXIT.": {"name": "2220-EDIT-CARD-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "2250-EDIT-ARRAY.": {"name": "2250-EDIT-ARRAY.", "text": "IF INPUT-ERROR\n       GO TO 2250-EDIT-ARRAY-EXIT\n    END-IF\n\n    INSPECT  WS-EDIT-SELECT-FLAGS\n    TALLYING I\n    FOR ALL 'S'\n        ALL 'U'\n\n    IF I > +1\n        SET INPUT-ERROR      TO TRUE\n        SET WS-MORE-THAN-1-ACTION TO TRUE\n\n        MOVE WS-EDIT-SELECT-FLAGS\n                            TO WS-EDIT-SELECT-ERROR-FLAGS\n        INSPECT WS-EDIT-SELECT-ERROR-FLAGS\n          REPLACING ALL 'S' BY '1'\n                    ALL 'U' BY '1'\n          CHARACTERS        BY '0'\n\n    END-IF\n\n    MOVE ZERO TO I-SELECTED\n\n    PERFORM VARYING I FROM 1 BY 1 UNTIL I > 7\n        EVALUATE TRUE\n          WHEN SELECT-OK(I)\n            MOVE I TO I-SELECTED\n            IF WS-MORE-THAN-1-ACTION\n               MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\n            END-IF\n          WHEN SELECT-BLANK(I)\n            CONTINUE\n          WHEN OTHER\n            SET INPUT-ERROR TO TRUE\n            MOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\n            IF WS-ERROR-MSG-OFF\n               SET WS-INVALID-ACTION-CODE TO TRUE\n            END-IF\n       END-EVALUATE\n    END-PERFORM\n\n    .", "children": [{"name": "VARYING", "text": "", "children": [], "parents": ["2250-EDIT-ARRAY."]}], "parents": []}, "VARYING": {"name": "VARYING", "text": "", "children": [], "parents": ["2250-EDIT-ARRAY."]}, "2250-EDIT-ARRAY-EXIT.": {"name": "2250-EDIT-ARRAY-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "9000-READ-FORWARD.": {"name": "9000-READ-FORWARD.", "text": "MOVE LOW-VALUES           TO WS-ALL-ROWS\n\n    EXEC CICS STARTBR\n         DATASET(LIT-CARD-FILE)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         GTEQ\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n    MOVE ZEROES TO WS-SCRN-COUNTER\n    SET CA-NEXT-PAGE-EXISTS    TO TRUE\n    SET MORE-RECORDS-TO-READ   TO TRUE\n\n    PERFORM UNTIL READ-LOOP-EXIT\n\n    EXEC CICS READNEXT\n         DATASET(LIT-CARD-FILE)\n         INTO (CARD-RECORD)\n         LENGTH(LENGTH OF CARD-RECORD)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n\n    EVALUATE WS-RESP-CD\n        WHEN DFHRESP(NORMAL)\n        WHEN DFHRESP(DUPREC)\n            PERFORM 9500-FILTER-RECORDS\n               THRU 9500-FILTER-RECORDS-EXIT\n\n            IF WS-DONOT-EXCLUDE-THIS-RECORD\n               ADD 1             TO WS-SCRN-COUNTER\n\n               MOVE CARD-NUM     TO WS-ROW-CARD-NUM(\n               WS-SCRN-COUNTER)\n               MOVE CARD-ACCT-ID TO\n               WS-ROW-ACCTNO(WS-SCRN-COUNTER)\n               MOVE CARD-ACTIVE-STATUS\n                                 TO WS-ROW-CARD-STATUS(\n                                 WS-SCRN-COUNTER)\n\n               IF WS-SCRN-COUNTER = 1\n                  MOVE CARD-ACCT-ID\n                                 TO WS-CA-FIRST-CARD-ACCT-ID\n                  MOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM\n                  IF   WS-CA-SCREEN-NUM = 0\n                    ADD   +1     TO WS-CA-SCREEN-NUM\n                  ELSE\n                    CONTINUE\n                  END-IF\n               ELSE\n                  CONTINUE\n               END-IF\n            ELSE\n                CONTINUE\n            END-IF\n            IF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES\n               SET READ-LOOP-EXIT  TO TRUE\n\n               MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\n               MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\n\n               EXEC CICS READNEXT\n                 DATASET(LIT-CARD-FILE)\n                 INTO (CARD-RECORD)\n                 LENGTH(LENGTH OF CARD-RECORD)\n                 RIDFLD(WS-CARD-RID-CARDNUM)\n                 KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n                 RESP(WS-RESP-CD)\n                 RESP2(WS-REAS-CD)\n               END-EXEC\n\n               EVALUATE WS-RESP-CD\n                  WHEN DFHRESP(NORMAL)\n                  WHEN DFHRESP(DUPREC)\n                       SET CA-NEXT-PAGE-EXISTS\n                                         TO TRUE\n                       MOVE CARD-ACCT-ID TO\n                            WS-CA-LAST-CARD-ACCT-ID\n                       MOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM\n                 WHEN DFHRESP(ENDFILE)\n                     SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\n\n                     IF WS-ERROR-MSG-OFF\n                         MOVE 'NO MORE RECORDS TO SHOW'\n                                         TO WS-ERROR-MSG\n                     END-IF\n                     WHEN OTHER\n                     SET READ-LOOP-EXIT      TO TRUE\n                     MOVE 'READ'              TO ERROR-OPNAME\n                     MOVE LIT-CARD-FILE       TO ERROR-FILE\n                     MOVE WS-RESP-CD          TO ERROR-RESP\n                     MOVE WS-REAS-CD          TO ERROR-RESP2\n                   MOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG\n               END-EVALUATE\n           END-IF\n        WHEN DFHRESP(ENDFILE)\n           SET READ-LOOP-EXIT              TO TRUE\n           SET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\n           MOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\n           MOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\n           IF WS-ERROR-MSG-OFF\n              MOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG\n           END-IF\n           IF WS-CA-SCREEN-NUM = 1\n           AND WS-SCRN-COUNTER = 0\n               SET WS-NO-RECORDS-FOUND    TO TRUE\n           END-IF\n        WHEN OTHER\n           SET READ-LOOP-EXIT             TO TRUE\n           MOVE 'READ'                     TO ERROR-OPNAME\n           MOVE LIT-CARD-FILE              TO ERROR-FILE\n           MOVE WS-RESP-CD                 TO ERROR-RESP\n           MOVE WS-REAS-CD                 TO ERROR-RESP2\n           MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\n    END-EVALUATE\n    END-PERFORM\n\n    EXEC CICS ENDBR FILE(LIT-CARD-FILE)\n    END-EXEC\n    .", "children": [{"name": "UNTIL", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}, {"name": "9500-FILTER-RECORDS", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}], "parents": []}, "UNTIL": {"name": "UNTIL", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}, "9500-FILTER-RECORDS": {"name": "9500-FILTER-RECORDS", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}, "9000-READ-FORWARD-EXIT.": {"name": "9000-READ-FORWARD-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "9100-READ-BACKWARDS.": {"name": "9100-READ-BACKWARDS.", "text": "MOVE LOW-VALUES           TO WS-ALL-ROWS\n\n    MOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY\n\n    EXEC CICS STARTBR\n         DATASET(LIT-CARD-FILE)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         GTEQ\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n    COMPUTE WS-SCRN-COUNTER =\n                            WS-MAX-SCREEN-LINES + 1\n    END-COMPUTE\n    SET CA-NEXT-PAGE-EXISTS    TO TRUE\n    SET MORE-RECORDS-TO-READ   TO TRUE\n\n\n    EXEC CICS READPREV\n         DATASET(LIT-CARD-FILE)\n         INTO (CARD-RECORD)\n         LENGTH(LENGTH OF CARD-RECORD)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n\n    EVALUATE WS-RESP-CD\n        WHEN DFHRESP(NORMAL)\n        WHEN DFHRESP(DUPREC)\n            SUBTRACT 1          FROM WS-SCRN-COUNTER\n        WHEN OTHER\n           SET READ-LOOP-EXIT             TO TRUE\n           MOVE 'READ'                     TO ERROR-OPNAME\n           MOVE LIT-CARD-FILE              TO ERROR-FILE\n           MOVE WS-RESP-CD                 TO ERROR-RESP\n           MOVE WS-REAS-CD                 TO ERROR-RESP2\n           MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\n           GO TO 9100-READ-BACKWARDS-EXIT\n    END-EVALUATE\n\n    PERFORM UNTIL READ-LOOP-EXIT\n\n    EXEC CICS READPREV\n         DATASET(LIT-CARD-FILE)\n         INTO (CARD-RECORD)\n         LENGTH(LENGTH OF CARD-RECORD)\n         RIDFLD(WS-CARD-RID-CARDNUM)\n         KEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\n         RESP(WS-RESP-CD)\n         RESP2(WS-REAS-CD)\n    END-EXEC\n\n    EVALUATE WS-RESP-CD\n        WHEN DFHRESP(NORMAL)\n        WHEN DFHRESP(DUPREC)\n            PERFORM 9500-FILTER-RECORDS\n               THRU 9500-FILTER-RECORDS-EXIT\n            IF WS-DONOT-EXCLUDE-THIS-RECORD\n               MOVE CARD-NUM\n                           TO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)\n               MOVE CARD-ACCT-ID\n                           TO WS-ROW-ACCTNO(WS-SCRN-COUNTER)\n               MOVE CARD-ACTIVE-STATUS\n                           TO\n                           WS-ROW-CARD-STATUS(WS-SCRN-COUNTER)\n\n               SUBTRACT 1  FROM WS-SCRN-COUNTER\n               IF WS-SCRN-COUNTER = 0\n                  SET READ-LOOP-EXIT  TO TRUE\n\n                  MOVE CARD-ACCT-ID\n                           TO WS-CA-FIRST-CARD-ACCT-ID\n                  MOVE CARD-NUM\n                           TO WS-CA-FIRST-CARD-NUM\n               ELSE\n                  CONTINUE\n               END-IF\n            ELSE\n                CONTINUE\n            END-IF\n\n        WHEN OTHER\n           SET READ-LOOP-EXIT             TO TRUE\n           MOVE 'READ'                     TO ERROR-OPNAME\n           MOVE LIT-CARD-FILE              TO ERROR-FILE\n           MOVE WS-RESP-CD                 TO ERROR-RESP\n           MOVE WS-REAS-CD                 TO ERROR-RESP2\n           MOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\n    END-EVALUATE\n    END-PERFORM\n    .", "children": [{"name": "UNTIL", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}, {"name": "9500-FILTER-RECORDS", "text": "", "children": [], "parents": ["9000-READ-FORWARD.", "9100-READ-BACKWARDS."]}], "parents": []}, "9100-READ-BACKWARDS-EXIT.": {"name": "9100-READ-BACKWARDS-EXIT.", "text": "EXEC CICS\n         ENDBR FILE(LIT-CARD-FILE)\n    END-EXEC\n\n    EXIT\n    .", "children": [], "parents": []}, "9500-FILTER-RECORDS.": {"name": "9500-FILTER-RECORDS.", "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\n    IF FLG-ACCTFILTER-ISVALID\n       IF  CARD-ACCT-ID = CC-ACCT-ID\n           CONTINUE\n       ELSE\n           SET WS-EXCLUDE-THIS-RECORD  TO TRUE\n           GO TO 9500-FILTER-RECORDS-EXIT\n       END-IF\n    ELSE\n      CONTINUE\n    END-IF\n\n    IF FLG-CARDFILTER-ISVALID\n       IF  CARD-NUM = CC-CARD-NUM-N\n           CONTINUE\n       ELSE\n           SET WS-EXCLUDE-THIS-RECORD TO TRUE\n           GO TO 9500-FILTER-RECORDS-EXIT\n       END-IF\n    ELSE\n      CONTINUE\n    END-IF\n\n    .", "children": [], "parents": []}, "9500-FILTER-RECORDS-EXIT.": {"name": "9500-FILTER-RECORDS-EXIT.", "text": "EXIT\n    .\n\nCOPY 'CSSTRPFY'\n    .", "children": [], "parents": []}, "SEND-PLAIN-TEXT.": {"name": "SEND-PLAIN-TEXT.", "text": "EXEC CICS SEND TEXT\n              FROM(WS-ERROR-MSG)\n              LENGTH(LENGTH OF WS-ERROR-MSG)\n              ERASE\n              FREEKB\n    END-EXEC\n\n    EXEC CICS RETURN\n    END-EXEC\n    .", "children": [], "parents": []}, "SEND-PLAIN-TEXT-EXIT.": {"name": "SEND-PLAIN-TEXT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}, "SEND-LONG-TEXT.": {"name": "SEND-LONG-TEXT.", "text": "EXEC CICS SEND TEXT\n              FROM(WS-LONG-MSG)\n              LENGTH(LENGTH OF WS-LONG-MSG)\n              ERASE\n              FREEKB\n    END-EXEC\n\n    EXEC CICS RETURN\n    END-EXEC\n    .", "children": [], "parents": []}, "SEND-LONG-TEXT-EXIT.": {"name": "SEND-LONG-TEXT-EXIT.", "text": "EXIT\n    .", "children": [], "parents": []}};

        const width = window.innerWidth;
        const height = window.innerHeight;

        const tooltip = d3.select(".tooltip");

        const svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height)
            .call(d3.zoom().on("zoom", (event) => {
                g.attr("transform", event.transform);
            }))
            .append("g");

        const defs = svg.append("defs");
        defs.append("marker")
            .attr("id", "arrow")
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 10)
            .attr("refY", 0)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M0,-5L10,0L0,5")
            .attr("fill", "#d2b48c");

        const g = svg.append("g")
            .attr("transform", "translate(50, 50)");

        const tree = d3.tree().size([height - 200, width - 200]);

        const root = d3.hierarchy(data);

        root.descendants().forEach((d, i) => {
            d.id = i;
            d.x0 = d.x || 0;
            d.y0 = d.y || 0;
            d._children = d.children;
            d.children = d.depth < 3 ? d.children : null;
        });

        const colorScale = d3.scaleSequential(d3.interpolateCool)
            .domain([0, 10]);

        const update = (source) => {
            const nodes = root.descendants();
            const links = root.links();

            tree(root);

            // Links
            const link = g.selectAll(".link")
                .data(links, d => d.target.id);

            link.enter().append("line")
                .attr("class", "link")
                .merge(link)
                .transition()
                .duration(300)
                .attr("x1", d => d.source.y)
                .attr("y1", d => d.source.x)
                .attr("x2", d => d.target.y)
                .attr("y2", d => d.target.x)
                .attr("stroke", "#d2b48c")
                .attr("stroke-width", 1.5);

            link.exit().remove();

            // Add multiple parent arrows
            Object.keys(paragraphs).forEach(paragraph => {
                if (paragraphs[paragraph].parents) {
                    paragraphs[paragraph].parents.forEach(parent => {
                        const sourceNode = nodes.find(n => n.data.name === parent);
                        const targetNode = nodes.find(n => n.data.name === paragraph);
                        if (sourceNode && targetNode) {
                            g.append("line")
                                .attr("class", "link")
                                .attr("x1", sourceNode.y)
                                .attr("y1", sourceNode.x)
                                .attr("x2", targetNode.y)
                                .attr("y2", targetNode.x)
                                .attr("stroke", "#d2b48c")
                                .attr("stroke-width", 1.5)
                                .attr("marker-end", "url(#arrow)");
                        }
                    });
                }
            });

            // Nodes
            const node = g.selectAll(".node")
                .data(nodes, d => d.id);

            const nodeEnter = node.enter().append("g")
                .attr("class", "node")
                .attr("transform", "translate(" + d.y0 + "," + d.x0 + ")")
                .on("mouseover", (event, d) => {
                    if (d.data.text) {
                        tooltip.style("visibility", "visible")
                            .html(d.data.text.substring(0, 50) + "...");
                    }
                })
                .on("mousemove", (event) => {
                    tooltip.style("top", (event.pageY + 10) + "px")
                        .style("left", (event.pageX + 10) + "px");
                })
                .on("mouseout", () => {
                    tooltip.style("visibility", "hidden");
                })
                .on("click", (event, d) => {
                    d.children = d.children ? null : d._children;
                    update(d);
                });

            nodeEnter.append("circle")
                .attr("r", 8)
                .attr("fill", d => d.data.name === "EXEC CICS" ? "#ffcc00" : colorScale(d.depth))
                .attr("stroke", d => d.data.name === "EXEC CICS" ? "#ff9900" : (d._children ? "#000" : "#aaa"))
                .attr("stroke-width", d => d.data.name === "EXEC CICS" ? 2.5 : (d._children ? 2 : 1));

            nodeEnter.append("text")
                .attr("dy", 3)
                .attr("x", d => d.children || d._children ? -10 : 10)
                .style("text-anchor", d => d.children || d._children ? "end" : "start")
                .text(d => d.data.name);

            const nodeUpdate = nodeEnter.merge(node);

            nodeUpdate.transition()
                .duration(300)
                .attr("transform", "translate(" + d.y + "," + d.x + ")");

            nodes.forEach(d => {
                d.x0 = d.x;
                d.y0 = d.y;
            });

            node.exit().transition()
                .duration(300)
                .remove();
        };

        update(root);
    </script>
</body>
</html>
    