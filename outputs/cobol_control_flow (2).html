
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <title>COBOL Control Flow Graph</title>
    <style>
        body {{
            font-family: sans-serif;
            background-color: white;
            margin: 0;
        }}
        .node circle {{
            stroke-width: 1.5px;
            cursor: pointer;
        }}
        .node text {{
            font-size: 14px;
        }}
        .link {{
            fill: none;
            stroke: #888;
            stroke-width: 1.5px;
            marker-end: url(#arrow);
        }}
    </style>
</head>
<body>
    <script>
        const data = {
  "name": null,
  "children": [
    {
      "name": "PROGRAM-ID",
      "children": [],
      "text": ""
    },
    {
      "name": "COCRDLIC",
      "children": [],
      "text": ""
    },
    {
      "name": "DATE-WRITTEN",
      "children": [],
      "text": "April 2022."
    },
    {
      "name": "DATE-COMPILED",
      "children": [],
      "text": ""
    },
    {
      "name": "Today",
      "children": [],
      "text": "\nENVIRONMENT DIVISION.\nINPUT-OUTPUT SECTION.\n\nDATA DIVISION.\n\nWORKING-STORAGE SECTION.\n\n\n01  WS-MISC-STORAGE.\n******************************************************************\n* General CICS related\n******************************************************************\n\n05 WS-CICS-PROCESSNG-VARS.\n07 WS-RESP-CD                          PIC S9(09) COMP\nVALUE ZEROS.\n07 WS-REAS-CD                          PIC S9(09) COMP\nVALUE ZEROS.\n07 WS-TRANID                           PIC X(4)\nVALUE SPACES.\n******************************************************************\n* Input edits\n******************************************************************\n05 WS-INPUT-FLAG                          PIC X(1).\n88  INPUT-OK                            VALUES '0'\n' '"
    },
    {
      "name": "LOW-VALUES",
      "children": [],
      "text": "05 WS-EDIT-SELECT-ERROR-FLAGS             PIC X(7).\n05 WS-EDIT-SELECT-ERROR-FLAGX     REDEFINES"
    },
    {
      "name": "WS-EDIT-SELECT-ERROR-FLAGS",
      "children": [],
      "text": "10 WS-EDIT-SELECT-ERRORS OCCURS 7 TIMES.\n20 WS-ROW-CRDSELECT-ERROR          PIC X(1).\n88 WS-ROW-SELECT-ERROR          VALUE '1'.\n05 WS-SUBSCRIPT-VARS.\n10 I                                  PIC S9(4) COMP\nVALUE 0.\n10 I-SELECTED                         PIC S9(4) COMP\nVALUE 0.\n88 DETAIL-WAS-REQUESTED            VALUES 1 THRU 7.\n******************************************************************\n* Output edits\n******************************************************************\n05 CICS-OUTPUT-EDIT-VARS.\n10  CARD-ACCT-ID-X                      PIC X(11).\n10  CARD-ACCT-ID-N REDEFINES CARD-ACCT-ID-X\nPIC 9(11).\n10  CARD-CVV-CD-X                       PIC X(03).\n10  CARD-CVV-CD-N REDEFINES  CARD-CVV-CD-X\nPIC 9(03).\n10  FLG-PROTECT-SELECT-ROWS             PIC X(1).\n88  FLG-PROTECT-SELECT-ROWS-NO          VALUE '0'.\n88  FLG-PROTECT-SELECT-ROWS-YES         VALUE '1'.\n******************************************************************\n* Output Message Construction\n******************************************************************\n05  WS-LONG-MSG                           PIC X(500).\n05  WS-INFO-MSG                           PIC X(45).\n88  WS-NO-INFO-MESSAGE                 VALUES\nSPACES LOW-VALUES.\n88  WS-INFORM-REC-ACTIONS          VALUE\n'TYPE S FOR DETAIL, U TO UPDATE ANY RECORD'.\n05  WS-ERROR-MSG                         PIC X(75).\n88  WS-ERROR-MSG-OFF                   VALUE SPACES.\n88  WS-EXIT-MESSAGE                     VALUE\n'PF03 PRESSED.EXITING'.\n88  WS-NO-RECORDS-FOUND                 VALUE\n'NO RECORDS FOUND FOR THIS SEARCH CONDITION.'.\n88  WS-MORE-THAN-1-ACTION              VALUE\n'PLEASE SELECT ONLY ONE RECORD TO VIEW OR UPDATE'.\n88  WS-INVALID-ACTION-CODE              VALUE\n'INVALID ACTION CODE'.\n05  WS-PFK-FLAG                           PIC X(1).\n88  PFK-VALID                           VALUE '0'.\n88  PFK-INVALID                         VALUE '1'.\n05  WS-CONTEXT-FLAG                       PIC X(1).\n88  WS-CONTEXT-FRESH-START              VALUE '0'.\n88  WS-CONTEXT-FRESH-START-NO           VALUE '1'.\n******************************************************************\n* File and data Handling\n******************************************************************\n05 WS-FILE-HANDLING-VARS.\n10  WS-CARD-RID.\n20  WS-CARD-RID-CARDNUM            PIC X(16).\n20  WS-CARD-RID-ACCT-ID            PIC 9(11).\n20  WS-CARD-RID-ACCT-ID-X          REDEFINES\nWS-CARD-RID-ACCT-ID            PIC X(11).\n\n\n\n05  WS-SCRN-COUNTER               PIC S9(4) COMP VALUE 0.\n\n05  WS-FILTER-RECORD-FLAG                 PIC X(1).\n88  WS-EXCLUDE-THIS-RECORD               VALUE '0'.\n88  WS-DONOT-EXCLUDE-THIS-RECORD         VALUE '1'.\n05  WS-RECORDS-TO-PROCESS-FLAG            PIC X(1).\n88  READ-LOOP-EXIT                      VALUE '0'.\n88  MORE-RECORDS-TO-READ                VALUE '1'.\n05  WS-FILE-ERROR-MESSAGE.\n10  FILLER                              PIC X(12)\nVALUE 'File Error:'.\n10  ERROR-OPNAME                        PIC X(8)\nVALUE SPACES.\n10  FILLER                              PIC X(4)\nVALUE ' on '.\n10  ERROR-FILE                          PIC X(9)\nVALUE SPACES.\n10  FILLER                              PIC X(15)\nVALUE\n' returned RESP '.\n10  ERROR-RESP                          PIC X(10)\nVALUE SPACES.\n10  FILLER                              PIC X(7)\nVALUE ',RESP2 '.\n10  ERROR-RESP2                         PIC X(10)\nVALUE SPACES.\n10  FILLER                               PIC X(5).\n\n******************************************************************\n* Literals and Constants\n******************************************************************\n01 WS-CONSTANTS.\n05  WS-MAX-SCREEN-LINES                    PIC S9(4) COMP\nVALUE 7.\n05  LIT-THISPGM                            PIC X(8)\nVALUE 'COCRDLIC'.\n05  LIT-THISTRANID                         PIC X(4)\nVALUE 'CCLI'.\n05  LIT-THISMAPSET                         PIC X(7)\nVALUE 'COCRDLI'.\n05  LIT-THISMAP                            PIC X(7)\nVALUE 'CCRDLIA'.\n05  LIT-MENUPGM                            PIC X(8)\nVALUE 'COMEN01C'.\n05  LIT-MENUTRANID                         PIC X(4)\nVALUE 'CM00'.\n05  LIT-MENUMAPSET                         PIC X(7)\nVALUE 'COMEN01'.\n05  LIT-MENUMAP                            PIC X(7)\nVALUE 'COMEN1A'.\n05  LIT-CARDDTLPGM                         PIC X(8)\nVALUE 'COCRDSLC'.\n05  LIT-CARDDTLTRANID                      PIC X(4)\nVALUE 'CCDL'.\n05  LIT-CARDDTLMAPSET                      PIC X(7)\nVALUE 'COCRDSL'.\n05  LIT-CARDDTLMAP                         PIC X(7)\nVALUE 'CCRDSLA'.\n05  LIT-CARDUPDPGM                         PIC X(8)\nVALUE 'COCRDUPC'.\n05  LIT-CARDUPDTRANID                      PIC X(4)\nVALUE 'CCUP'.\n05  LIT-CARDUPDMAPSET                      PIC X(7)\nVALUE 'COCRDUP'.\n05  LIT-CARDUPDMAP                         PIC X(7)\nVALUE 'CCRDUPA'.\n\n\n05  LIT-CARD-FILE                          PIC X(8)\nVALUE 'CARDDAT '.\n05  LIT-CARD-FILE-ACCT-PATH                PIC X(8)\n\nVALUE 'CARDAIX '.\n******************************************************************\n*Other common working storage Variables\n******************************************************************\nCOPY CVCRD01Y.\n\n******************************************************************\n*  Commarea manipulations\n******************************************************************\n*Application Commmarea Copybook\nCOPY COCOM01Y.\n\n01 WS-THIS-PROGCOMMAREA.\n10 WS-CA-LAST-CARDKEY.\n15  WS-CA-LAST-CARD-NUM                PIC X(16).\n15  WS-CA-LAST-CARD-ACCT-ID            PIC 9(11).\n10 WS-CA-FIRST-CARDKEY.\n15  WS-CA-FIRST-CARD-NUM               PIC X(16).\n15  WS-CA-FIRST-CARD-ACCT-ID           PIC 9(11).\n\n10 WS-CA-SCREEN-NUM                       PIC 9(1).\n88 CA-FIRST-PAGE                          VALUE 1.\n10 WS-CA-LAST-PAGE-DISPLAYED              PIC 9(1).\n88 CA-LAST-PAGE-SHOWN                     VALUE 0.\n88 CA-LAST-PAGE-NOT-SHOWN                 VALUE 9.\n10 WS-CA-NEXT-PAGE-IND                    PIC X(1).\n88 CA-NEXT-PAGE-NOT-EXISTS             VALUE LOW-VALUES.\n88 CA-NEXT-PAGE-EXISTS                 VALUE 'Y'.\n\n10 WS-RETURN-FLAG                        PIC X(1).\n88  WS-RETURN-FLAG-OFF                  VALUE LOW-VALUES.\n88  WS-RETURN-FLAG-ON                   VALUE '1'.\n******************************************************************\n*  File Data Array         28 CHARS X 7 ROWS = 196\n******************************************************************\n05 WS-SCREEN-DATA.\n10 WS-ALL-ROWS                         PIC X(196).\n10 FILLER REDEFINES WS-ALL-ROWS.\n15 WS-SCREEN-ROWS OCCURS  7 TIMES.\n20 WS-EACH-ROW.\n25 WS-EACH-CARD.\n30 WS-ROW-ACCTNO           PIC X(11).\n30 WS-ROW-CARD-NUM         PIC X(16).\n30 WS-ROW-CARD-STATUS      PIC X(1).\n\n01  WS-COMMAREA                             PIC X(2000).\n\n\n\n*IBM SUPPLIED COPYBOOKS\nCOPY DFHBMSCA.\nCOPY DFHAID.\n\n*COMMON COPYBOOKS\n*Screen Titles\nCOPY COTTL01Y.\n*Credit Card Search Screen Layout\n*COPY COCRDSL.\n*Credit Card List Screen Layout\nCOPY COCRDLI.\n\n*Current Date\nCOPY CSDAT01Y.\n*Common Messages\nCOPY CSMSG01Y.\n*Abend Variables\n*COPY CSMSG02Y.\n*Signed on user data\nCOPY CSUSR01Y.\n\n*Dataset layouts\n\n*CARD RECORD LAYOUT\nCOPY CVACT02Y.\n\nLINKAGE SECTION.\n01  DFHCOMMAREA.\n05  FILLER                                PIC X(1)\nOCCURS 1 TO 32767 TIMES DEPENDING ON EIBCALEN.\n\nPROCEDURE DIVISION."
    },
    {
      "name": "0000-MAIN",
      "children": [
        {
          "name": "YYYY-STORE-PFKEY",
          "children": [],
          "text": ""
        },
        {
          "name": "2000-RECEIVE-MAP",
          "children": [
            {
              "name": "2100-RECEIVE-SCREEN",
              "children": [],
              "text": "EXEC CICS RECEIVE MAP(LIT-THISMAP)\nMAPSET(LIT-THISMAPSET)\nINTO(CCRDLIAI)\nRESP(WS-RESP-CD)\nEND-EXEC\n\nMOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID\nMOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM\n\nMOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)\nMOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)\nMOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)\nMOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)\nMOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)\nMOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)\nMOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)\n.\n"
            },
            {
              "name": "2200-EDIT-INPUTS",
              "children": [
                {
                  "name": "2210-EDIT-ACCOUNT",
                  "children": [],
                  "text": "SET FLG-ACCTFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-ACCT-ID   EQUAL LOW-VALUES\nOR CC-ACCT-ID   EQUAL SPACES\nOR CC-ACCT-ID-N EQUAL ZEROS\nSET FLG-ACCTFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-ACCT-ID\nGO TO  2210-EDIT-ACCOUNT-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 11 characters\nIF CC-ACCT-ID  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-ACCTFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nMOVE\n'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'\nTO WS-ERROR-MSG\nMOVE ZERO       TO CDEMO-ACCT-ID\nGO TO 2210-EDIT-ACCOUNT-EXIT\nELSE\nMOVE CC-ACCT-ID TO CDEMO-ACCT-ID\nSET FLG-ACCTFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
                },
                {
                  "name": "2220-EDIT-CARD",
                  "children": [],
                  "text": "*    Not numeric\n*    Not 16 characters\nSET FLG-CARDFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-CARD-NUM   EQUAL LOW-VALUES\nOR CC-CARD-NUM   EQUAL SPACES\nOR CC-CARD-NUM-N EQUAL ZEROS\nSET FLG-CARDFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-CARD-NUM\nGO TO  2220-EDIT-CARD-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 16 characters\nIF CC-CARD-NUM  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-CARDFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nIF WS-ERROR-MSG-OFF\nMOVE\n'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'\nTO WS-ERROR-MSG\nEND-IF\nMOVE ZERO       TO CDEMO-CARD-NUM\nGO TO 2220-EDIT-CARD-EXIT\nELSE\nMOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM\nSET FLG-CARDFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
                },
                {
                  "name": "2250-EDIT-ARRAY",
                  "children": [
                    {
                      "name": "VARYING",
                      "children": [],
                      "text": ""
                    }
                  ],
                  "text": "\nIF INPUT-ERROR\nGO TO 2250-EDIT-ARRAY-EXIT\nEND-IF\n\nINSPECT  WS-EDIT-SELECT-FLAGS\nTALLYING I\nFOR ALL 'S'\nALL 'U'\n\nIF I > +1\nSET INPUT-ERROR      TO TRUE\nSET WS-MORE-THAN-1-ACTION TO TRUE\n\nMOVE WS-EDIT-SELECT-FLAGS\nTO WS-EDIT-SELECT-ERROR-FLAGS\nINSPECT WS-EDIT-SELECT-ERROR-FLAGS\nREPLACING ALL 'S' BY '1'\nALL 'U' BY '1'\nCHARACTERS        BY '0'\n\nEND-IF\n\nMOVE ZERO TO I-SELECTED\n\nPERFORM VARYING I FROM 1 BY 1 UNTIL I > 7\nEVALUATE TRUE\nWHEN SELECT-OK(I)\nMOVE I TO I-SELECTED\nIF WS-MORE-THAN-1-ACTION\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nEND-IF\nWHEN SELECT-BLANK(I)\nCONTINUE\nWHEN OTHER\nSET INPUT-ERROR TO TRUE\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nIF WS-ERROR-MSG-OFF\nSET WS-INVALID-ACTION-CODE TO TRUE\nEND-IF\nEND-EVALUATE\nEND-PERFORM\n\n.\n"
                }
              ],
              "text": "SET INPUT-OK                   TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-NO TO TRUE\n\nPERFORM 2210-EDIT-ACCOUNT\nTHRU 2210-EDIT-ACCOUNT-EXIT\n\nPERFORM 2220-EDIT-CARD\nTHRU 2220-EDIT-CARD-EXIT\n\nPERFORM 2250-EDIT-ARRAY\nTHRU 2250-EDIT-ARRAY-EXIT\n.\n"
            }
          ],
          "text": "PERFORM 2100-RECEIVE-SCREEN\nTHRU 2100-RECEIVE-SCREEN-EXIT\n\nPERFORM 2200-EDIT-INPUTS\nTHRU   2200-EDIT-INPUTS-EXIT\n.\n"
        },
        {
          "name": "9000-READ-FORWARD",
          "children": [
            {
              "name": "UNTIL",
              "children": [],
              "text": ""
            },
            {
              "name": "9500-FILTER-RECORDS",
              "children": [],
              "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\nIF FLG-ACCTFILTER-ISVALID\nIF  CARD-ACCT-ID = CC-ACCT-ID\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD  TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nIF FLG-CARDFILTER-ISVALID\nIF  CARD-NUM = CC-CARD-NUM-N\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\n.\n"
            }
          ],
          "text": "MOVE LOW-VALUES           TO WS-ALL-ROWS\n\n*****************************************************************\n*    Start Browse\n*****************************************************************\nEXEC CICS STARTBR\nDATASET(LIT-CARD-FILE)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nGTEQ\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n*****************************************************************\n*    Loop through records and fetch max screen records\n*****************************************************************\nMOVE ZEROES TO WS-SCRN-COUNTER\nSET CA-NEXT-PAGE-EXISTS    TO TRUE\nSET MORE-RECORDS-TO-READ   TO TRUE\n\nPERFORM UNTIL READ-LOOP-EXIT\n\nEXEC CICS READNEXT\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nPERFORM 9500-FILTER-RECORDS\nTHRU 9500-FILTER-RECORDS-EXIT\n\nIF WS-DONOT-EXCLUDE-THIS-RECORD\nADD 1             TO WS-SCRN-COUNTER\n\nMOVE CARD-NUM     TO WS-ROW-CARD-NUM(\nWS-SCRN-COUNTER)\nMOVE CARD-ACCT-ID TO\nWS-ROW-ACCTNO(WS-SCRN-COUNTER)\nMOVE CARD-ACTIVE-STATUS\nTO WS-ROW-CARD-STATUS(\nWS-SCRN-COUNTER)\n\nIF WS-SCRN-COUNTER = 1\nMOVE CARD-ACCT-ID\nTO WS-CA-FIRST-CARD-ACCT-ID\nMOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM\nIF   WS-CA-SCREEN-NUM = 0\nADD   +1     TO WS-CA-SCREEN-NUM\nELSE\nCONTINUE\nEND-IF\nELSE\nCONTINUE\nEND-IF\nELSE\nCONTINUE\nEND-IF\n******************************************************************\n*            Max Screen size\n******************************************************************\nIF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES\nSET READ-LOOP-EXIT  TO TRUE\n\nMOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\nMOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\n\nEXEC CICS READNEXT\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nSET CA-NEXT-PAGE-EXISTS\nTO TRUE\nMOVE CARD-ACCT-ID TO\nWS-CA-LAST-CARD-ACCT-ID\nMOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM\nWHEN DFHRESP(ENDFILE)\nSET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\n\nIF WS-ERROR-MSG-OFF\nMOVE 'NO MORE RECORDS TO SHOW'\nTO WS-ERROR-MSG\nEND-IF\nWHEN OTHER\n*                     This is some kind of error. Change to END BR\n*                     And exit\nSET READ-LOOP-EXIT      TO TRUE\nMOVE 'READ'              TO ERROR-OPNAME\nMOVE LIT-CARD-FILE       TO ERROR-FILE\nMOVE WS-RESP-CD          TO ERROR-RESP\nMOVE WS-REAS-CD          TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG\nEND-EVALUATE\nEND-IF\nWHEN DFHRESP(ENDFILE)\nSET READ-LOOP-EXIT              TO TRUE\nSET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\nMOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\nMOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\nIF WS-ERROR-MSG-OFF\nMOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG\nEND-IF\nIF WS-CA-SCREEN-NUM = 1\nAND WS-SCRN-COUNTER = 0\n*               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG\nSET WS-NO-RECORDS-FOUND    TO TRUE\nEND-IF\nWHEN OTHER\n*           This is some kind of error. Change to END BR\n*           And exit\nSET READ-LOOP-EXIT             TO TRUE\nMOVE 'READ'                     TO ERROR-OPNAME\nMOVE LIT-CARD-FILE              TO ERROR-FILE\nMOVE WS-RESP-CD                 TO ERROR-RESP\nMOVE WS-REAS-CD                 TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\nEND-EVALUATE\nEND-PERFORM\n\nEXEC CICS ENDBR FILE(LIT-CARD-FILE)\nEND-EXEC\n."
        },
        {
          "name": "1000-SEND-MAP",
          "children": [
            {
              "name": "1100-SCREEN-INIT",
              "children": [],
              "text": "MOVE LOW-VALUES             TO CCRDLIAO\n\nMOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\nMOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO\nMOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO\nMOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO\nMOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO\n\nMOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\nMOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\nMOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\nMOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\nMOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO\n\nMOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\nMOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\nMOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\nMOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO\n*    PAGE NUMBER\n*\nMOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO\n\nSET WS-NO-INFO-MESSAGE      TO TRUE\nMOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO\nMOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO\n.\n"
            },
            {
              "name": "1200-SCREEN-ARRAY-INIT",
              "children": [],
              "text": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!\nIF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(2)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(3)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(4)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(5)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO\nEND-IF\n\n\nIF   WS-EACH-CARD(6)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(7)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO\nEND-IF\n.\n"
            },
            {
              "name": "1250-SETUP-ARRAY-ATTRIBS",
              "children": [],
              "text": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!\n\nIF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(1) = '1'\nMOVE DFHRED               TO CRDSEL1C OF CCRDLIAO\nIF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES\nMOVE '*'               TO CRDSEL1O OF CCRDLIAO\nEND-IF\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(2)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(2) = '1'\nMOVE DFHRED               TO CRDSEL2C OF CCRDLIAO\nMOVE -1                   TO CRDSEL2L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(3)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI\n\nELSE\nIF WS-ROW-CRDSELECT-ERROR(3) = '1'\nMOVE DFHRED               TO CRDSEL3C OF CCRDLIAO\nMOVE -1                   TO CRDSEL3L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(4)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI\nI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(4) = '1'\nMOVE DFHRED               TO CRDSEL4C OF CCRDLIAO\nMOVE -1                   TO CRDSEL4L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(5)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(5) = '1'\nMOVE DFHRED               TO CRDSEL5C OF CCRDLIAO\nMOVE -1                   TO CRDSEL5L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(6)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI\n\nELSE\nIF WS-ROW-CRDSELECT-ERROR(6) = '1'\nMOVE DFHRED               TO CRDSEL6C OF CCRDLIAO\nMOVE -1                   TO CRDSEL6L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(7)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(7) = '1'\nMOVE DFHRED               TO CRDSEL7C OF CCRDLIAO\nMOVE -1                   TO CRDSEL7L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI\nEND-IF\n.\n"
            },
            {
              "name": "1300-SETUP-SCREEN-ATTRS",
              "children": [],
              "text": "*    INITIALIZE SEARCH CRITERIA\nIF EIBCALEN = 0\nOR (CDEMO-PGM-ENTER\nAND CDEMO-FROM-PROGRAM = LIT-MENUPGM)\nCONTINUE\nELSE\nEVALUATE TRUE\nWHEN FLG-ACCTFILTER-ISVALID\nWHEN FLG-ACCTFILTER-NOT-OK\nMOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO\nMOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI\nWHEN CDEMO-ACCT-ID = 0\nMOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO\nWHEN OTHER\nMOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO\nMOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI\nEND-EVALUATE\n\nEVALUATE TRUE\nWHEN FLG-CARDFILTER-ISVALID\nWHEN FLG-CARDFILTER-NOT-OK\nMOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO\nMOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI\nWHEN CDEMO-CARD-NUM = 0\nMOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO\nWHEN OTHER\nMOVE CDEMO-CARD-NUM\nTO CARDSIDO OF CCRDLIAO\nMOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI\nEND-EVALUATE\nEND-IF\n\n*    POSITION CURSOR\n\nIF FLG-ACCTFILTER-NOT-OK\nMOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO\nMOVE  -1                 TO ACCTSIDL OF CCRDLIAI\nEND-IF\n\nIF FLG-CARDFILTER-NOT-OK\nMOVE  DFHRED             TO CARDSIDC OF CCRDLIAO\nMOVE  -1                 TO CARDSIDL OF CCRDLIAI\nEND-IF\n\n*    IF NO ERRORS POSITION CURSOR AT ACCTID\n\nIF INPUT-OK\nMOVE   -1                 TO ACCTSIDL OF CCRDLIAI\nEND-IF\n\n\n."
            },
            {
              "name": "1400-SETUP-MESSAGE",
              "children": [],
              "text": "*    SETUP MESSAGE\nEVALUATE TRUE\nWHEN FLG-ACCTFILTER-NOT-OK\nWHEN FLG-CARDFILTER-NOT-OK\nCONTINUE\nWHEN CCARD-AID-PFK07\nAND CA-FIRST-PAGE\nMOVE 'NO PREVIOUS PAGES TO DISPLAY'\nTO WS-ERROR-MSG\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-NOT-EXISTS\nAND CA-LAST-PAGE-SHOWN\nMOVE 'NO MORE PAGES TO DISPLAY'\nTO WS-ERROR-MSG\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-NOT-EXISTS\nSET WS-INFORM-REC-ACTIONS TO TRUE\nIF  CA-LAST-PAGE-NOT-SHOWN\nAND CA-NEXT-PAGE-NOT-EXISTS\nSET CA-LAST-PAGE-SHOWN TO TRUE\nEND-IF\nWHEN WS-NO-INFO-MESSAGE\nWHEN CA-NEXT-PAGE-EXISTS\nSET WS-INFORM-REC-ACTIONS TO TRUE\nWHEN OTHER\nSET WS-NO-INFO-MESSAGE TO TRUE\nEND-EVALUATE\n\nMOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO\n\nIF  NOT WS-NO-INFO-MESSAGE\nAND NOT WS-NO-RECORDS-FOUND\nMOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO\nMOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO\nEND-IF\n\n."
            },
            {
              "name": "1500-SEND-SCREEN",
              "children": [],
              "text": "EXEC CICS SEND MAP(LIT-THISMAP)\nMAPSET(LIT-THISMAPSET)\nFROM(CCRDLIAO)\nCURSOR\nERASE\nRESP(WS-RESP-CD)\nFREEKB\nEND-EXEC\n."
            }
          ],
          "text": "PERFORM 1100-SCREEN-INIT\nTHRU 1100-SCREEN-INIT-EXIT\nPERFORM 1200-SCREEN-ARRAY-INIT\nTHRU 1200-SCREEN-ARRAY-INIT-EXIT\nPERFORM 1250-SETUP-ARRAY-ATTRIBS\nTHRU 1250-SETUP-ARRAY-ATTRIBS-EXIT\nPERFORM 1300-SETUP-SCREEN-ATTRS\nTHRU 1300-SETUP-SCREEN-ATTRS-EXIT\nPERFORM 1400-SETUP-MESSAGE\nTHRU 1400-SETUP-MESSAGE-EXIT\nPERFORM 1500-SEND-SCREEN\nTHRU 1500-SEND-SCREEN-EXIT\n.\n"
        },
        {
          "name": "9100-READ-BACKWARDS",
          "children": [
            {
              "name": "UNTIL",
              "children": [],
              "text": ""
            },
            {
              "name": "9500-FILTER-RECORDS",
              "children": [],
              "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\nIF FLG-ACCTFILTER-ISVALID\nIF  CARD-ACCT-ID = CC-ACCT-ID\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD  TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nIF FLG-CARDFILTER-ISVALID\nIF  CARD-NUM = CC-CARD-NUM-N\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\n.\n"
            }
          ],
          "text": "\nMOVE LOW-VALUES           TO WS-ALL-ROWS\n\nMOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY\n\n*****************************************************************\n*    Start Browse\n*****************************************************************\nEXEC CICS STARTBR\nDATASET(LIT-CARD-FILE)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nGTEQ\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n*****************************************************************\n*    Loop through records and fetch max screen records\n*****************************************************************\nCOMPUTE WS-SCRN-COUNTER =\nWS-MAX-SCREEN-LINES + 1\nEND-COMPUTE\nSET CA-NEXT-PAGE-EXISTS    TO TRUE\nSET MORE-RECORDS-TO-READ   TO TRUE\n\n*****************************************************************\n*    Now we show the records from previous set.\n*****************************************************************\n\nEXEC CICS READPREV\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nSUBTRACT 1          FROM WS-SCRN-COUNTER\nWHEN OTHER\n*           This is some kind of error. Change to END BR\n*           And exit\nSET READ-LOOP-EXIT             TO TRUE\nMOVE 'READ'                     TO ERROR-OPNAME\nMOVE LIT-CARD-FILE              TO ERROR-FILE\nMOVE WS-RESP-CD                 TO ERROR-RESP\nMOVE WS-REAS-CD                 TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\nGO TO 9100-READ-BACKWARDS-EXIT\nEND-EVALUATE\n\nPERFORM UNTIL READ-LOOP-EXIT\n\nEXEC CICS READPREV\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nPERFORM 9500-FILTER-RECORDS\nTHRU 9500-FILTER-RECORDS-EXIT\nIF WS-DONOT-EXCLUDE-THIS-RECORD\nMOVE CARD-NUM\nTO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)\nMOVE CARD-ACCT-ID\nTO WS-ROW-ACCTNO(WS-SCRN-COUNTER)\nMOVE CARD-ACTIVE-STATUS\nTO\nWS-ROW-CARD-STATUS(WS-SCRN-COUNTER)\n\nSUBTRACT 1  FROM WS-SCRN-COUNTER\nIF WS-SCRN-COUNTER = 0\nSET READ-LOOP-EXIT  TO TRUE\n\nMOVE CARD-ACCT-ID\nTO WS-CA-FIRST-CARD-ACCT-ID\nMOVE CARD-NUM\nTO WS-CA-FIRST-CARD-NUM\nELSE\nCONTINUE\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nWHEN OTHER\n*           This is some kind of error. Change to END BR\n*           And exit\nSET READ-LOOP-EXIT             TO TRUE\nMOVE 'READ'                     TO ERROR-OPNAME\nMOVE LIT-CARD-FILE              TO ERROR-FILE\nMOVE WS-RESP-CD                 TO ERROR-RESP\nMOVE WS-REAS-CD                 TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\nEND-EVALUATE\nEND-PERFORM\n.\n"
        }
      ],
      "text": "\nINITIALIZE CC-WORK-AREA\nWS-MISC-STORAGE\nWS-COMMAREA\n\n*****************************************************************\n* Store our context\n*****************************************************************\nMOVE LIT-THISTRANID       TO WS-TRANID\n*****************************************************************\n* Ensure error message is cleared                               *\n*****************************************************************\nSET WS-ERROR-MSG-OFF  TO TRUE\n*****************************************************************\n* Retrived passed data if  any. Initialize them if first run.\n*****************************************************************\nIF EIBCALEN = 0\nINITIALIZE CARDDEMO-COMMAREA\nWS-THIS-PROGCOMMAREA\nMOVE LIT-THISTRANID        TO CDEMO-FROM-TRANID\nMOVE LIT-THISPGM           TO CDEMO-FROM-PROGRAM\nSET CDEMO-USRTYP-USER      TO TRUE\nSET CDEMO-PGM-ENTER        TO TRUE\nMOVE LIT-THISMAP           TO CDEMO-LAST-MAP\nMOVE LIT-THISMAPSET        TO CDEMO-LAST-MAPSET\nSET CA-FIRST-PAGE          TO TRUE\nSET CA-LAST-PAGE-NOT-SHOWN TO TRUE\nELSE\nMOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA) TO\nCARDDEMO-COMMAREA\nMOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\nLENGTH OF WS-THIS-PROGCOMMAREA )TO\nWS-THIS-PROGCOMMAREA\nEND-IF\n*****************************************************************\n* If coming in from menu. Lets forget the past and start afresh *\n*****************************************************************\nIF (CDEMO-PGM-ENTER\nAND CDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM)\nINITIALIZE WS-THIS-PROGCOMMAREA\nSET CDEMO-PGM-ENTER      TO TRUE\nMOVE LIT-THISMAP         TO CDEMO-LAST-MAP\nSET CA-FIRST-PAGE        TO TRUE\nSET CA-LAST-PAGE-NOT-SHOWN TO TRUE\nEND-IF\n\n******************************************************************\n* Remap PFkeys as needed.\n* Store the Mapped PF Key\n*****************************************************************\nPERFORM YYYY-STORE-PFKEY\nTHRU YYYY-STORE-PFKEY-EXIT\n\n******************************************************************\n* If something is present in commarea\n* and the from program is this program itself,\n* read and edit the inputs given\n*****************************************************************\nIF  EIBCALEN > 0\nAND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\nPERFORM 2000-RECEIVE-MAP\nTHRU    2000-RECEIVE-MAP-EXIT\n\nEND-IF\n*****************************************************************\n* Check the mapped key  to see if its valid at this point       *\n* F3    - Exit\n* Enter - List of cards for current start key\n* F8    - Page down\n* F7    - Page up\n*****************************************************************\nSET PFK-INVALID TO TRUE\nIF CCARD-AID-ENTER OR\nCCARD-AID-PFK03 OR\nCCARD-AID-PFK07 OR\nCCARD-AID-PFK08\nSET PFK-VALID TO TRUE\nEND-IF\n\nIF PFK-INVALID\nSET CCARD-AID-ENTER TO TRUE\nEND-IF\n*****************************************************************\n* If the user pressed PF3 go back to main menu\n*****************************************************************\nIF  (CCARD-AID-PFK03\nAND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM)\nMOVE LIT-THISTRANID   TO CDEMO-FROM-TRANID\nMOVE LIT-THISPGM      TO CDEMO-FROM-PROGRAM\nSET  CDEMO-USRTYP-USER TO TRUE\nSET  CDEMO-PGM-ENTER  TO TRUE\nMOVE LIT-THISMAPSET   TO CDEMO-LAST-MAPSET\nMOVE LIT-THISMAP      TO CDEMO-LAST-MAP\nMOVE LIT-MENUPGM      TO CDEMO-TO-PROGRAM\n\nMOVE LIT-MENUMAPSET   TO CCARD-NEXT-MAPSET\nMOVE LIT-THISMAP      TO CCARD-NEXT-MAP\nSET WS-EXIT-MESSAGE            TO TRUE\n\n*       CALL MENU PROGRAM\n*\nSET CDEMO-PGM-ENTER   TO TRUE\n*\nEXEC CICS XCTL\nPROGRAM (LIT-MENUPGM)\nCOMMAREA(CARDDEMO-COMMAREA)\nEND-EXEC\nEND-IF\n*****************************************************************\n* If the user did not press PF8, lets reset the last page flag\n*****************************************************************\nIF CCARD-AID-PFK08\nCONTINUE\nELSE\nSET CA-LAST-PAGE-NOT-SHOWN   TO TRUE\nEND-IF\n*****************************************************************\n* Now we decide what to do\n*****************************************************************\nEVALUATE TRUE\nWHEN INPUT-ERROR\n*****************************************************************\n*        ASK FOR CORRECTIONS TO INPUTS\n*****************************************************************\nMOVE WS-ERROR-MSG    TO CCARD-ERROR-MSG\nMOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM\nMOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\nMOVE LIT-THISMAP     TO CDEMO-LAST-MAP\n\nMOVE LIT-THISPGM     TO CCARD-NEXT-PROG\nMOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET\nMOVE LIT-THISMAP     TO CCARD-NEXT-MAP\nIF  NOT FLG-ACCTFILTER-NOT-OK\nAND NOT FLG-CARDFILTER-NOT-OK\nPERFORM 9000-READ-FORWARD\nTHRU 9000-READ-FORWARD-EXIT\nEND-IF\nPERFORM 1000-SEND-MAP\nTHRU 1000-SEND-MAP\nGO TO COMMON-RETURN\nWHEN CCARD-AID-PFK07\nAND CA-FIRST-PAGE\n*****************************************************************\n*        PAGE UP - PF7 - BUT ALREADY ON FIRST PAGE\n*****************************************************************\nWHEN CCARD-AID-PFK07\nAND CA-FIRST-PAGE\nMOVE WS-CA-FIRST-CARD-NUM\nTO WS-CARD-RID-CARDNUM\n*             MOVE WS-CA-FIRST-CARD-ACCT-ID\n*                           TO WS-CARD-RID-ACCT-ID\nPERFORM 9000-READ-FORWARD\nTHRU 9000-READ-FORWARD-EXIT\nPERFORM 1000-SEND-MAP\nTHRU 1000-SEND-MAP\nGO TO COMMON-RETURN\n*****************************************************************\n*        BACK - PF3 IF WE CAME FROM SOME OTHER PROGRAM\n*****************************************************************\nWHEN CCARD-AID-PFK03\nWHEN CDEMO-PGM-REENTER AND\nCDEMO-FROM-PROGRAM NOT EQUAL LIT-THISPGM\n\nINITIALIZE CARDDEMO-COMMAREA\nWS-THIS-PROGCOMMAREA\nMOVE LIT-THISTRANID      TO CDEMO-FROM-TRANID\nMOVE LIT-THISPGM         TO CDEMO-FROM-PROGRAM\nSET CDEMO-USRTYP-USER    TO TRUE\nSET CDEMO-PGM-ENTER      TO TRUE\nMOVE LIT-THISMAP         TO CDEMO-LAST-MAP\nMOVE LIT-THISMAPSET      TO CDEMO-LAST-MAPSET\nSET CA-FIRST-PAGE        TO TRUE\nSET CA-LAST-PAGE-NOT-SHOWN TO TRUE\n\nMOVE WS-CA-FIRST-CARD-NUM\nTO WS-CARD-RID-CARDNUM\n*             MOVE WS-CA-FIRST-CARD-ACCT-ID\n*                           TO WS-CARD-RID-ACCT-ID\n\nPERFORM 9000-READ-FORWARD\nTHRU 9000-READ-FORWARD-EXIT\nPERFORM 1000-SEND-MAP\nTHRU 1000-SEND-MAP\nGO TO COMMON-RETURN\n*****************************************************************\n*        PAGE DOWN\n*****************************************************************\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-EXISTS\nMOVE WS-CA-LAST-CARD-NUM\nTO WS-CARD-RID-CARDNUM\n*             MOVE WS-CA-LAST-CARD-ACCT-ID\n*                           TO WS-CARD-RID-ACCT-ID\nADD   +1       TO WS-CA-SCREEN-NUM\nPERFORM 9000-READ-FORWARD\nTHRU 9000-READ-FORWARD-EXIT\nPERFORM 1000-SEND-MAP\nTHRU 1000-SEND-MAP-EXIT\nGO TO COMMON-RETURN\n*****************************************************************\n*        PAGE UP\n*****************************************************************\nWHEN CCARD-AID-PFK07\nAND NOT CA-FIRST-PAGE\n\nMOVE WS-CA-FIRST-CARD-NUM\nTO WS-CARD-RID-CARDNUM\n*             MOVE WS-CA-FIRST-CARD-ACCT-ID\n*                           TO WS-CARD-RID-ACCT-ID\nSUBTRACT 1    FROM WS-CA-SCREEN-NUM\nPERFORM 9100-READ-BACKWARDS\nTHRU 9100-READ-BACKWARDS-EXIT\nPERFORM 1000-SEND-MAP\nTHRU 1000-SEND-MAP-EXIT\nGO TO COMMON-RETURN\n*****************************************************************\n*        TRANSFER TO CARD DETAIL VIEW\n*****************************************************************\nWHEN CCARD-AID-ENTER\nAND VIEW-REQUESTED-ON(I-SELECTED)\nAND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\nMOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID\nMOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM\nSET  CDEMO-USRTYP-USER TO TRUE\nSET  CDEMO-PGM-ENTER   TO TRUE\nMOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET\nMOVE LIT-THISMAP       TO CDEMO-LAST-MAP\nMOVE LIT-CARDDTLPGM    TO CCARD-NEXT-PROG\n\nMOVE LIT-CARDDTLMAPSET TO CCARD-NEXT-MAPSET\nMOVE LIT-CARDDTLMAP    TO CCARD-NEXT-MAP\n\nMOVE WS-ROW-ACCTNO (I-SELECTED)\nTO CDEMO-ACCT-ID\nMOVE WS-ROW-CARD-NUM (I-SELECTED)\nTO CDEMO-CARD-NUM\n\n*            CALL CARD DETAIL PROGRAM\n*\nEXEC CICS XCTL\nPROGRAM (CCARD-NEXT-PROG)\nCOMMAREA(CARDDEMO-COMMAREA)\nEND-EXEC\n*****************************************************************\n*        TRANSFER TO CARD UPDATED PROGRAM\n*****************************************************************\nWHEN CCARD-AID-ENTER\nAND UPDATE-REQUESTED-ON(I-SELECTED)\nAND CDEMO-FROM-PROGRAM  EQUAL LIT-THISPGM\nMOVE LIT-THISTRANID    TO CDEMO-FROM-TRANID\nMOVE LIT-THISPGM       TO CDEMO-FROM-PROGRAM\nSET  CDEMO-USRTYP-USER TO TRUE\nSET  CDEMO-PGM-ENTER   TO TRUE\nMOVE LIT-THISMAPSET    TO CDEMO-LAST-MAPSET\nMOVE LIT-THISMAP       TO CDEMO-LAST-MAP\nMOVE LIT-CARDUPDPGM    TO CCARD-NEXT-PROG\n\nMOVE LIT-CARDUPDMAPSET TO CCARD-NEXT-MAPSET\nMOVE LIT-CARDUPDMAP    TO CCARD-NEXT-MAP\n\nMOVE WS-ROW-ACCTNO (I-SELECTED)\nTO CDEMO-ACCT-ID\nMOVE WS-ROW-CARD-NUM (I-SELECTED)\nTO CDEMO-CARD-NUM\n\n*            CALL CARD UPDATE PROGRAM\n*\nEXEC CICS XCTL\nPROGRAM (CCARD-NEXT-PROG)\nCOMMAREA(CARDDEMO-COMMAREA)\nEND-EXEC\n\n*****************************************************************\nWHEN OTHER\n*****************************************************************\nMOVE WS-CA-FIRST-CARD-NUM\nTO WS-CARD-RID-CARDNUM\n*             MOVE WS-CA-FIRST-CARD-ACCT-ID\n*                           TO WS-CARD-RID-ACCT-ID\nPERFORM 9000-READ-FORWARD\nTHRU 9000-READ-FORWARD-EXIT\nPERFORM 1000-SEND-MAP\nTHRU 1000-SEND-MAP\nGO TO COMMON-RETURN\nEND-EVALUATE\n\n* If we had an error setup error message to display and return\nIF INPUT-ERROR\nMOVE WS-ERROR-MSG   TO CCARD-ERROR-MSG\nMOVE LIT-THISPGM     TO CDEMO-FROM-PROGRAM\nMOVE LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\nMOVE LIT-THISMAP     TO CDEMO-LAST-MAP\n\nMOVE LIT-THISPGM     TO CCARD-NEXT-PROG\nMOVE LIT-THISMAPSET  TO CCARD-NEXT-MAPSET\nMOVE LIT-THISMAP     TO CCARD-NEXT-MAP\n*       PERFORM 1000-SEND-MAP\n*          THRU 1000-SEND-MAP\nGO TO COMMON-RETURN\nEND-IF\n\nMOVE LIT-THISPGM        TO CCARD-NEXT-PROG\nGO TO COMMON-RETURN\n.\n"
    },
    {
      "name": "YYYY-STORE-PFKEY",
      "children": [],
      "text": ""
    },
    {
      "name": "2000-RECEIVE-MAP",
      "children": [
        {
          "name": "2100-RECEIVE-SCREEN",
          "children": [],
          "text": "EXEC CICS RECEIVE MAP(LIT-THISMAP)\nMAPSET(LIT-THISMAPSET)\nINTO(CCRDLIAI)\nRESP(WS-RESP-CD)\nEND-EXEC\n\nMOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID\nMOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM\n\nMOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)\nMOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)\nMOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)\nMOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)\nMOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)\nMOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)\nMOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)\n.\n"
        },
        {
          "name": "2200-EDIT-INPUTS",
          "children": [
            {
              "name": "2210-EDIT-ACCOUNT",
              "children": [],
              "text": "SET FLG-ACCTFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-ACCT-ID   EQUAL LOW-VALUES\nOR CC-ACCT-ID   EQUAL SPACES\nOR CC-ACCT-ID-N EQUAL ZEROS\nSET FLG-ACCTFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-ACCT-ID\nGO TO  2210-EDIT-ACCOUNT-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 11 characters\nIF CC-ACCT-ID  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-ACCTFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nMOVE\n'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'\nTO WS-ERROR-MSG\nMOVE ZERO       TO CDEMO-ACCT-ID\nGO TO 2210-EDIT-ACCOUNT-EXIT\nELSE\nMOVE CC-ACCT-ID TO CDEMO-ACCT-ID\nSET FLG-ACCTFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
            },
            {
              "name": "2220-EDIT-CARD",
              "children": [],
              "text": "*    Not numeric\n*    Not 16 characters\nSET FLG-CARDFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-CARD-NUM   EQUAL LOW-VALUES\nOR CC-CARD-NUM   EQUAL SPACES\nOR CC-CARD-NUM-N EQUAL ZEROS\nSET FLG-CARDFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-CARD-NUM\nGO TO  2220-EDIT-CARD-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 16 characters\nIF CC-CARD-NUM  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-CARDFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nIF WS-ERROR-MSG-OFF\nMOVE\n'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'\nTO WS-ERROR-MSG\nEND-IF\nMOVE ZERO       TO CDEMO-CARD-NUM\nGO TO 2220-EDIT-CARD-EXIT\nELSE\nMOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM\nSET FLG-CARDFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
            },
            {
              "name": "2250-EDIT-ARRAY",
              "children": [
                {
                  "name": "VARYING",
                  "children": [],
                  "text": ""
                }
              ],
              "text": "\nIF INPUT-ERROR\nGO TO 2250-EDIT-ARRAY-EXIT\nEND-IF\n\nINSPECT  WS-EDIT-SELECT-FLAGS\nTALLYING I\nFOR ALL 'S'\nALL 'U'\n\nIF I > +1\nSET INPUT-ERROR      TO TRUE\nSET WS-MORE-THAN-1-ACTION TO TRUE\n\nMOVE WS-EDIT-SELECT-FLAGS\nTO WS-EDIT-SELECT-ERROR-FLAGS\nINSPECT WS-EDIT-SELECT-ERROR-FLAGS\nREPLACING ALL 'S' BY '1'\nALL 'U' BY '1'\nCHARACTERS        BY '0'\n\nEND-IF\n\nMOVE ZERO TO I-SELECTED\n\nPERFORM VARYING I FROM 1 BY 1 UNTIL I > 7\nEVALUATE TRUE\nWHEN SELECT-OK(I)\nMOVE I TO I-SELECTED\nIF WS-MORE-THAN-1-ACTION\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nEND-IF\nWHEN SELECT-BLANK(I)\nCONTINUE\nWHEN OTHER\nSET INPUT-ERROR TO TRUE\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nIF WS-ERROR-MSG-OFF\nSET WS-INVALID-ACTION-CODE TO TRUE\nEND-IF\nEND-EVALUATE\nEND-PERFORM\n\n.\n"
            }
          ],
          "text": "SET INPUT-OK                   TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-NO TO TRUE\n\nPERFORM 2210-EDIT-ACCOUNT\nTHRU 2210-EDIT-ACCOUNT-EXIT\n\nPERFORM 2220-EDIT-CARD\nTHRU 2220-EDIT-CARD-EXIT\n\nPERFORM 2250-EDIT-ARRAY\nTHRU 2250-EDIT-ARRAY-EXIT\n.\n"
        }
      ],
      "text": "PERFORM 2100-RECEIVE-SCREEN\nTHRU 2100-RECEIVE-SCREEN-EXIT\n\nPERFORM 2200-EDIT-INPUTS\nTHRU   2200-EDIT-INPUTS-EXIT\n.\n"
    },
    {
      "name": "9000-READ-FORWARD",
      "children": [
        {
          "name": "UNTIL",
          "children": [],
          "text": ""
        },
        {
          "name": "9500-FILTER-RECORDS",
          "children": [],
          "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\nIF FLG-ACCTFILTER-ISVALID\nIF  CARD-ACCT-ID = CC-ACCT-ID\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD  TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nIF FLG-CARDFILTER-ISVALID\nIF  CARD-NUM = CC-CARD-NUM-N\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\n.\n"
        }
      ],
      "text": "MOVE LOW-VALUES           TO WS-ALL-ROWS\n\n*****************************************************************\n*    Start Browse\n*****************************************************************\nEXEC CICS STARTBR\nDATASET(LIT-CARD-FILE)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nGTEQ\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n*****************************************************************\n*    Loop through records and fetch max screen records\n*****************************************************************\nMOVE ZEROES TO WS-SCRN-COUNTER\nSET CA-NEXT-PAGE-EXISTS    TO TRUE\nSET MORE-RECORDS-TO-READ   TO TRUE\n\nPERFORM UNTIL READ-LOOP-EXIT\n\nEXEC CICS READNEXT\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nPERFORM 9500-FILTER-RECORDS\nTHRU 9500-FILTER-RECORDS-EXIT\n\nIF WS-DONOT-EXCLUDE-THIS-RECORD\nADD 1             TO WS-SCRN-COUNTER\n\nMOVE CARD-NUM     TO WS-ROW-CARD-NUM(\nWS-SCRN-COUNTER)\nMOVE CARD-ACCT-ID TO\nWS-ROW-ACCTNO(WS-SCRN-COUNTER)\nMOVE CARD-ACTIVE-STATUS\nTO WS-ROW-CARD-STATUS(\nWS-SCRN-COUNTER)\n\nIF WS-SCRN-COUNTER = 1\nMOVE CARD-ACCT-ID\nTO WS-CA-FIRST-CARD-ACCT-ID\nMOVE CARD-NUM  TO WS-CA-FIRST-CARD-NUM\nIF   WS-CA-SCREEN-NUM = 0\nADD   +1     TO WS-CA-SCREEN-NUM\nELSE\nCONTINUE\nEND-IF\nELSE\nCONTINUE\nEND-IF\nELSE\nCONTINUE\nEND-IF\n******************************************************************\n*            Max Screen size\n******************************************************************\nIF WS-SCRN-COUNTER = WS-MAX-SCREEN-LINES\nSET READ-LOOP-EXIT  TO TRUE\n\nMOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\nMOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\n\nEXEC CICS READNEXT\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nSET CA-NEXT-PAGE-EXISTS\nTO TRUE\nMOVE CARD-ACCT-ID TO\nWS-CA-LAST-CARD-ACCT-ID\nMOVE CARD-NUM     TO WS-CA-LAST-CARD-NUM\nWHEN DFHRESP(ENDFILE)\nSET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\n\nIF WS-ERROR-MSG-OFF\nMOVE 'NO MORE RECORDS TO SHOW'\nTO WS-ERROR-MSG\nEND-IF\nWHEN OTHER\n*                     This is some kind of error. Change to END BR\n*                     And exit\nSET READ-LOOP-EXIT      TO TRUE\nMOVE 'READ'              TO ERROR-OPNAME\nMOVE LIT-CARD-FILE       TO ERROR-FILE\nMOVE WS-RESP-CD          TO ERROR-RESP\nMOVE WS-REAS-CD          TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE TO WS-ERROR-MSG\nEND-EVALUATE\nEND-IF\nWHEN DFHRESP(ENDFILE)\nSET READ-LOOP-EXIT              TO TRUE\nSET CA-NEXT-PAGE-NOT-EXISTS     TO TRUE\nMOVE CARD-ACCT-ID     TO WS-CA-LAST-CARD-ACCT-ID\nMOVE CARD-NUM         TO WS-CA-LAST-CARD-NUM\nIF WS-ERROR-MSG-OFF\nMOVE 'NO MORE RECORDS TO SHOW'  TO WS-ERROR-MSG\nEND-IF\nIF WS-CA-SCREEN-NUM = 1\nAND WS-SCRN-COUNTER = 0\n*               MOVE 'NO RECORDS TO SHOW'  TO WS-ERROR-MSG\nSET WS-NO-RECORDS-FOUND    TO TRUE\nEND-IF\nWHEN OTHER\n*           This is some kind of error. Change to END BR\n*           And exit\nSET READ-LOOP-EXIT             TO TRUE\nMOVE 'READ'                     TO ERROR-OPNAME\nMOVE LIT-CARD-FILE              TO ERROR-FILE\nMOVE WS-RESP-CD                 TO ERROR-RESP\nMOVE WS-REAS-CD                 TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\nEND-EVALUATE\nEND-PERFORM\n\nEXEC CICS ENDBR FILE(LIT-CARD-FILE)\nEND-EXEC\n."
    },
    {
      "name": "1000-SEND-MAP",
      "children": [
        {
          "name": "1100-SCREEN-INIT",
          "children": [],
          "text": "MOVE LOW-VALUES             TO CCRDLIAO\n\nMOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\nMOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO\nMOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO\nMOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO\nMOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO\n\nMOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\nMOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\nMOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\nMOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\nMOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO\n\nMOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\nMOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\nMOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\nMOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO\n*    PAGE NUMBER\n*\nMOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO\n\nSET WS-NO-INFO-MESSAGE      TO TRUE\nMOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO\nMOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO\n.\n"
        },
        {
          "name": "1200-SCREEN-ARRAY-INIT",
          "children": [],
          "text": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!\nIF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(2)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(3)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(4)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(5)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO\nEND-IF\n\n\nIF   WS-EACH-CARD(6)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(7)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO\nEND-IF\n.\n"
        },
        {
          "name": "1250-SETUP-ARRAY-ATTRIBS",
          "children": [],
          "text": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!\n\nIF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(1) = '1'\nMOVE DFHRED               TO CRDSEL1C OF CCRDLIAO\nIF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES\nMOVE '*'               TO CRDSEL1O OF CCRDLIAO\nEND-IF\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(2)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(2) = '1'\nMOVE DFHRED               TO CRDSEL2C OF CCRDLIAO\nMOVE -1                   TO CRDSEL2L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(3)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI\n\nELSE\nIF WS-ROW-CRDSELECT-ERROR(3) = '1'\nMOVE DFHRED               TO CRDSEL3C OF CCRDLIAO\nMOVE -1                   TO CRDSEL3L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(4)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI\nI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(4) = '1'\nMOVE DFHRED               TO CRDSEL4C OF CCRDLIAO\nMOVE -1                   TO CRDSEL4L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(5)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(5) = '1'\nMOVE DFHRED               TO CRDSEL5C OF CCRDLIAO\nMOVE -1                   TO CRDSEL5L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(6)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI\n\nELSE\nIF WS-ROW-CRDSELECT-ERROR(6) = '1'\nMOVE DFHRED               TO CRDSEL6C OF CCRDLIAO\nMOVE -1                   TO CRDSEL6L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(7)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(7) = '1'\nMOVE DFHRED               TO CRDSEL7C OF CCRDLIAO\nMOVE -1                   TO CRDSEL7L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI\nEND-IF\n.\n"
        },
        {
          "name": "1300-SETUP-SCREEN-ATTRS",
          "children": [],
          "text": "*    INITIALIZE SEARCH CRITERIA\nIF EIBCALEN = 0\nOR (CDEMO-PGM-ENTER\nAND CDEMO-FROM-PROGRAM = LIT-MENUPGM)\nCONTINUE\nELSE\nEVALUATE TRUE\nWHEN FLG-ACCTFILTER-ISVALID\nWHEN FLG-ACCTFILTER-NOT-OK\nMOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO\nMOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI\nWHEN CDEMO-ACCT-ID = 0\nMOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO\nWHEN OTHER\nMOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO\nMOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI\nEND-EVALUATE\n\nEVALUATE TRUE\nWHEN FLG-CARDFILTER-ISVALID\nWHEN FLG-CARDFILTER-NOT-OK\nMOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO\nMOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI\nWHEN CDEMO-CARD-NUM = 0\nMOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO\nWHEN OTHER\nMOVE CDEMO-CARD-NUM\nTO CARDSIDO OF CCRDLIAO\nMOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI\nEND-EVALUATE\nEND-IF\n\n*    POSITION CURSOR\n\nIF FLG-ACCTFILTER-NOT-OK\nMOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO\nMOVE  -1                 TO ACCTSIDL OF CCRDLIAI\nEND-IF\n\nIF FLG-CARDFILTER-NOT-OK\nMOVE  DFHRED             TO CARDSIDC OF CCRDLIAO\nMOVE  -1                 TO CARDSIDL OF CCRDLIAI\nEND-IF\n\n*    IF NO ERRORS POSITION CURSOR AT ACCTID\n\nIF INPUT-OK\nMOVE   -1                 TO ACCTSIDL OF CCRDLIAI\nEND-IF\n\n\n."
        },
        {
          "name": "1400-SETUP-MESSAGE",
          "children": [],
          "text": "*    SETUP MESSAGE\nEVALUATE TRUE\nWHEN FLG-ACCTFILTER-NOT-OK\nWHEN FLG-CARDFILTER-NOT-OK\nCONTINUE\nWHEN CCARD-AID-PFK07\nAND CA-FIRST-PAGE\nMOVE 'NO PREVIOUS PAGES TO DISPLAY'\nTO WS-ERROR-MSG\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-NOT-EXISTS\nAND CA-LAST-PAGE-SHOWN\nMOVE 'NO MORE PAGES TO DISPLAY'\nTO WS-ERROR-MSG\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-NOT-EXISTS\nSET WS-INFORM-REC-ACTIONS TO TRUE\nIF  CA-LAST-PAGE-NOT-SHOWN\nAND CA-NEXT-PAGE-NOT-EXISTS\nSET CA-LAST-PAGE-SHOWN TO TRUE\nEND-IF\nWHEN WS-NO-INFO-MESSAGE\nWHEN CA-NEXT-PAGE-EXISTS\nSET WS-INFORM-REC-ACTIONS TO TRUE\nWHEN OTHER\nSET WS-NO-INFO-MESSAGE TO TRUE\nEND-EVALUATE\n\nMOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO\n\nIF  NOT WS-NO-INFO-MESSAGE\nAND NOT WS-NO-RECORDS-FOUND\nMOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO\nMOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO\nEND-IF\n\n."
        },
        {
          "name": "1500-SEND-SCREEN",
          "children": [],
          "text": "EXEC CICS SEND MAP(LIT-THISMAP)\nMAPSET(LIT-THISMAPSET)\nFROM(CCRDLIAO)\nCURSOR\nERASE\nRESP(WS-RESP-CD)\nFREEKB\nEND-EXEC\n."
        }
      ],
      "text": "PERFORM 1100-SCREEN-INIT\nTHRU 1100-SCREEN-INIT-EXIT\nPERFORM 1200-SCREEN-ARRAY-INIT\nTHRU 1200-SCREEN-ARRAY-INIT-EXIT\nPERFORM 1250-SETUP-ARRAY-ATTRIBS\nTHRU 1250-SETUP-ARRAY-ATTRIBS-EXIT\nPERFORM 1300-SETUP-SCREEN-ATTRS\nTHRU 1300-SETUP-SCREEN-ATTRS-EXIT\nPERFORM 1400-SETUP-MESSAGE\nTHRU 1400-SETUP-MESSAGE-EXIT\nPERFORM 1500-SEND-SCREEN\nTHRU 1500-SEND-SCREEN-EXIT\n.\n"
    },
    {
      "name": "9100-READ-BACKWARDS",
      "children": [
        {
          "name": "UNTIL",
          "children": [],
          "text": ""
        },
        {
          "name": "9500-FILTER-RECORDS",
          "children": [],
          "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\nIF FLG-ACCTFILTER-ISVALID\nIF  CARD-ACCT-ID = CC-ACCT-ID\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD  TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nIF FLG-CARDFILTER-ISVALID\nIF  CARD-NUM = CC-CARD-NUM-N\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\n.\n"
        }
      ],
      "text": "\nMOVE LOW-VALUES           TO WS-ALL-ROWS\n\nMOVE WS-CA-FIRST-CARDKEY  TO WS-CA-LAST-CARDKEY\n\n*****************************************************************\n*    Start Browse\n*****************************************************************\nEXEC CICS STARTBR\nDATASET(LIT-CARD-FILE)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nGTEQ\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n*****************************************************************\n*    Loop through records and fetch max screen records\n*****************************************************************\nCOMPUTE WS-SCRN-COUNTER =\nWS-MAX-SCREEN-LINES + 1\nEND-COMPUTE\nSET CA-NEXT-PAGE-EXISTS    TO TRUE\nSET MORE-RECORDS-TO-READ   TO TRUE\n\n*****************************************************************\n*    Now we show the records from previous set.\n*****************************************************************\n\nEXEC CICS READPREV\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nSUBTRACT 1          FROM WS-SCRN-COUNTER\nWHEN OTHER\n*           This is some kind of error. Change to END BR\n*           And exit\nSET READ-LOOP-EXIT             TO TRUE\nMOVE 'READ'                     TO ERROR-OPNAME\nMOVE LIT-CARD-FILE              TO ERROR-FILE\nMOVE WS-RESP-CD                 TO ERROR-RESP\nMOVE WS-REAS-CD                 TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\nGO TO 9100-READ-BACKWARDS-EXIT\nEND-EVALUATE\n\nPERFORM UNTIL READ-LOOP-EXIT\n\nEXEC CICS READPREV\nDATASET(LIT-CARD-FILE)\nINTO (CARD-RECORD)\nLENGTH(LENGTH OF CARD-RECORD)\nRIDFLD(WS-CARD-RID-CARDNUM)\nKEYLENGTH(LENGTH OF WS-CARD-RID-CARDNUM)\nRESP(WS-RESP-CD)\nRESP2(WS-REAS-CD)\nEND-EXEC\n\nEVALUATE WS-RESP-CD\nWHEN DFHRESP(NORMAL)\nWHEN DFHRESP(DUPREC)\nPERFORM 9500-FILTER-RECORDS\nTHRU 9500-FILTER-RECORDS-EXIT\nIF WS-DONOT-EXCLUDE-THIS-RECORD\nMOVE CARD-NUM\nTO WS-ROW-CARD-NUM(WS-SCRN-COUNTER)\nMOVE CARD-ACCT-ID\nTO WS-ROW-ACCTNO(WS-SCRN-COUNTER)\nMOVE CARD-ACTIVE-STATUS\nTO\nWS-ROW-CARD-STATUS(WS-SCRN-COUNTER)\n\nSUBTRACT 1  FROM WS-SCRN-COUNTER\nIF WS-SCRN-COUNTER = 0\nSET READ-LOOP-EXIT  TO TRUE\n\nMOVE CARD-ACCT-ID\nTO WS-CA-FIRST-CARD-ACCT-ID\nMOVE CARD-NUM\nTO WS-CA-FIRST-CARD-NUM\nELSE\nCONTINUE\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nWHEN OTHER\n*           This is some kind of error. Change to END BR\n*           And exit\nSET READ-LOOP-EXIT             TO TRUE\nMOVE 'READ'                     TO ERROR-OPNAME\nMOVE LIT-CARD-FILE              TO ERROR-FILE\nMOVE WS-RESP-CD                 TO ERROR-RESP\nMOVE WS-REAS-CD                 TO ERROR-RESP2\nMOVE WS-FILE-ERROR-MESSAGE      TO WS-ERROR-MSG\nEND-EVALUATE\nEND-PERFORM\n.\n"
    },
    {
      "name": "COMMON-RETURN",
      "children": [],
      "text": "MOVE  LIT-THISTRANID TO CDEMO-FROM-TRANID\nMOVE  LIT-THISPGM     TO CDEMO-FROM-PROGRAM\nMOVE  LIT-THISMAPSET  TO CDEMO-LAST-MAPSET\nMOVE  LIT-THISMAP     TO CDEMO-LAST-MAP\nMOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\nMOVE  WS-THIS-PROGCOMMAREA TO\nWS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\nLENGTH OF WS-THIS-PROGCOMMAREA )\n\n\nEXEC CICS RETURN\nTRANSID (LIT-THISTRANID)\nCOMMAREA (WS-COMMAREA)\nLENGTH(LENGTH OF WS-COMMAREA)\nEND-EXEC\n."
    },
    {
      "name": "0000-MAIN-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "1100-SCREEN-INIT",
      "children": [],
      "text": "MOVE LOW-VALUES             TO CCRDLIAO\n\nMOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\nMOVE CCDA-TITLE01           TO TITLE01O OF CCRDLIAO\nMOVE CCDA-TITLE02           TO TITLE02O OF CCRDLIAO\nMOVE LIT-THISTRANID         TO TRNNAMEO OF CCRDLIAO\nMOVE LIT-THISPGM            TO PGMNAMEO OF CCRDLIAO\n\nMOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n\nMOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\nMOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\nMOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n\nMOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CCRDLIAO\n\nMOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\nMOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\nMOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n\nMOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CCRDLIAO\n*    PAGE NUMBER\n*\nMOVE WS-CA-SCREEN-NUM       TO PAGENOO  OF CCRDLIAO\n\nSET WS-NO-INFO-MESSAGE      TO TRUE\nMOVE WS-INFO-MSG            TO INFOMSGO OF CCRDLIAO\nMOVE DFHBMDAR               TO INFOMSGC OF CCRDLIAO\n.\n"
    },
    {
      "name": "1200-SCREEN-ARRAY-INIT",
      "children": [],
      "text": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!\nIF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(1)       TO CRDSEL1O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(1)        TO ACCTNO1O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(1)      TO CRDNUM1O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(1)   TO CRDSTS1O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(2)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(2)       TO CRDSEL2O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(2)        TO ACCTNO2O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(2)      TO CRDNUM2O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(2)   TO CRDSTS2O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(3)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(3)       TO CRDSEL3O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(3)        TO ACCTNO3O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(3)      TO CRDNUM3O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(3)   TO CRDSTS3O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(4)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(4)       TO CRDSEL4O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(4)        TO ACCTNO4O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(4)      TO CRDNUM4O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(4)   TO CRDSTS4O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(5)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(5)       TO CRDSEL5O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(5)        TO ACCTNO5O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(5)      TO CRDNUM5O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(5)   TO CRDSTS5O OF CCRDLIAO\nEND-IF\n\n\nIF   WS-EACH-CARD(6)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(6)       TO CRDSEL6O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(6)        TO ACCTNO6O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(6)      TO CRDNUM6O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(6)   TO CRDSTS6O OF CCRDLIAO\nEND-IF\n\nIF   WS-EACH-CARD(7)        EQUAL LOW-VALUES\nCONTINUE\nELSE\nMOVE WS-EDIT-SELECT(7)       TO CRDSEL7O OF CCRDLIAO\nMOVE WS-ROW-ACCTNO(7)        TO ACCTNO7O OF CCRDLIAO\nMOVE WS-ROW-CARD-NUM(7)      TO CRDNUM7O OF CCRDLIAO\nMOVE WS-ROW-CARD-STATUS(7)   TO CRDSTS7O OF CCRDLIAO\nEND-IF\n.\n"
    },
    {
      "name": "1250-SETUP-ARRAY-ATTRIBS",
      "children": [],
      "text": "*    USE REDEFINES AND CLEAN UP REPETITIVE CODE !!\n\nIF   WS-EACH-CARD(1)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRF                TO CRDSEL1A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(1) = '1'\nMOVE DFHRED               TO CRDSEL1C OF CCRDLIAO\nIF WS-EDIT-SELECT(1) = SPACE OR LOW-VALUES\nMOVE '*'               TO CRDSEL1O OF CCRDLIAO\nEND-IF\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL1A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(2)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL2A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(2) = '1'\nMOVE DFHRED               TO CRDSEL2C OF CCRDLIAO\nMOVE -1                   TO CRDSEL2L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL2A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(3)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL3A OF CCRDLIAI\n\nELSE\nIF WS-ROW-CRDSELECT-ERROR(3) = '1'\nMOVE DFHRED               TO CRDSEL3C OF CCRDLIAO\nMOVE -1                   TO CRDSEL3L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL3A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(4)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL4A OF CCRDLIAI\nI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(4) = '1'\nMOVE DFHRED               TO CRDSEL4C OF CCRDLIAO\nMOVE -1                   TO CRDSEL4L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL4A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(5)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL5A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(5) = '1'\nMOVE DFHRED               TO CRDSEL5C OF CCRDLIAO\nMOVE -1                   TO CRDSEL5L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL5A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(6)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL6A OF CCRDLIAI\n\nELSE\nIF WS-ROW-CRDSELECT-ERROR(6) = '1'\nMOVE DFHRED               TO CRDSEL6C OF CCRDLIAO\nMOVE -1                   TO CRDSEL6L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL6A OF CCRDLIAI\nEND-IF\n\nIF   WS-EACH-CARD(7)            EQUAL LOW-VALUES\nOR   FLG-PROTECT-SELECT-ROWS-YES\nMOVE DFHBMPRO                TO CRDSEL7A OF CCRDLIAI\nELSE\nIF WS-ROW-CRDSELECT-ERROR(7) = '1'\nMOVE DFHRED               TO CRDSEL7C OF CCRDLIAO\nMOVE -1                   TO CRDSEL7L OF CCRDLIAI\nEND-IF\nMOVE DFHBMFSE                TO CRDSEL7A OF CCRDLIAI\nEND-IF\n.\n"
    },
    {
      "name": "1300-SETUP-SCREEN-ATTRS",
      "children": [],
      "text": "*    INITIALIZE SEARCH CRITERIA\nIF EIBCALEN = 0\nOR (CDEMO-PGM-ENTER\nAND CDEMO-FROM-PROGRAM = LIT-MENUPGM)\nCONTINUE\nELSE\nEVALUATE TRUE\nWHEN FLG-ACCTFILTER-ISVALID\nWHEN FLG-ACCTFILTER-NOT-OK\nMOVE CC-ACCT-ID   TO ACCTSIDO OF CCRDLIAO\nMOVE DFHBMFSE     TO ACCTSIDA OF CCRDLIAI\nWHEN CDEMO-ACCT-ID = 0\nMOVE LOW-VALUES   TO ACCTSIDO OF CCRDLIAO\nWHEN OTHER\nMOVE CDEMO-ACCT-ID TO ACCTSIDO OF CCRDLIAO\nMOVE DFHBMFSE      TO ACCTSIDA OF CCRDLIAI\nEND-EVALUATE\n\nEVALUATE TRUE\nWHEN FLG-CARDFILTER-ISVALID\nWHEN FLG-CARDFILTER-NOT-OK\nMOVE CC-CARD-NUM  TO CARDSIDO OF CCRDLIAO\nMOVE DFHBMFSE     TO CARDSIDA OF CCRDLIAI\nWHEN CDEMO-CARD-NUM = 0\nMOVE LOW-VALUES   TO CARDSIDO OF CCRDLIAO\nWHEN OTHER\nMOVE CDEMO-CARD-NUM\nTO CARDSIDO OF CCRDLIAO\nMOVE DFHBMFSE      TO CARDSIDA OF CCRDLIAI\nEND-EVALUATE\nEND-IF\n\n*    POSITION CURSOR\n\nIF FLG-ACCTFILTER-NOT-OK\nMOVE  DFHRED             TO ACCTSIDC OF CCRDLIAO\nMOVE  -1                 TO ACCTSIDL OF CCRDLIAI\nEND-IF\n\nIF FLG-CARDFILTER-NOT-OK\nMOVE  DFHRED             TO CARDSIDC OF CCRDLIAO\nMOVE  -1                 TO CARDSIDL OF CCRDLIAI\nEND-IF\n\n*    IF NO ERRORS POSITION CURSOR AT ACCTID\n\nIF INPUT-OK\nMOVE   -1                 TO ACCTSIDL OF CCRDLIAI\nEND-IF\n\n\n."
    },
    {
      "name": "1400-SETUP-MESSAGE",
      "children": [],
      "text": "*    SETUP MESSAGE\nEVALUATE TRUE\nWHEN FLG-ACCTFILTER-NOT-OK\nWHEN FLG-CARDFILTER-NOT-OK\nCONTINUE\nWHEN CCARD-AID-PFK07\nAND CA-FIRST-PAGE\nMOVE 'NO PREVIOUS PAGES TO DISPLAY'\nTO WS-ERROR-MSG\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-NOT-EXISTS\nAND CA-LAST-PAGE-SHOWN\nMOVE 'NO MORE PAGES TO DISPLAY'\nTO WS-ERROR-MSG\nWHEN CCARD-AID-PFK08\nAND CA-NEXT-PAGE-NOT-EXISTS\nSET WS-INFORM-REC-ACTIONS TO TRUE\nIF  CA-LAST-PAGE-NOT-SHOWN\nAND CA-NEXT-PAGE-NOT-EXISTS\nSET CA-LAST-PAGE-SHOWN TO TRUE\nEND-IF\nWHEN WS-NO-INFO-MESSAGE\nWHEN CA-NEXT-PAGE-EXISTS\nSET WS-INFORM-REC-ACTIONS TO TRUE\nWHEN OTHER\nSET WS-NO-INFO-MESSAGE TO TRUE\nEND-EVALUATE\n\nMOVE WS-ERROR-MSG          TO ERRMSGO OF CCRDLIAO\n\nIF  NOT WS-NO-INFO-MESSAGE\nAND NOT WS-NO-RECORDS-FOUND\nMOVE WS-INFO-MSG        TO INFOMSGO OF CCRDLIAO\nMOVE DFHNEUTR           TO INFOMSGC OF CCRDLIAO\nEND-IF\n\n."
    },
    {
      "name": "1500-SEND-SCREEN",
      "children": [],
      "text": "EXEC CICS SEND MAP(LIT-THISMAP)\nMAPSET(LIT-THISMAPSET)\nFROM(CCRDLIAO)\nCURSOR\nERASE\nRESP(WS-RESP-CD)\nFREEKB\nEND-EXEC\n."
    },
    {
      "name": "1000-SEND-MAP-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "1100-SCREEN-INIT-EXIT",
      "children": [],
      "text": "EXIT\n.\n"
    },
    {
      "name": "1200-SCREEN-ARRAY-INIT-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "1250-SETUP-ARRAY-ATTRIBS-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "1300-SETUP-SCREEN-ATTRS-EXIT",
      "children": [],
      "text": "EXIT\n.\n\n"
    },
    {
      "name": "1400-SETUP-MESSAGE-EXIT",
      "children": [],
      "text": "EXIT\n.\n\n"
    },
    {
      "name": "1500-SEND-SCREEN-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "2100-RECEIVE-SCREEN",
      "children": [],
      "text": "EXEC CICS RECEIVE MAP(LIT-THISMAP)\nMAPSET(LIT-THISMAPSET)\nINTO(CCRDLIAI)\nRESP(WS-RESP-CD)\nEND-EXEC\n\nMOVE ACCTSIDI OF CCRDLIAI  TO CC-ACCT-ID\nMOVE CARDSIDI OF CCRDLIAI  TO CC-CARD-NUM\n\nMOVE CRDSEL1I OF CCRDLIAI  TO WS-EDIT-SELECT(1)\nMOVE CRDSEL2I OF CCRDLIAI  TO WS-EDIT-SELECT(2)\nMOVE CRDSEL3I OF CCRDLIAI  TO WS-EDIT-SELECT(3)\nMOVE CRDSEL4I OF CCRDLIAI  TO WS-EDIT-SELECT(4)\nMOVE CRDSEL5I OF CCRDLIAI  TO WS-EDIT-SELECT(5)\nMOVE CRDSEL6I OF CCRDLIAI  TO WS-EDIT-SELECT(6)\nMOVE CRDSEL7I OF CCRDLIAI  TO WS-EDIT-SELECT(7)\n.\n"
    },
    {
      "name": "2200-EDIT-INPUTS",
      "children": [
        {
          "name": "2210-EDIT-ACCOUNT",
          "children": [],
          "text": "SET FLG-ACCTFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-ACCT-ID   EQUAL LOW-VALUES\nOR CC-ACCT-ID   EQUAL SPACES\nOR CC-ACCT-ID-N EQUAL ZEROS\nSET FLG-ACCTFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-ACCT-ID\nGO TO  2210-EDIT-ACCOUNT-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 11 characters\nIF CC-ACCT-ID  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-ACCTFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nMOVE\n'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'\nTO WS-ERROR-MSG\nMOVE ZERO       TO CDEMO-ACCT-ID\nGO TO 2210-EDIT-ACCOUNT-EXIT\nELSE\nMOVE CC-ACCT-ID TO CDEMO-ACCT-ID\nSET FLG-ACCTFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
        },
        {
          "name": "2220-EDIT-CARD",
          "children": [],
          "text": "*    Not numeric\n*    Not 16 characters\nSET FLG-CARDFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-CARD-NUM   EQUAL LOW-VALUES\nOR CC-CARD-NUM   EQUAL SPACES\nOR CC-CARD-NUM-N EQUAL ZEROS\nSET FLG-CARDFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-CARD-NUM\nGO TO  2220-EDIT-CARD-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 16 characters\nIF CC-CARD-NUM  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-CARDFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nIF WS-ERROR-MSG-OFF\nMOVE\n'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'\nTO WS-ERROR-MSG\nEND-IF\nMOVE ZERO       TO CDEMO-CARD-NUM\nGO TO 2220-EDIT-CARD-EXIT\nELSE\nMOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM\nSET FLG-CARDFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
        },
        {
          "name": "2250-EDIT-ARRAY",
          "children": [
            {
              "name": "VARYING",
              "children": [],
              "text": ""
            }
          ],
          "text": "\nIF INPUT-ERROR\nGO TO 2250-EDIT-ARRAY-EXIT\nEND-IF\n\nINSPECT  WS-EDIT-SELECT-FLAGS\nTALLYING I\nFOR ALL 'S'\nALL 'U'\n\nIF I > +1\nSET INPUT-ERROR      TO TRUE\nSET WS-MORE-THAN-1-ACTION TO TRUE\n\nMOVE WS-EDIT-SELECT-FLAGS\nTO WS-EDIT-SELECT-ERROR-FLAGS\nINSPECT WS-EDIT-SELECT-ERROR-FLAGS\nREPLACING ALL 'S' BY '1'\nALL 'U' BY '1'\nCHARACTERS        BY '0'\n\nEND-IF\n\nMOVE ZERO TO I-SELECTED\n\nPERFORM VARYING I FROM 1 BY 1 UNTIL I > 7\nEVALUATE TRUE\nWHEN SELECT-OK(I)\nMOVE I TO I-SELECTED\nIF WS-MORE-THAN-1-ACTION\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nEND-IF\nWHEN SELECT-BLANK(I)\nCONTINUE\nWHEN OTHER\nSET INPUT-ERROR TO TRUE\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nIF WS-ERROR-MSG-OFF\nSET WS-INVALID-ACTION-CODE TO TRUE\nEND-IF\nEND-EVALUATE\nEND-PERFORM\n\n.\n"
        }
      ],
      "text": "SET INPUT-OK                   TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-NO TO TRUE\n\nPERFORM 2210-EDIT-ACCOUNT\nTHRU 2210-EDIT-ACCOUNT-EXIT\n\nPERFORM 2220-EDIT-CARD\nTHRU 2220-EDIT-CARD-EXIT\n\nPERFORM 2250-EDIT-ARRAY\nTHRU 2250-EDIT-ARRAY-EXIT\n.\n"
    },
    {
      "name": "2000-RECEIVE-MAP-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "2100-RECEIVE-SCREEN-EXIT",
      "children": [],
      "text": "EXIT\n.\n"
    },
    {
      "name": "2210-EDIT-ACCOUNT",
      "children": [],
      "text": "SET FLG-ACCTFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-ACCT-ID   EQUAL LOW-VALUES\nOR CC-ACCT-ID   EQUAL SPACES\nOR CC-ACCT-ID-N EQUAL ZEROS\nSET FLG-ACCTFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-ACCT-ID\nGO TO  2210-EDIT-ACCOUNT-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 11 characters\nIF CC-ACCT-ID  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-ACCTFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nMOVE\n'ACCOUNT FILTER,IF SUPPLIED MUST BE A 11 DIGIT NUMBER'\nTO WS-ERROR-MSG\nMOVE ZERO       TO CDEMO-ACCT-ID\nGO TO 2210-EDIT-ACCOUNT-EXIT\nELSE\nMOVE CC-ACCT-ID TO CDEMO-ACCT-ID\nSET FLG-ACCTFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
    },
    {
      "name": "2220-EDIT-CARD",
      "children": [],
      "text": "*    Not numeric\n*    Not 16 characters\nSET FLG-CARDFILTER-BLANK TO TRUE\n\n*    Not supplied\nIF CC-CARD-NUM   EQUAL LOW-VALUES\nOR CC-CARD-NUM   EQUAL SPACES\nOR CC-CARD-NUM-N EQUAL ZEROS\nSET FLG-CARDFILTER-BLANK  TO TRUE\nMOVE ZEROES       TO CDEMO-CARD-NUM\nGO TO  2220-EDIT-CARD-EXIT\nEND-IF\n*\n*    Not numeric\n*    Not 16 characters\nIF CC-CARD-NUM  IS NOT NUMERIC\nSET INPUT-ERROR TO TRUE\nSET FLG-CARDFILTER-NOT-OK TO TRUE\nSET FLG-PROTECT-SELECT-ROWS-YES TO TRUE\nIF WS-ERROR-MSG-OFF\nMOVE\n'CARD ID FILTER,IF SUPPLIED MUST BE A 16 DIGIT NUMBER'\nTO WS-ERROR-MSG\nEND-IF\nMOVE ZERO       TO CDEMO-CARD-NUM\nGO TO 2220-EDIT-CARD-EXIT\nELSE\nMOVE CC-CARD-NUM-N TO CDEMO-CARD-NUM\nSET FLG-CARDFILTER-ISVALID TO TRUE\nEND-IF\n.\n"
    },
    {
      "name": "2250-EDIT-ARRAY",
      "children": [
        {
          "name": "VARYING",
          "children": [],
          "text": ""
        }
      ],
      "text": "\nIF INPUT-ERROR\nGO TO 2250-EDIT-ARRAY-EXIT\nEND-IF\n\nINSPECT  WS-EDIT-SELECT-FLAGS\nTALLYING I\nFOR ALL 'S'\nALL 'U'\n\nIF I > +1\nSET INPUT-ERROR      TO TRUE\nSET WS-MORE-THAN-1-ACTION TO TRUE\n\nMOVE WS-EDIT-SELECT-FLAGS\nTO WS-EDIT-SELECT-ERROR-FLAGS\nINSPECT WS-EDIT-SELECT-ERROR-FLAGS\nREPLACING ALL 'S' BY '1'\nALL 'U' BY '1'\nCHARACTERS        BY '0'\n\nEND-IF\n\nMOVE ZERO TO I-SELECTED\n\nPERFORM VARYING I FROM 1 BY 1 UNTIL I > 7\nEVALUATE TRUE\nWHEN SELECT-OK(I)\nMOVE I TO I-SELECTED\nIF WS-MORE-THAN-1-ACTION\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nEND-IF\nWHEN SELECT-BLANK(I)\nCONTINUE\nWHEN OTHER\nSET INPUT-ERROR TO TRUE\nMOVE '1' TO WS-ROW-CRDSELECT-ERROR(I)\nIF WS-ERROR-MSG-OFF\nSET WS-INVALID-ACTION-CODE TO TRUE\nEND-IF\nEND-EVALUATE\nEND-PERFORM\n\n.\n"
    },
    {
      "name": "2200-EDIT-INPUTS-EXIT",
      "children": [],
      "text": "EXIT\n.\n"
    },
    {
      "name": "2210-EDIT-ACCOUNT-EXIT",
      "children": [],
      "text": "EXIT\n.\n"
    },
    {
      "name": "2220-EDIT-CARD-EXIT",
      "children": [],
      "text": "EXIT\n.\n"
    },
    {
      "name": "VARYING",
      "children": [],
      "text": ""
    },
    {
      "name": "2250-EDIT-ARRAY-EXIT",
      "children": [],
      "text": "EXIT\n.\n"
    },
    {
      "name": "UNTIL",
      "children": [],
      "text": ""
    },
    {
      "name": "9500-FILTER-RECORDS",
      "children": [],
      "text": "SET WS-DONOT-EXCLUDE-THIS-RECORD TO TRUE\n\nIF FLG-ACCTFILTER-ISVALID\nIF  CARD-ACCT-ID = CC-ACCT-ID\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD  TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\nIF FLG-CARDFILTER-ISVALID\nIF  CARD-NUM = CC-CARD-NUM-N\nCONTINUE\nELSE\nSET WS-EXCLUDE-THIS-RECORD TO TRUE\nGO TO 9500-FILTER-RECORDS-EXIT\nEND-IF\nELSE\nCONTINUE\nEND-IF\n\n.\n"
    },
    {
      "name": "9000-READ-FORWARD-EXIT",
      "children": [],
      "text": "EXIT\n."
    },
    {
      "name": "9100-READ-BACKWARDS-EXIT",
      "children": [],
      "text": "EXEC CICS\nENDBR FILE(LIT-CARD-FILE)\nEND-EXEC\n\nEXIT\n.\n"
    },
    {
      "name": "9500-FILTER-RECORDS-EXIT",
      "children": [],
      "text": "EXIT\n.\n\n*****************************************************************\n*Common code to store PFKey\n*****************************************************************\nCOPY 'CSSTRPFY'\n.\n\n*****************************************************************\n* Plain text exit - Dont use in production                      *\n*****************************************************************"
    },
    {
      "name": "SEND-PLAIN-TEXT",
      "children": [],
      "text": "EXEC CICS SEND TEXT\nFROM(WS-ERROR-MSG)\nLENGTH(LENGTH OF WS-ERROR-MSG)\nERASE\nFREEKB\nEND-EXEC\n\nEXEC CICS RETURN\nEND-EXEC\n."
    },
    {
      "name": "SEND-PLAIN-TEXT-EXIT",
      "children": [],
      "text": "EXIT\n.\n*****************************************************************\n* Display Long text and exit                                    *\n* This is primarily for debugging and should not be used in     *\n* regular course                                                *\n*****************************************************************"
    },
    {
      "name": "SEND-LONG-TEXT",
      "children": [],
      "text": "EXEC CICS SEND TEXT\nFROM(WS-LONG-MSG)\nLENGTH(LENGTH OF WS-LONG-MSG)\nERASE\nFREEKB\nEND-EXEC\n\nEXEC CICS RETURN\nEND-EXEC\n."
    },
    {
      "name": "SEND-LONG-TEXT-EXIT",
      "children": [],
      "text": "EXIT\n.\n\n\n*\n* Ver: CardDemo_v1.0-15-g27d6c6f-68 Date: 2022-07-19 23:12:33 CDT\n*"
    }
  ]
};

        const width = window.innerWidth;
        const height = window.innerHeight;

        const svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(50, 50)");

        const root = d3.hierarchy(data);

        root.descendants().forEach((d, i) => {{
            d.id = i;
            d._children = d.children;
            d.children = d.depth < 2 ? d.children : null; // Expand top 2 levels
        }});

        const tree = d3.tree().size([height - 200, width - 200]);

        const update = (source) => {{
            const nodes = root.descendants();
            const links = root.links();

            tree(root);

            const link = svg.selectAll(".link")
                .data(links, d => d.target.id);

            link.enter().append("line")
                .attr("class", "link")
                .merge(link)
                .attr("x1", d => d.source.y)
                .attr("y1", d => d.source.x)
                .attr("x2", d => d.target.y)
                .attr("y2", d => d.target.x);

            link.exit().remove();

            const node = svg.selectAll(".node")
                .data(nodes, d => d.id);

            const nodeEnter = node.enter().append("g")
                .attr("class", "node")
                .attr("transform", d => `translate(${source.y0 || 0},${source.x0 || 0})`)
                .on("click", (event, d) => {{
                    d.children = d.children ? null : d._children;
                    update(d);
                }});

            nodeEnter.append("circle")
                .attr("r", 6)
                .style("fill", d => d._children ? "#555" : "#999");

            nodeEnter.append("text")
                .attr("dy", 3)
                .attr("x", d => d.children || d._children ? -10 : 10)
                .style("text-anchor", d => d.children || d._children ? "end" : "start")
                .text(d => d.data.name);

            const nodeUpdate = nodeEnter.merge(node);
            nodeUpdate.transition()
                .duration(300)
                .attr("transform", d => `translate(${d.y},${d.x})`);

            nodes.forEach(d => {{
                d.x0 = d.x;
                d.y0 = d.y;
            }});

            node.exit().transition()
                .duration(300)
                .remove();
        }};

        update(root);
    </script>
</body>
</html>
    